"use strict";angular.module("dachuwang",["ngAnimate","ngCookies","ngTouch","ngSanitize","ui.router","ui.bootstrap","infinite-scroll","bootstrapLightbox"]).run(["$rootScope","$state","$templateCache",function(e,o,s){e.$on("$stateChangeStart",function(){e.showLoading=!0}),e.$on("$stateChangeSuccess",function(){e.showLoading=!1,e.$broadcast("pageChanged",o.current.data)}),s.put("lightbox.html","<div class=modal-body ng-swipe-left=Lightbox.nextImage() ng-swipe-right=Lightbox.prevImage()><div class='close_m_btn' ng-click='Lightbox.closeModal()'><span class='glyphicon glyphicon-remove'></span></div><div class=lightbox-image-container><span class='glyphicon glyphicon-menu-left' ng-show='imglength > 1'  ng-click=Lightbox.nextImage()></span><span class='glyphicon glyphicon-menu-right' ng-show='imglength > 1' ng-click=Lightbox.prevImage()></span><div class=lightbox-image-caption><span>{{    Lightbox.imageCaption}}</span></div><img lightbox-src={{Lightbox.imageUrl}}     class='' alt=\"\"></img></div></div>")}]),window.geoData={callback:null,setAddress:function(e){"string"==typeof e&&(e=JSON.parse(e)),this.callback&&this.callback(e)}},window.callback_function={},angular.module("dachuwang").controller("UserEditCtrl",["$scope","rpc","$cookieStore","daChuDialog",function(e,o,s,t){if(void 0==s.get("token"))return rpc.redirect("/user/login"),!1;e.discard=function(){rpc.redirect("/user/center")},e.addr={province:"",city:"",county:"",market:""},e.reg={provinceId:"",name:"",cityId:"",countyId:"",marketId:"",detailAddress:""},e.normalUser=30==e.reg.type||20==e.reg.type?1:0,rpc.getdata("user/getinfo","POST",function(o){e.reg.detailAddress=o.info.detail_address,e.reg.name=o.info.name,e.markets=o.markets,e.provinces=o.provinces,e.citys=o.citys,e.countys=o.countys,angular.forEach(e.markets,function(s){s.id==o.info.market_id&&(e.addr.market=s)}),angular.forEach(e.provinces,function(s){s.id==o.info.province_id&&(e.addr.province=s)}),angular.forEach(e.citys,function(s){s.id==o.info.city_id&&(e.addr.city=s)}),null!=o.info.county_id&&angular.forEach(e.countys,function(s){s.id==o.info.county_id&&(e.addr.county=s)})}),localStorage.getItem("provinces")?e.provinces=JSON.parse(localStorage.getItem("provinces")):rpc.getdata("location/","GET",function(o){e.provinces=o.provinces,localStorage.setItem("provinces",JSON.stringify(o.provinces))}),e.get_child=function(o,s){rpc.getdata("location/children","POST",function(s){e[o]=s.children},{id:e.addr[s].id})};var i=0;e.get_market=function(o){(o="province")?e.addr.province.id<=4?(i=1,rpc.getdata("market/get_market","POST",function(o){e.markets=o},{type:"province",id:e.addr.province.id})):i=0:i||rpc.getdata("market/get_market","POST",function(o){e.markets=o},{type:"city",id:e.addr.city.id})},e.save=function(){e.reg.marketId=e.addr.market.id,e.reg.provinceId=e.addr.province.id,e.reg.cityId=e.addr.city.id,e.reg.countyId=e.addr.county.id,rpc.getdata("/user/update_myself","POST",function(e){e.status?(t.tips({bodyText:"更新个人资料成功！"}),rpc.redirect("/user/center")):t.tips({bodyText:"更新个人资料失败。"})},e.reg)}}]),angular.module("dachuwang").controller("UserRegisterCtrl",["$scope","rpc","$cacheFactory","$timeout","$location","daChuDialog","$cookieStore","daChuLocal","daChuTimer",function(e,o,s,t,i,n,a,l,r){e.dialog=n.tips,e.addr={province:"",city:"",county:"",market:"",userType:""},e.reg={mobile:"",password:"",name:"",provinceId:"",cityId:"",countyId:"",marketId:"",detailAddress:"",type:"",vcode:"",inviteid:a.get("username")},l.get("regUserType")&&r.compare(l.get("regUserTypeTime"))?e.types=l.get("regUserType"):rpc.getdata("user/user_type","POST",function(o){e.types=o.user_type,l.set("regUserType",o.user_type),l.set("regUserTypeTime",r.getNow())}),rpc.getdata("user/register_options","GET",function(o){e.cities=o.list.cities,e.market=o.list.market}),e.getMarket=function(){e.markets=void 0!=e.addr.city?e.market[e.addr.city.id]:[]},e.sms=function(){if(""==e.reg.mobile)return e.dialog({bodyText:"请输入手机号后再选择发送验证短信!"}),!1;e.clock=60;var o=function(o){e.smsinfo="点此重发验证码",e.smsdis="",clearInterval(o)},s=function(){e.clock>=1?(e.clock--,e.smsinfo=e.clock+"秒后可以重发",e.smsdis="disabled"):o(t)},t=setInterval(function(){e.$apply(s)},1e3);rpc.getdata("user/smscode","POST",function(s){0===s.status?e.dialog({bodyText:"已经成功发送短信,请您注意查收。"}):(o(t),e.dialog({bodyText:"发送短信失败,请您检查手机号是否可用。"}))},e.reg)},e.register=function(){return e.regForm.$invalid?(e.regForm.submitted=!0,!1):(e.reg.provinceId=e.addr.province.id,e.reg.cityId=e.addr.city.id,e.reg.countyId=e.addr.county.id,e.reg.marketId=e.addr.market.id,e.reg.type=e.addr.userType.type,e.reg.codeInviteId=a.get("inviteId"),e.reg.codeInviteStoreNumber=a.get("inviteStoreNumber"),void rpc.getdata("user/register","POST",function(o){var s="恭喜您注册成功";0===o.status?(20==e.reg.type?a.put("type",20):s="恭喜您注册成功，请等待大厨网审核。有任何疑问请联系010-58298105。",e.dialog({bodyText:s,actionText:"确定",ok:function(){rpc.redirect(20==e.reg.type?"/user/center":"/")},closeText:"首页",close:function(){rpc.redirect("/")}})):e.dialog({bodyText:o.message})},e.reg))}}]),angular.module("dachuwang").controller("userPassCtrl",["$scope","rpc","$cacheFactory","$timeout","$location","daChuDialog","$cookieStore",function(e,o,s,t,i,n,a){e.reg={password:"",newPassword:"",newRePassword:""},e.dialog=n.tips,e.passwordCheck=function(){return e.reg.newPassword!=e.reg.newRePassword?(e.checked=1,e.dialog({bodyText:"两次输入密码不一致。"}),!1):void(e.checked=0)},e.changePassword=function(){e.passwordCheck(),o.load("user/update_password","POST",e.reg).then(function(e){alert(e.msg),o.load("user/logout","POST").then(function(){a.remove("token"),o.redirect("/user/login")})},function(e){alert(e)})}}]),angular.module("dachuwang").controller("loginCtrl",["$scope","$state","userAuthService","rpc","$cookieStore","daChuLocal",function(e,o,s,t,i,n){return s.isLogined()?(t.redirect("/user/center"),!1):(e.user={mobile:"",password:""},e.message={text:"",status:""},void(e.login=function(){return e.show_error=!0,e.loginForm.$invalid?(e.loginForm.submitted=!0,e.isL=!1,!1):(e.isL=!0,void t.load("user/login","POST",e.user).then(function(e){n.set("token",e.token),n.set("role_id",e.info.type),n.set("site_id",e.info.site_id),n.set("city_id",e.info.city_id),t.refer&&"/"!=t.refer?t.redirect(t.refer):o.go("page.homemanage")},function(o){e.error={cls:"alert alert-danger",message:o}}))}))}]),angular.module("dachuwang").controller("UserCenterCtrl",["$scope","rpc","$cookieStore","daChuDialog","$filter","userAuthService","daChuLocal",function(e,o,s,t,i,n,a){n.checkLogin(),e.dialog=t.tips,e.logout=function(){e.dialog({bodyText:"确定要退出吗？",ok:function(){o.load("user/logout","POST",e.user).then(function(){a.remove("token"),a.remove("role_id"),a.remove("city_id"),a.remove("site_id"),o.redirect(o.refer&&"/"!=o.refer?o.refer:"user/login")},function(o){e.error={cls:"alert alert-danger",message:o}})},actionText:"确定",closeText:"取消"})},o.load("user/baseinfo","POST").then(function(o){e.uinfo=o.info})}]),angular.module("dachuwang").controller("MoreController",["$scope","$window","daChuDialog",function(e,o,s){e.func={},e.func.manual=function(){s.alert("正在开发中...")},e.func.map=function(){o.jsInterface&&o.jsInterface.offlineMapManager?o.jsInterface.offlineMapManager():s.alert("请安装安卓客户端使用此功能")},e.func.clearCache=function(){o.jsInterface&&o.jsInterface.eraseCache?o.jsInterface.eraseCache():s.alert("请安装安卓客户端使用此功能")}}]),angular.module("dachuwang").controller("homeCtrl",["$scope","$window","$log","$stateParams","$filter","daChuLocal","rpc","userAuthService","daChuDialog",function(e,o,s,t,i,n,a,l,r){function c(){var o={role_id:parseInt(n.get("role_id")),action:"get_statistics"};t.bd_id&&(o.bd_id=t.bd_id),a.load("statistics/index","POST",o).then(function(o){5==o.list.length?(e.statistics=o.list.splice(0,o.list.length-1),e.capacity=o.list.splice(o.list.length-2,1)):e.statistics=o.list;var s=e.statistics.length-1;e.cuslist=[],e.customerlist=e.statistics[s].data,angular.forEach(e.customerlist,function(o,s){e.cuslist.push({name:s,value:o})})},function(e){console.error(e)}).then(function(){e.isloading=!1})}l.checkLogin(),e.tabLists=[{status:0,name:"统计数据"},{status:1,name:"本月绩效"}],e.showType=0,e.showTabs=!0,e.show_metabolic=!1,e.dpicker={begin:{},end:{}},e.format={min:new Date("2015-03-01"),max:new Date};var d="未知";e.statistics=[{heading:"今日",data:[{key:"新注册客户数",val:d},{key:"首单客户数",val:d}]},{heading:"本周",data:[{key:"新注册客户数",val:d},{key:"首单客户数",val:d}]},{heading:"本月",data:[{key:"新注册客户数",val:d},{key:"首单客户数",val:d}]}],e.openstatus={list:[!0,!0,!0,!0,!0,!0],query:!1,sum:!0},e.capacity_openstatus={list:[!0],query:!1,sum:!0},e.metabolic=[{key:"新注册客户数",val:d},{key:"首单客户数",val:d}],e.sum=[{key:"首单客户数",val:500}],e.begintime={},e.endtime={},e.date={},e.func={query:function(){if(!e.date.begin_time||!e.date.end_time)return r.alert("请选择时段"),!1;var o=new Date(e.date.begin_time).valueOf(),s=new Date(e.date.end_time).valueOf();if(o>s)return r.alert("起始时间不能大于结束时间"),!1;e.isquering=!0,e.show_metabolic=!1;var i={role_id:parseInt(n.get("role_id")),action:"get_query",begin_time:o/1e3,end_time:s/1e3};t.bd_id&&(i.bd_id=t.bd_id),a.load("statistics/index","POST",i).then(function(o){e.metabolic=o.list,e.show_metabolic=!0},function(e){r.alert("查询失败请稍候再试，原因: "+e)}).then(function(){e.isquering=!1})},openDatepicker:function(o,s){o.preventDefault(),o.stopPropagation(),1===s?(e.dpicker.end.status=!1,e.dpicker.begin.status=!0):(e.dpicker.begin.status=!1,e.dpicker.end.status=!0)},changeStatus:function(o){e.showType=o}},e.isloading=!0,e.isquering=!1,c()}]),angular.module("dachuwang").controller("DblistController",["$scope","$window","$log","$state","rpc","daChuDialog","daChuLocal",function(e,o,s,t,i,n,a){function l(){e.isLoading=!0,e.showLists=!0,e.showTotal=!1,i.load("customer/list_group","POST").then(function(o){e.isLoading=!1,e.mygroup=o.list.list},function(){e.isLoading=!1,n.alert("哎呀，服务器连不通啊")})}function r(){e.isLoading=!0,e.showLists=!1,e.showTotal=!0;var o={action:"get_total_statistics",role_id:parseInt(a.get("role_id"))};i.load("statistics/index","POST",o).then(function(o){e.statistics=o.list,console.log(o.list),e.isLoading=!1,0==o.status?(e.today=o.list.today,e.all=o.list.all):n.alert("请求出错")},function(){n.alert("网络不好连不上啊")})}e.tabs=[{status:1,name:"组员业绩"},{status:0,name:"业绩汇总"}],e.timeTabs=[{status:0,name:"今日"},{status:1,name:"本周"},{status:2,name:"本月"},{status:3,name:"总计"},{status:4,name:"自选区间"}],e.showType=1,e.timeShowType=0,e.setStatus=function(o){e.showType=o,1==o?l():r()},e.setTimeStatus=function(o){e.timeShowType=o},e.viewStatistics=function(e){t.go("page.home",{bd_id:e})},l(),e.openstatus={list:[!0,!0,!0,!0,!0,!0],query:!1,sum:!0}}]),angular.module("dachuwang").controller("PotlistController",["$scope","$state","$stateParams","$log","$window","rpc","pagination","daChuDialog",function(e,o,s,t,i,n,a,l){function r(o){var i=3;t.debug(a.page),n.load("potential_customer/lists","POST",{itemsPerPage:i,currentPage:a.page,invite_id:s.invite_id}).then(function(s){angular.forEach(s.list,function(o){e.list.push(o)}),o(s.list.length<i?!0:!1),e.totalItems=s.total>0?s.total:0})}e.list=[],e.pagination=a,e.pagination.init(r),e.openUser=function(e){o.go("page.openpot",{potid:e})},e.editUser=function(e){o.go("page.editpot",{potid:e})},e.deleteUser=function(e){n.load("potential_customer/delete","POST",{id:e}).then(function(e){0==e.status?(l.alert("删除成功"),i.location.reload(!0)):l.alert("删除失败 "+e.msg)},function(e){l.alert("删除失败 "+e)})}}]),angular.module("dachuwang").controller("PotentialController",["$scope","$stateParams","$cookieStore","$window","rpc","geo","daChuDialog","urlHistoryService",function(e,o,s,t,i,n,a,l){function r(){var o,s;for(o=0;o<u.length;o++)if(s=u[o],e.basic_form[s.name].$invalid)return void a.alert(s.info)}e.addr={province:""};var c=function(o){var s=[];angular.forEach(o,function(o){1==e.site.id&&2!=o.id?s.push(o):2==e.site.id&&2==o.id&&s.push(o)}),e.tops=s};e.getSite=function(){void 0!==e.site&&c(e.shopType.top)};var d=function(){i.load("customer/create_input","GET").then(function(o){e.provinces=o.provinces,e.allLines=o.lines,e.sites=o.sites,e.site=e.sites[0],e.shopType=o.shop_type,c(e.shopType.top)},function(o){e.error={cls:"alert alert-danger",message:o}})};e.getShop=function(){if(void 0!==e.shop){var o=[];angular.forEach(e.shopType.child,function(s){parseInt(s.upid)==parseInt(e.shop.id)&&o.push(s)}),e.shopChilds=o}},e.getLines=function(){var o=0;e.info.province&&(o=e.info.province.id);var s=[];angular.forEach(e.allLines,function(e){o==e.location_id&&s.push(e)}),e.lines=s};var u=[{name:"province",info:"请选择省市信息"},{name:"line",info:"请选择配送线路"},{name:"address",info:"请填写详细地址"},{name:"shop_name",info:"请填写商铺名"}];e.create=function(){if(e.basic_form.$invalid)return r(),!1;var o=0,s=0;void 0==e.shopChild?void 0!==e.shop&&(o=e.shop.id||0):(o=e.shopChild.id,s=e.shopChild.is_link);var t={id:e.site.id||0,name:e.info.name,shopType:o,isLink:s,mobile:e.info.mobile,provinceId:e.info.province?e.info.province.id:null,lineId:e.info.line?e.info.line.id:null,address:e.info.address,shopName:e.info.shop_name,remark:e.info.remark};i.load("potential_customer/create","POST",t).then(function(){alert("记录成功"),l.push(0),i.redirect("/crm")},function(e){alert(e)})},d()}]),angular.module("dachuwang").controller("OpenpotController",["$scope","$modal","$stateParams","$cookieStore","$window","$state","rpc","daChuDialog","geo","urlHistoryService","daChuLocal",function(e,o,s,t,i,n,a,l,r,c,d){function u(){var o,s;for(o=0;o<m.length;o++)if(s=m[o],e.basic_form[s.name].$invalid)return void l.alert(s.info);return 2===e.shop.id&&e.basic_form.shop_child.$invalid?void l.alert("请选择商家连锁类型"):void l.alert("something wrong")}e.urls=null,i.callback_function.upload=function(o){e.urls=JSON.parse(o)},e.suborderInfo=function(){o.open({templateUrl:"suborderInfo.html"})},e.upload=function(){i.jsInterface&&i.jsInterface.pictureUpload?i.jsInterface.pictureUpload("window.callback_function.upload"):l.alert("此版本无法上传图片,请安装安卓客户端")},e.getLines=function(){var o=0;e.info.province&&(o=e.info.province.id);var s=[];angular.forEach(e.allLines,function(e){o==e.location_id&&s.push(e)}),e.lines=s};var m=[{name:"customerType",info:"请选择客户类型"},{name:"accountType",info:"请选择字母账号类型"},{name:"shop",info:"请选择商家类别"},{name:"dimensions",info:"请选择店铺规模"},{name:"estimateVegetable",info:"请选择预估日均果蔬采购量"},{name:"estimateRice",info:"请选择预估日均米面粮油采购量"},{name:"mobile",info:"请输入客户手机号"},{name:"username",info:"请输入客户姓名"},{name:"province",info:"请选择省市信息"},{name:"line",info:"请选择配送线路"},{name:"address",info:"请填写详细地址"},{name:"direction",info:"请选择商家方位"},{name:"shop_name",info:"请填写商铺名"}];e.show_more_account_option=function(){return e.account_type?void(e.show_account_son=1!==parseInt(e.account_type.value)?!0:!1):void(e.show_account_son=!1)},e.bindProperty=function(o,s){e[o]=s};var p=function(){var o={};s.potid&&(o.id=s.potid),a.load("potential_customer/edit_input","POST",o).then(function(o){e.provinces=o.provinces,e.allLines=o.lines,e.dOptions=o.directions,e.oDimensions=o.dimensions,e.types=o.types,e.is_uploaded=parseInt(o.info.is_uploaded),e.shopTypes=o.shop_type,e.shop=function(o){var s,t=parseInt(o),i=e.shopTypes.length;for(s=0;i>s;s++)if(e.shopTypes[s].id===t)return e.shopTypes[s];return null}(o.info.shop_type),e.info=o.info,e.userGeo={lng:o.info.lng,lat:o.info.lat},e.info.dimensions=function(o){if(!o)return null;var s,t=e.oDimensions.length;for(s=0;t>s;s++)if(o===e.oDimensions[s].value)return e.oDimensions[s];return null}(o.info.dimensions),e.info.province=function(o){var s,t=e.provinces.length;for(s=0;t>s;s++)if(e.provinces[s].id==o)return e.provinces[s]}(parseInt(o.info.province_id)),e.getLines(),e.info.line=function(o){var s,t=e.lines.length;for(s=0;t>s;s++)if(e.lines[s].id==o)return e.lines[s]}(parseInt(o.info.line_id)),e.info.direction=function(o){var s,t=e.dOptions.length;if(!o)return null;for(s=0;t>s;s++)if(e.dOptions[s].value==o)return e.dOptions[s]}(o.info.direction),e.urls=o.info.pic_urls,angular.forEach(e.types,function(s){s.value==o.info.customer_type&&(e.customerType=s)});var s=d.get("city_id");return s?(angular.forEach(e.provinces,function(o){o.id==s&&(e.info.province=o)}),e.getLines(),e.estimateds=o.estimated,e.info.estimateVegetable=function(o){var s,t;for(t=e.estimateds.length,s=0;t>s;s++)if(e.estimateds[s].value==o)return e.estimateds[s]}(o.info.greens_meat_estimated),e.info.estimateRice=function(o){var s,t;for(t=e.estimateds.length,s=0;t>s;s++)if(e.estimateds[s].value==o)return e.estimateds[s]}(o.info.rice_grain_estimated),e.account_types=o.account_types,e.account_type=function(o){var s,t;for(t=e.account_types.length,s=0;t>s;s++)if(e.account_types[s].value==o)return e.account_types[s]}(o.info.account_type),void(e.account_type&&1!==parseInt(e.account_type.value)&&(e.parent_mobile=o.info.parent_mobile,e.show_more_account_option()))):(l.alert("登录超时，请重新登录"),void a.redirect("user/login"))},function(o){e.error={cls:"alert alert-danger",message:o}})},g=!1;e.create=function(){if(e.basic_form.$invalid){if(!e.basic_form.mobile.$dirty)return u(),!1;if(e.basic_form.mobile.$invalid)return l.alert("请输入正确手机号"),!1}if(1!==parseInt(e.account_type.value)&&!e.parent_mobile)return void l.alert("请填写关联母账号");var o=0,t=0;if(void 0==e.shopChild?void 0!==e.shop&&(o=e.shop.id||0):(o=e.shopChild.id,t=e.shopChild.is_link),!(g||e.userGeo.lat&&e.userGeo.lng))return void l.alert("请定位此用户位置信息，再提交！");if(null===e.urls&&0===e.is_uploaded)return void l.alert("请上传至少一张商家门店图片");var i=e.info.dimensions||{value:""},r=e.info.direction||{value:""},c={id:s.potid,name:e.info.name,shopType:o,isLink:t,dimensions:i.value,mobile:e.info.mobile,provinceId:e.info.province.id,lineId:e.info.line.id,lat:e.userGeo.lat,lng:e.userGeo.lng,address:e.info.address,direction:r.value,shopName:e.info.shop_name,customerType:e.customerType.value,remark:e.info.remark,is_located:function(){return e.userGeo.lat&&e.userGeo.lng||1==e.info.is_located?1:0}(),greens_meat_estimated:e.info.estimateVegetable.value,rice_grain_estimated:e.info.estimateRice.value,account_type:e.account_type.value};null!==e.urls&&(c.pic_urls=e.urls),e.parent_mobile&&(c.parent_mobile=e.parent_mobile),e.isRequesting=!0,a.load("potential_customer/enable","POST",c).then(function(){l.alert("开通成功"),e.isRequesting=!1,n.go("page.manage")},function(o){l.alert("开通潜在客户失败，失败原因:"+o),e.isRequesting=!1})},i.geoData.callback=function(o){e.userGeo.lat=o.latitude,e.userGeo.lng=o.longitude,e.info.address=o.address,e.$apply()},e.choosePlace=function(){if(i.jsInterface&&i.jsInterface.findRestaurantOnMap)i.jsInterface.findRestaurantOnMap();else{var o=r.info();o.then(function(o){e.userGeo={},e.userGeo.lat=o.lat,e.userGeo.lng=o.lng,l.alert("客户地址定位成功！")},function(e){l.alert("获取位置错误, "+e),g=!0})}},p()}]),angular.module("dachuwang").controller("MyCustomerController",["$scope",function(e){e.showType=0,e.setStatus=function(o){e.showType=o},e.tabs=[{status:0,href:"",name:"当前客户"},{status:1,href:"",name:"潜在客户"}]}]),angular.module("dachuwang").controller("manageController",["$scope","$state","$window","daChuLocal","daChuDialog","rpc",function(e,o,s,t,i,n){e.isLoading=!0,n.load("customer/list_group","POST").then(function(o){e.isLoading=!1,e.my=o.list.customer,e.mygroup=o.list.list},function(){i.alert("无法连接服务器，可能是网络较差")}),e.viewCustom=function(e){o.go("page.crm",{invite_id:e})}}]),angular.module("dachuwang").controller("FilterController",["$scope","$modalInstance","$window","rpc","daChuDialog","daChuLocal",function(e,o,s,t,i,n){function a(e,o){if(null===e)return null;var s,t={},i=o.length;for(s=0;i>s;s++)e[o[s]]&&(t[o[s]]=e[o[s]]);return t}function l(e){var o;for(o in e)return!1;return!0}function r(e,o){return parseInt(e)===parseInt(o)?!0:!1}var c;e.order_lists=[{name:"注册时间",val:"created_time"},{name:"下单时间",val:"order_time"}],e.order={by:null,way:null},e.property={dimensions:[],customer_type:[{name:"从未下单",value:0},{name:"有下单记录",value:1}]},e.sift={},e.isloading=!0,function(){t.load("customer/create_input","GET").then(function(o){if(0===parseInt(o.status)){e.property.provinces=function(e){var o,s=[],t=e.length;for(o=0;t>o;o++)s.push(a(e[o],["id","name","path"]));return s}(o.provinces),c=o.lines;var s=n.get("city_id");if(!s)return i.alert("登录超时，请重新登录"),void t.redirect("user/login");angular.forEach(e.property.provinces,function(o){o.id==s&&(e.sift.province=o)}),e.func.getLines(),e.property.dimensions=o.dimensions,e.property.shop_types=o.shop_type;var l=n.get("filter_sift");l&&l.line&&l.line.id&&angular.forEach(e.property.lines,function(o){o.id==l.line.id&&(e.sift.line=o)}),l&&l.dimensions&&l.dimensions.value&&angular.forEach(e.property.dimensions,function(o){o.value==l.dimensions.value&&(e.sift.dimensions=o)}),l&&l.shop_type&&l.shop_type.id&&angular.forEach(e.property.shop_types,function(o){o.id==l.shop_type.id&&(e.sift.shop_type=o)})}},function(e){i.alert(e)}).then(function(){e.isloading=!1})}(),e.func={ensure:function(){var s={order:e.order,sift:e.sift};return l(s.sift)&&l(s.order.by)&&l(s.order.way)?(this.cancel(),!1):(n.set("filter_sift",e.sift),void o.close(s))},cancel:function(){n.remove("filter_sift"),o.close(null)},getLines:function(){if(!e.sift.province)return!1;e.property.lines=[];var o,s=c.length;for(o=0;s>o;o++)r(c[o].location_id,e.sift.province.id)&&e.property.lines.push({id:c[o].id,name:c[o].name})},reset:function(){e.sift.line="",e.sift.dimensions="",e.sift.shop_type="",n.remove("filter_sift")}}}]),angular.module("dachuwang").controller("EditpotController",["$scope","$modal","$stateParams","$cookieStore","$window","$state","rpc","daChuDialog","geo","daChuLocal",function(e,o,s,t,i,n,a,l,r,c){function d(){var o,s;for(o=0;o<u.length;o++)if(s=u[o],e.basic_form[s.name].$invalid)return void l.alert(s.info)}e.urls=null,i.callback_function.upload=function(o){e.urls=JSON.parse(o)},e.suborderInfo=function(){o.open({templateUrl:"suborderInfo.html"})},e.upload=function(){i.jsInterface&&i.jsInterface.pictureUpload?i.jsInterface.pictureUpload("window.callback_function.upload"):l.alert("此版本无法上传图片,请安装安卓客户端","customer_shop")},e.getLines=function(){var o=0;e.info.province&&(o=e.info.province.id);var s=[];angular.forEach(e.allLines,function(e){o==e.location_id&&s.push(e)}),e.lines=s},e.bindProperty=function(o,s){e[o]=s},e.get_cycle=function(){if(e.billing_cycle){var o=e.billing_cycle.value;e.m_check_dates=e.check_dates[o],e.m_invoice_dates=e.invoice_dates[o],e.m_pay_dates=e.pay_dates[o]}};var u=[{name:"customerType",info:"请选择客户类型"},{name:"accountType",info:"请选择字母账号类型"},{name:"shop",info:"请选择商家类别"},{name:"dimensions",info:"请选择店铺规模"},{name:"estimateVegetable",info:"请选择预估日均果蔬采购量"},{name:"estimateRice",info:"请选择预估日均米面粮油采购量"},{name:"mobile",info:"请输入客户手机号"},{name:"username",info:"请输入客户姓名"},{name:"province",info:"请选择省市信息"},{name:"line",info:"请选择配送线路"},{name:"address",info:"请填写详细地址"},{name:"direction",info:"请选择商家方位"},{name:"shop_name",info:"请填写商铺名"}];e.show_more_account_option=function(){return e.ka_type?void(e.show_account_son=1!==parseInt(e.ka_type.value)?!0:!1):void(e.show_account_son=!1)};var m=function(){var o={};s.potid&&(o.id=s.potid),a.load("potential_customer/edit_input","POST",o).then(function(o){e.provinces=o.provinces,e.allLines=o.lines,e.dOptions=o.directions,e.oDimensions=o.dimensions,e.types=o.types,e.is_uploaded=parseInt(o.info.is_uploaded),e.shopTypes=o.shop_type,e.shop=function(o){var s,t=parseInt(o),i=e.shopTypes.length;for(s=0;i>s;s++)if(e.shopTypes[s].id===t)return e.shopTypes[s];return null}(o.info.shop_type),e.info=o.info,e.userGeo={lng:o.info.lng,lat:o.info.lat},e.info.dimensions=function(o){if(!o)return null;var s,t=e.oDimensions.length;for(s=0;t>s;s++)if(o===e.oDimensions[s].value)return e.oDimensions[s];return null}(o.info.dimensions),e.info.province=function(o){var s,t=e.provinces.length;for(s=0;t>s;s++)if(e.provinces[s].id==o)return e.provinces[s]}(parseInt(o.info.province_id)),e.getLines(),e.info.line=function(o){var s,t=e.lines.length;for(s=0;t>s;s++)if(e.lines[s].id==o)return e.lines[s]}(parseInt(o.info.line_id)),e.info.direction=function(o){var s,t=e.dOptions.length;if(!o)return null;for(s=0;t>s;s++)if(e.dOptions[s].value==o)return e.dOptions[s]}(o.info.direction),e.urls=o.info.pic_urls,angular.forEach(e.types,function(s){s.value==o.info.customer_type&&(e.customerType=s)});var s=c.get("city_id");return s?(angular.forEach(e.provinces,function(o){o.id==s&&(e.info.province=o)}),e.getLines(),e.estimateds=o.estimated,e.info.estimateVegetable=function(o){var s,t;for(t=e.estimateds.length,s=0;t>s;s++)if(e.estimateds[s].value==o)return e.estimateds[s]}(o.info.greens_meat_estimated),e.info.estimateRice=function(o){var s,t;for(t=e.estimateds.length,s=0;t>s;s++)if(e.estimateds[s].value==o)return e.estimateds[s]}(o.info.rice_grain_estimated),e.account_types=o.account_types,e.account_type=function(o){o=parseInt(o);var s,t;for(t=e.account_types.length,s=0;t>s;s++)if(e.account_types[s].value==o)return e.account_types[s]}(o.info.account_type),void(e.account_type&&1!==parseInt(e.account_type.value)&&(e.parent_mobile=o.info.parent_mobile,e.show_more_account_option()))):(l.alert("登录超时，请重新登录"),void a.redirect("user/login"))},function(o){e.error={cls:"alert alert-danger",message:o}})},p=!1;e.create=function(){if(e.basic_form.$invalid){if(!e.basic_form.mobile.$dirty)return d(),!1;if(e.basic_form.mobile.$invalid)return l.alert("请输入正确手机号"),!1}if(1!==parseInt(e.account_type.value)&&!e.parent_mobile)return void l.alert("请填写关联母账号");var o=0,t=0;if(o=e.shop.id||0,!(p||e.userGeo.lat&&e.userGeo.lng))return void l.alert("请定位此用户位置信息，再提交！");if(null===e.urls&&0===e.is_uploaded)return void l.alert("请上传至少一张商家门店图片");var i=e.info.dimensions||{value:""},r=e.info.direction||{value:""},c={id:s.potid,name:e.info.name,shopType:o,isLink:t,dimensions:i.value,mobile:e.info.mobile,provinceId:e.info.province.id,lineId:e.info.line.id,lat:e.userGeo.lat,lng:e.userGeo.lng,address:e.info.address,direction:r.value,customerType:e.customerType.value,shopName:e.info.shop_name,remark:e.info.remark,is_located:function(){return e.userGeo.lat&&e.userGeo.lng||1==e.info.is_located?1:0}(),greens_meat_estimated:e.info.estimateVegetable.value,rice_grain_estimated:e.info.estimateRice.value,account_type:e.account_type.value};null!==e.urls&&(c.pic_urls=e.urls),e.parent_mobile&&(c.parent_mobile=e.parent_mobile),e.isRequesting=!0,a.load("potential_customer/edit","POST",c).then(function(){l.alert("修改成功"),e.isRequesting=!1,n.go("page.manage")},function(o){l.alert(o),e.isRequesting=!1})},i.geoData.callback=function(o){e.userGeo.lat=o.latitude,e.userGeo.lng=o.longitude,e.info.address=o.address,e.$apply()},e.choosePlace=function(){if(i.jsInterface&&i.jsInterface.findRestaurantOnMap)i.jsInterface.findRestaurantOnMap();else{var o=r.info();o.then(function(o){e.userGeo={},e.userGeo.lat=o.lat,e.userGeo.lng=o.lng,l.alert("客户地址定位成功！")},function(e){l.alert("获取位置错误, "+e),p=!0})}},m()}]),angular.module("dachuwang").controller("EditCustomerController",["$scope","$state","$stateParams","$window","rpc","daChuDialog",function(e,o,s,t,i,n){var a,l=s.customer_id;e.is_uploaded=0,e.userGeo={lat:null,lng:null},e.isRequesting=!1,e.func={},e.urls=null,function(s){var t={id:s};i.load("customer/edit_input","POST",t).then(function(o){e.dOptions=o.directions,e.oDimensions=o.dimensions,e.dimensions=function(o){if(!o)return null;var s,t=e.oDimensions.length;for(s=0;t>s;s++)if(o===e.oDimensions[s].value)return e.oDimensions[s];return null}(o.info.dimensions),e.direction=function(o){if(!o)return null;var s,t=e.dOptions.length;for(s=0;t>s;s++)if(e.dOptions[s].value==o)return e.dOptions[s]}(o.info.direction),e.urls=o.info.pic_urls,e.types=o.types,angular.forEach(e.types,function(s){s.value==o.info.customer_type&&(e.customerType=s)});var s,t=["address","remark","is_uploaded","is_located"],i=t.length;for(s=0;i>s;s++)e[t[s]]=o.info[t[s]];a=e.address},function(e){n.alert(e),o.go("page.manage")})}(l),e.func.create=function(){if(e.basic_form.$pristine&&null===e.urls&&null===e.userGeo.lat)return n.alert("提交失败，您并未做任何修改"),!1;var s={id:l};if(e.basic_form.address.$dirty&&""==e.address)return n.alert("地址信息不能为空"),e.address=a,!1;var t,r=["dimensions","address","direction","remark"],c=["dimensions","direction"],d=r.length;for(t=0;t<c.length;t++)if(!e[c[t]])return n.alert("必填项不能为空"),!1;for(t=0;d>t;t++)e.basic_form[r[t]].$dirty&&(s[r[t]]=e[r[t]]);var u=e.dimensions||{value:""},m=e.direction||{value:""},p=e.customerType||{value:""};s.dimensions=u.value,s.direction=m.value,s.customerType=p.value,null!==e.urls&&(s.pic_urls=e.urls),(null!==e.userGeo.lat||null!==e.userGeo.lng)&&(s.is_located=1,s.geo={lat:e.userGeo.lat,lng:e.userGeo.lng},s.address=e.address),e.isRequesting=!0,i.load("customer/edit","POST",s).then(function(){n.alert("修改成功"),e.isRequesting=!1,o.go("page.manage")},function(o){n.alert("修改失败："+o),e.isRequesting=!1})},t.geoData.callback=function(o){e.userGeo.lat=o.latitude,e.userGeo.lng=o.longitude,e.address=o.address,e.$apply()},t.callback_function.upload=function(o){e.urls=JSON.parse(o),e.is_uploaded=2,e.$apply()},e.func.choosePlace=function(){t.jsInterface&&t.jsInterface.findRestaurantOnMap?t.jsInterface.findRestaurantOnMap():n.alert("请使用安卓设备")},e.func.upload=function(){t.jsInterface&&t.jsInterface.pictureUpload?t.jsInterface.pictureUpload("window.callback_function.upload"):n.alert("无法上传图片,请安装安卓客户端","customer_shop")}}]),angular.module("dachuwang").controller("custormCtrl",["$scope","$modal","$state","$stateParams","$cookieStore","$window","$interval","rpc","daChuDialog","geo","urlHistoryService","daChuLocal",function(e,o,s,t,i,n,a,l,r,c,d,u){function m(){var o,s;for(o=0;o<b.length;o++)if(s=b[o],e.basic_form[s.name].$invalid)return void r.alert(s.info);return 2===e.shop.id&&e.basic_form.shop_child.$invalid?void r.alert("请选择商家连锁类型"):void 0}function p(){return n.jsInterface&&n.jsInterface.findRestaurantOnMap?!0:!1}e.urls=null,n.callback_function.upload=function(o){e.urls=JSON.parse(o),e.$apply()},e.upload=function(){n.jsInterface&&n.jsInterface.pictureUpload?n.jsInterface.pictureUpload("window.callback_function.upload"):r.alert("此版本无法上传图片,请安装安卓客户端")},e.addr={province:""},e.direction=null,e.addPotential=function(){s.go("page.potential")},e.userGeo={lat:0,lng:0,addr:""},e.suborderInfo=function(){o.open({templateUrl:"suborderInfo.html"})};var g=!1;n.geoData.callback=function(o){e.userGeo.lat=o.latitude,e.userGeo.lng=o.longitude,e.userGeo.addr=o.address,e.$apply()};var f=function(){e.addr.province="",e.lines=""},v=function(){var o=0;e.addr.province&&(o=e.addr.province.id);var s=[];angular.forEach(e.allLines,function(e){o==e.location_id&&s.push(e)}),e.lines=s};e.storeLine=function(){var o={id:e.addr.line.id};u.set("last_line",o)},e.show_ka=function(){e.show_ka_option=e.customerType&&"KA客户"===e.customerType.name&&2===parseInt(e.customerType.value)?!0:!1},e.show_more_account_option=function(){return e.account_type?void(e.show_account_son=1!==parseInt(e.account_type.value)?!0:!1):void(e.show_account_son=!1)};var h=function(){l.load("customer/create_input","GET").then(function(o){e.provinces=o.provinces,e.allLines=o.lines,e.dOptions=o.directions,e.oDimensions=o.dimensions;var s=u.get("city_id");return s?(angular.forEach(e.provinces,function(o){o.id==s&&(e.addr.province=o)}),e.shopTypes=o.shop_type,e.types=o.types,e.account_types=o.account_types,e.estimateds=o.estimated,void v()):(r.alert("登录超时，请重新登录"),void l.redirect("user/login"))},function(o){e.error={cls:"alert alert-danger",message:o}})};e.getProvince=function(){f()},e.getLines=function(){v()},e.testnum=10,e.choosePlace=function(){if(n.jsInterface&&n.jsInterface.findRestaurantOnMap)n.jsInterface.findRestaurantOnMap();else{var o=c.info();o.then(function(o){e.userGeo.lat=o.lat,e.userGeo.lng=o.lng,r.alert("客户地址定位成功！")},function(e){r.alert("获取位置错误, "+e),g=!0})}},e.bindProperty=function(o,s){e[o]=s},e.get_cycle=function(){if(e.billing_cycle){var o=e.billing_cycle.value;e.m_check_dates=e.check_dates[o],e.m_invoice_dates=e.invoice_dates[o],e.m_pay_dates=e.pay_dates[o]}};var b=[{name:"customerType",info:"请选择客户类型"},{name:"accountType",info:"请选择子母账号类型"},{name:"shop",info:"请选择商家类别"},{name:"dimensions",info:"请选择店铺规模"},{name:"estimateVegetable",info:"请选择预估日均果蔬采购量"},{name:"estimateRice",info:"请选择预估日均米面粮油采购量"},{name:"mobile",info:"请输入客户手机号"},{name:"username",info:"请输入客户姓名"},{name:"province",info:"请选择省市信息"},{name:"line",info:"请选择配送线路"},{name:"address",info:"请填写详细地址"},{name:"direction",info:"请选择商家方位"},{name:"shop_name",info:"请填写商铺名"}];
e.create=function(){if(e.basic_form.$invalid){if(!e.basic_form.mobile.$dirty)return m(),!1;if(e.basic_form.mobile.$invalid)return r.alert("请输入正确手机号"),!1}if(1!==parseInt(e.account_type.value)&&!e.parent_mobile)return void r.alert("请填写关联母账号");var o=0,t=0;if(void 0==e.shopChild?o=e.shop.id:(o=e.shopChild,t=e.shopChild.is_link),!(g||e.userGeo.lat&&e.userGeo.lng))return void r.alert("请定位此用户位置信息，再提交！");if(null===e.urls)return void r.alert("请上传至少一张商家门店图片");var i=e.info.dimensions||{value:""},n=e.direction||{value:""},a={name:e.info.name,shopType:o,isLink:t,dimensions:i.value,mobile:e.info.mobile,provinceId:e.addr.province.id,lineId:e.addr.line.id,address:e.userGeo.addr,lat:e.userGeo.lat,lng:e.userGeo.lng,shopName:e.info.shop_name,direction:n.value,customerType:e.customerType.value,remark:e.info.remark,pic_urls:e.urls,is_located:p()===!0?1:0,greens_meat_estimated:e.info.estimateVegetable.value,rice_grain_estimated:e.info.estimateRice.value,account_type:e.account_type.value};e.parent_mobile&&(a.parent_mobile=e.parent_mobile),e.isRequesting=!0,l.load("potential_customer/create","POST",a).then(function(){return r.alert("恭喜，潜在客户添加成功！请在客户管理中开通和编辑客户"),e.isRequesting=!1,s.go("page.manage"),!1},function(o){r.alert("潜在客户添加失败，失败原因:"+o),e.isRequesting=!1})},h(),e.showModal=function(){}}]),angular.module("dachuwang").controller("crmCtrl",["$scope","$state","$stateParams","$log","$window","$modal","rpc","pagination","daChuDialog","geo","urlHistoryService","daChuLocal",function(e,o,s,t,i,n,a,l,r,c,d,u){function m(o){var t=10,i={itemsPerPage:t,currentPage:l.page,key:e.key};if(s.invite_id&&(i.invite_id=s.invite_id),!e.filter){var n=u.get("filter_sift");n&&(e.filter={sift:n})}!function(e){if(null!==e){var o={};e.order&&!p(e.order)&&e.order.by&&(o.order={by:e.order.by.val,way:e.order.way}),e.sift&&!p(e.sift)&&(o.sift={},function(){var s,t,i;for(i=["line","site","province"],t=i.length,s=0;t>s;s++)e.sift[i[s]]&&(o.sift[i[s]]=parseInt(e.sift[i[s]].id));e.sift.dimensions&&(o.sift.dimensions=e.sift.dimensions.value),e.sift.shop_type&&(o.sift.shop_type=e.sift.shop_type.id)}()),p(o)||(i.conditions=o)}}(e.filter),a.load(g[e.showType],"POST",i).then(function(s){angular.forEach(s.list,function(o){if(0===e.showType)try{var s=JSON.parse(o.geo);o.geo=s}catch(t){o.geo=null}e.list.push(o)}),o(s.list.length<t?!0:!1),e.totalItems=s.total>0?s.total:0,i.key||i.conditions?e.siftNumber=s.total:(e.totalNumber=s.total,e.siftNumber=s.total)})}function p(e){var o;for(o in e)return!1;return!0}e.loadingGeo=!1;var g=["potential_customer/lists","customer/new_register_lists","customer/undone_lists","customer/after_sale_lists","shared_customer/potential_lists","shared_customer/new_register_lists"];e.oSea=[{name:"私海潜在客户",value:0},{name:"私海新注册客户",value:1},{name:"私海新下单客户",value:2},{name:"公海潜在客户",value:4},{name:"公海新注册客户",value:5}],e.seachange=function(o){e.changeStatus(o.value)},e.role_id=!0,e.role_id13=!0;var f=parseInt(u.get("role_id"));12==f&&(e.role_id=!1),13==e.role_id13&&(e.role_id13=!1),e.oSea_am={name:"私海老客户",value:1},f>=14&&(e.oSea=[],e.oSea.push(e.oSea_am)),e.list=[],e.func={shopInfosea:function(s){d.push(e.showType),o.go("page.seainfodetail",{uid:parseInt(s.id)})},shopInfo:function(s){d.push(e.showType),o.go("page.customerdetail",{uid:parseInt(s.id)})},potential_change_shared:function(o){r.tips({bodyText:"是否确定要把客户放到公海?",actionText:"确定",ok:function(){e.change_button=!0;var s=parseInt(o.id);a.load("shared_customer/potential_change_shared","POST",{cid:s}).then(function(){for(var o=0;o<e.list.length;o++)parseInt(e.list[o].id)===s&&e.list.splice(o,1);r.alert("操作成功"),e.change_button=!1},function(o){r.alert(o),e.change_button=!1})}})},potential_change_private:function(o){var s=parseInt(o.id);e.change_button=!0,a.load("shared_customer/potential_change_private","POST",{cid:s}).then(function(){for(var o=0;o<e.list.length;o++)parseInt(e.list[o].id)===s&&e.list.splice(o,1);r.alert("操作成功"),e.change_button=!1},function(o){r.alert(o),e.change_button=!1})},new_register_change_private:function(o){var s=parseInt(o.id);e.change_button=!0,a.load("shared_customer/new_register_change_private","POST",{cid:s}).then(function(){for(var o=0;o<e.list.length;o++)parseInt(e.list[o].id)===s&&e.list.splice(o,1);r.alert("操作成功"),e.change_button=!1},function(o){r.alert(o),e.change_button=!1})}};var f=parseInt(u.get("role_id"));e.showTabs=function(e){var o=[12,13,14,15];return-1!==o.indexOf(e)?!0:!1}(parseInt(u.get("role_id"))),e.showType=function(e){if(e&&14>f){var o=d.pop();return o>=0?o:0}return 3}(e.showTabs),e.defaultsea=function(o){for(var s=0;s<e.oSea.length;s++)if(o===e.oSea[s].value)return e.oSea[s];return e.oSea[0]}(e.showType),e.filter=null,e.pagination=l,e.pagination.init(m),e.pagination.nextPage(),e.changeStatus=function(o){e.showType!==o&&(u.remove("filter_sift"),e.filter=null,e.showType=o,e.key="",e.list=[],e.pagination.init(m),e.list.length<1&&e.pagination.nextPage())},e.search=function(){e.list=[],e.pagination.init(m),e.pagination.nextPage()},e.resetPass=function(o){e.resetClk=!0,r.tips({bodyText:"是否要重置该用户密码",actionText:"确定",ok:function(){var s={uid:o};a.load("customer/update_password","POST",s).then(function(o){e.resetClk=!1,r.alert(o.content)},function(){r.alert("重置密码失败，请联系技术人员")})}})},e.setStatus=function(o,s){e.list[o].status=s;var t=e.list[o].id,i={uid:t,status:s};a.load("customer/set_status","POST",i).then(function(){r.alert(0==s?"禁用成功":"启用成功")},function(e){r.alert(e)})};var v=null;i.geoData.callback=function(e){if(null===v)return r.alert("你必须选择一个用户"),!1;var o={id:v.id,geo:{lat:e.latitude,lng:e.longitude}};a.load("customer/edit","POST",o).then(function(o){0==o.status?(v.geo.lat=e.latitude,v.geo.lng=e.longitude,v.is_located=1,r.alert("更新成功")):r.alert("更新失败")},function(e){r.alert("更新失败 "+e)})},e.viewMap=function(e){e.lat&&e.lng?i.jsInterface&&i.jsInterface.searchLine?i.jsInterface.searchLine(JSON.stringify({latitude:e.lat,longitude:e.lng})):r.alert("lat:"+e.lat+", lng:"+e.lng+" 暂不支持查看地图"):r.alert("位置信息不全无法查看,请更新位置信息")},e.updateGeo=function(o){var s=o.id;if(!s)return r.alert("出错了"),!1;if(i.jsInterface&&i.jsInterface.findRestaurantOnMap)v=o,i.jsInterface.findRestaurantOnMap();else{e.loadingGeo=!0;var t=null;c.info().then(function(e){var o={id:s,geo:{lat:e.lat,lng:e.lng}};return t=e,a.load("customer/edit","POST",o)}).then(function(s){e.loadingGeo=!1,0==s.status?(o.geo=t,o.is_located=1,r.alert("更新成功")):r.alert("更新失败")},function(o){e.loadingGeo=!1,r.alert("更新失败 "+o)})}},e.openUser=function(e){o.go("page.openpot",{potid:e})},e.editUser=function(e){o.go("page.editpot",{potid:e})},e.deleteUser=function(e){r.tips({bodyText:"确定要删除客户?",actionText:"确定",ok:function(){a.load("potential_customer/delete","POST",{id:e}).then(function(e){0==e.status?(r.alert("删除成功"),i.location.reload(!0)):r.alert("删除失败 "+e.msg)},function(e){r.alert("删除失败 "+e)})}})},e.editCustomer=function(e){o.go("page.editcustomer",{customer_id:e})},e.filterfunc=function(){var o=!0,s=n.open({animation:o,templateUrl:"app/modules/custorm/filter.html",controller:"FilterController"});s.result.then(function(o){e.filter=o,e.list=[],e.pagination.init(m),e.list.length<1&&e.pagination.nextPage()},function(e){console.log(e)})},i.callback_function.sellerRequest=function(e){a.load("customer/nearby_lists","POST",e).then(function(e){i.jsInterface.onReceiveSellers(JSON.stringify(e.list))})},i.callback_function.cdetail=function(e){o.go("page.customerdetail",{uid:parseInt(e)})}}]),angular.module("dachuwang").controller("SeainfoController",["$rootScope","$scope","$state","$window","rpc","daChuDialog","Lightbox","urlHistoryService","daChuLocal",function(e,o,s,t,i,n,a,l,r){o.customer={},o.history={},o.baseinfo={},o.isLoading=!0,o.historymsg=o.basemsg=!0,o.userinfo={newmsg:"最新短信",history:"历史信息",baseinfo:"基本信息"},i.load("cdetail/index","POST",{action:"get_all",uid:s.params.uid}).then(function(e){o.isLoading=!1,o.imgurl=e.list.basic_info.urls,o.customer.sms=e.list.sms,o.history=e.list.his_data,o.baseinfo=e.list.basic_info}),o.openmodal=function(s){for(var t=[],i=0;i<o.imgurl.length;i++)t.push({url:o.imgurl[i].url});e.imglength=t.length,a.openModal(t,s)},o.role_id=!0;var c=parseInt(r.get("role_id"));12!=c&&(o.role_id=!1),o.func={new_register_change_private:function(){var e=parseInt(o.baseinfo.id);o.change_button=!0,i.load("shared_customer/new_register_change_private","POST",{cid:e}).then(function(){t.alert("操作成功"),o.change_button=!1,l.push(5),s.go("page.manage")},function(e){t.alert(e),o.change_button=!1})},history_detail:function(){s.go("page.cdetailhistory",{uid:o.baseinfo.id})}}}]),angular.module("dachuwang").controller("HisController",["$scope","$state","rpc",function(e,o,s){e.func={goback:function(){o.go("page.customerdetail")}},e.isLoading=!0,e.historylist={},s.load("cdetail/index","POST",{action:"get_history_belong_detail",uid:o.params.uid}).then(function(o){e.isLoading=!1,e.data=o.list,e.historylist.list=e.data;for(var s in e.historylist.list)e.historylist.list[s].time=1e3*e.historylist.list[s].time})}]),angular.module("dachuwang").controller("CtrendsController",["$scope","$state","$window","rpc","pagination","daChuDialog",function(e,o,s,t,i,n){function a(e){return new Date(e).valueOf()/1e3}function l(s){e.isloading=!0;var n,l=10,r={action:"get_customer_orders",uid:parseInt(o.params.uid),itemsPerPage:l,currentPage:i.page};null!==e.startTime&&(r.begin_time=a(e.startTime)),null!==e.endTime&&(r.end_time=a(e.endTime)),t.load("cdetail/index","POST",r).then(function(o){for(e.isloading=!1,n=0;n<o.list.length;n++)o.list[n].created_time*=1e3,e.orderlist.push(o.list[n]);s(o.list.length<l?!0:!1)})}e.startTime=null,e.endTime=null,e.dateOptions={formatYear:"yy",startingDay:1},e.endDateOptions={formatYear:"yy",startingDay:1},e.endOpened=e.opened=!1,e.open=function(o){o.preventDefault(),o.stopPropagation(),e.opened=!0},e.endOpen=function(o){o.preventDefault(),o.stopPropagation(),e.endOpened=!0},e.func={orderinfo:function(e){o.go("page.customerdetail.orderdetail",{order_number:e.order_number})},sift:function(){var o=null,s=null;return e.startTime&&(o=a(e.startTime)),e.endTime&&(s=a(e.endTime)),null===o&&null===s?void n.alert("起始时间和结束时间至少选一项"):null!==o&&null!==s&&o>s?void n.alert("最早时间不能大于最晚时间"):(e.orderlist=[],e.pagination.init(l),void e.pagination.nextPage())},clear:function(){e.startTime=null,e.endTime=null,e.orderlist=[],e.pagination.init(l),e.pagination.nextPage()}},e.orderlist=[],e.pagination=i,e.pagination.init(l),e.pagination.nextPage()}]),angular.module("dachuwang").controller("CtrendsOrderController",["$scope","$state","rpc",function(e,o,s){e.func={userback:function(){o.go("page.customerdetail.trends")}},e.isLoading=!0,e.customerlist={},s.load("cdetail/index","POST",{action:"get_order_detail",order_number:o.params.order_number}).then(function(o){e.isLoading=!1,e.data=o.list,e.customerlist.sale_name=e.data.sale_name.name,e.customerlist.number=e.data.order_number,e.customerlist.status=e.data.status,e.customerlist.money=parseInt(e.data.total_price)/100,e.customerlist.reallymoney=parseInt(e.data.deal_price)/100;for(var s in e.data.content)e.data.content[s].sum_price=parseInt(e.data.content[s].sum_price)/100;e.customerlist.time=1e3*e.data.created_time,e.data.deliver_time=1e3*e.data.deliver_time,e.customerlist.content=e.data.content})}]),angular.module("dachuwang").controller("CdetailNavController",["$scope","$state",function(e,o){e.showType=0,e.statusopen=!0,e.func={historyGo:function(){o.go("page.customerdetail.cdetailhistory")}},e.newmsg=e.historymsg=e.basemsg=!0,e.setStatus=function(o){e.showType=o},e.tabs=[{status:0,href:"page.customerdetail",name:"客户信息"},{status:1,href:"page.customerdetail.trends",name:"客户动态"}],e.userinfo={newmsg:"最新短信",history:"历史信息",baseinfo:"基本信息"}}]),angular.module("dachuwang").controller("CdetailInfoController",["$rootScope","$scope","$state","$window","rpc","daChuDialog","Lightbox","urlHistoryService","daChuLocal",function(e,o,s,t,i,n,a,l,r){o.customer={},o.history={},o.baseinfo={},o.isLoading=!0,o.ka_info=!0,i.load("cdetail/index","POST",{action:"get_all",uid:s.params.uid}).then(function(e){o.isLoading=!1,o.imgurl=e.list.basic_info.urls,o.customer.sms=e.list.sms,o.history=e.list.his_data,o.baseinfo=e.list.basic_info}),o.openmodal=function(s){for(var t=[],i=0;i<o.imgurl.length;i++)t.push({url:o.imgurl[i].url});e.imglength=t.length,a.openModal(t,s)},o.role_id=!0;var c=parseInt(r.get("role_id"));12!=c&&(o.role_id=!1),o.func={edit_customer:function(){return o.baseinfo.ka_info?void n.alert("不允许编辑KA客户"):void s.go("page.editcustomer",{customer_id:s.params.uid})},reset_password:function(){console.log("reset"),o.resetClk=!0,n.tips({bodyText:"是否要重置该用户密码",actionText:"确定",ok:function(){var e={uid:s.params.uid};i.load("customer/update_password","POST",e).then(function(e){o.resetClk=!1,n.alert(e.content)},function(){n.alert("重置密码失败，请联系技术人员")})}})},history_detail:function(){s.go("page.customerdetail.cdetailhistory")},view_map:function(){var e={lat:o.baseinfo.lat,lng:o.baseinfo.lng};e.lat&&e.lng?t.jsInterface&&t.jsInterface.searchLine?t.jsInterface.searchLine(JSON.stringify({latitude:e.lat,longitude:e.lng})):n.alert("lat:"+e.lat+", lng:"+e.lng+" 暂不支持查看地图"):n.alert("位置信息不全无法查看,请更新位置信息")},new_register_change_shared:function(){n.tips({bodyText:"是否确定要把客户放到公海?",actionText:"确定",ok:function(){o.change_button=!0;var e=parseInt(o.baseinfo.id);i.load("shared_customer/new_register_change_shared","POST",{cid:e}).then(function(e){0==e.status?(n.alert("操作成功"),l.push(1),s.go("page.manage")):n.alert("操作失败："+e.msg)}).then(function(){o.change_button=!1},function(){n.alert("操作失败：网络不好或服务器内部错误"),o.change_button=!1})}})}}}]),angular.module("dachuwang").controller("CdetailHisController",["$scope","$state","rpc",function(e,o,s){e.func={goback:function(){o.go("page.customerdetail")}},e.isLoading=!0,e.historylist={},s.load("cdetail/index","POST",{action:"get_history_belong_detail",uid:o.params.uid}).then(function(o){e.isLoading=!1,e.data=o.list,e.historylist.list=e.data;for(var s in e.historylist.list)e.historylist.list[s].time=1e3*e.historylist.list[s].time})}]),angular.module("dachuwang").controller("pageCtrl",["$scope",function(){}]),angular.module("dachuwang").controller("ModalInstanceCtrl",["$scope","$modalInstance","items",function(e,o,s){e.items=s,e.selected={item:e.items[0]},e.ok=function(){o.close(e.selected.item)},e.cancel=function(){o.dismiss("cancel")}}]),angular.module("dachuwang").controller("headerCtrl",["$scope","$state","$window","daChuLocal",function(e,o,s,t){e.$state=o,e.showMap=function(){var e=parseInt(t.get("role_id"));s.jsInterface&&s.jsInterface.cloudMap?s.jsInterface.cloudMap(e):s.alert("请使用客户端操作！")}}]),angular.module("dachuwang").controller("footerCtrl",["$scope","$state","daChuLocal","$cookieStore",function(e,o,s){function t(o){s.remove("filter_sift"),e.showType=e.tabList[o].status}var i=[{name:"业绩统计",glyphicon:"glyphicon-home",href:"page.homemanage",status:"home"},{name:"客户管理",glyphicon:"glyphicon-cloud",href:"page.manage",status:"crm",showBadge:!0},{name:"添加客户",glyphicon:"glyphicon-plus",href:"page.custorm",status:"custorm"},{name:"更多",glyphicon:"glyphicon-option-horizontal",status:"more",href:"page.more"}],n=[12,13],a=parseInt(s.get("role_id"));12!=a&&i.splice(2,1),null===a||-1===n.indexOf(a),e.$on("pageChanged",function(e,o){t(o.tabIndex)}),e.tabList=i,e.collen=12/e.tabList.length,e.showType=function(o){return e.tabList[o].status}(o.current.data.tabIndex)}]),angular.module("dachuwang").factory("userAuthService",["rpc","$cookieStore","daChuLocal",function(e,o,s){var t=function(){var o=s.get("token");o||e.redirect("user/login")},i=function(){var e=s.get("token");return!!e};return{checkLogin:t,isLogined:i}}]),angular.module("dachuwang").factory("userService",["$http","$q","appConfigure","daChuLocal",function(e,o,s,t){var i=s.url,n=3e4,a=function(){var s=new Date,a=t.get("baseInfo");if(a&&!isNaN(a.pro_time)&&a.pro_time+n>s.getTime())return o.when(a.data);var l=o.defer();return e.get(i+"/customer/baseinfo").success(function(e){var o=[];if(0===e.status){var o=e.info;t.set("packaged_cate",{pro_time:s.getTime(),data:o}),l.resolve(o)}else l.reject("status not equals 0")}).error(function(e){l.reject(e)}),l.promise},l=function(e){var s=o.defer(),i={topName:"",list:[]},n=t.get("cateArr");if(n&&n.list.top.length>0){var a=!1;angular.forEach(n.list.second,function(o){angular.forEach(o,function(o){return o.id===e?(i.topName=o.name,void(a=!0)):void 0}),a===!0}),a===!1&&s.reject("error parent category id"),angular.forEach(n.list.second_child[e],function(e){i.list.push({pro_name:e.name,pro_id:e.id,pro_upid:e.upid})}),s.resolve(i)}else s.reject("you must load home page first");return s.promise};return{baseInfo:a,changePassword:l}}]),angular.module("dachuwang").factory("urlHistoryService",function(){function e(e){t.length>=i&&t.shift(),t.push(e)}function o(){if(t.length<=0)return 0;var e=t.pop();return e}function s(){return t.length<=0?0:t[t.length-1]}var t=[],i=20;return{push:e,pop:o,getLast:s}}),angular.module("dachuwang").factory("daChuTimer",function(){var e={getNow:function(){return parseInt((new Date).getTime()/1e3)},cacheTime:30};return{getNow:e.getNow,setCacheTime:function(o){e.cacheTime=parseInt(o)},compare:function(o){var s=this.getNow();return parseInt(o)+e.cacheTime>s?!0:!1}}}),angular.module("dachuwang").factory("rpc",["$http","$q","$location","$cookieStore","appConfigure","daChuLocal",function(e,o,s,t,i,n){return{load:function(s,t,a){var l=this,r=o.defer();return void 0==t&&(t="POST"),e({url:i.url+"/"+s+"?r="+Math.random(),method:t,cache:!1,withCredentials:!0,data:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){e&&-100===e.status?(n.remove("token"),r.reject("您还未登录，请先登录。"),l.redirect("/user/login",l.refer)):e&&0===e.status?r.resolve(e):r.reject(e&&0!==e.status?e.msg+" 服务器拒绝添加":"请求失败，请检查网络。")}).error(function(){r.reject("请求无法发送到服务器")}),r.promise},init:s,refer:"/",redirect:function(e,o){return void 0!=o?this.refer=o:""==e&&s.path(this.refer),s.path(e),!1}}}]),angular.module("dachuwang").factory("pagination",function(){var e={page:0,isProcessing:!1,processingText:"努力加载中...",isDone:!1,more:"点击加载更多",callback:null};return e.nextPage=function(){e.isProcessing||e.isDone||(e.more="正在加载更多...",e.isProcessing=!0,e.page++,e.callback&&e.callback(function(o){o?(e.isDone=!0,e.more="没有更多了"):e.more="点击加载更多",e.isProcessing=!1}))},e.init=function(o){e.page=0,e.isProcessing=!1,e.isDone=!1,e.more="点击加载更多",e.callback=o},e}),angular.module("dachuwang").factory("notifyService",["$http",function(){var e=function(){return[{title:"您的订单201502280123已经在配送路上",content:"这里是详情"},{title:"您的订单201502280188已经在配送路上",href:"这里是详情"}]};return{getAll:e}}]),angular.module("dachuwang").factory("daChuLocal",function(){var e={get:function(e){var o=localStorage.getItem(e);return o?JSON.parse(o):null},set:function(e,o){localStorage.setItem(e,JSON.stringify(o))},remove:function(e){localStorage.removeItem(e)}};return e}),angular.module("dachuwang").factory("geo",["$q",function(e){var o=function(){var o={lat:"",lng:""},s=e.defer();return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){o.lat=e.coords.latitude,o.lng=e.coords.longitude,s.resolve(o)},function(e){s.reject("ERROR("+e.code+"):"+e.message)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):s.reject("未开启GPS定位，请先打开手机的GPS定位功能"),s.promise};return{info:o}}]),angular.module("dachuwang").factory("daChuDialog",["$modal","$window",function(e,o){var s=function(o,s){var t={headerText:"提示信息",bodyText:"设置成功",closeText:"关闭"},i={templateUrl:"myModalContent.html"};angular.extend(i,s),angular.extend(t,o);e.open({templateUrl:i.templateUrl,controller:"ModalInstanceCtrl",resolve:{items:function(){return t}}})},t=function(e){o.jsInterface?o.jsInterface&&o.jsInterface.toast&&o.jsInterface.toast(e):o.alert(e)};return{tips:s,alert:t}}]),angular.module("ngLocale",[],["$provide",function(e){var o={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["上午","下午"],DAY:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ERANAMES:["公元前","公元"],ERAS:["公元前","公元"],FIRSTDAYOFWEEK:6,MONTH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],SHORTMONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],WEEKENDRANGE:[5,6],fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"y年M月d日 ah:mm:ss",mediumDate:"y年M月d日",mediumTime:"ah:mm:ss","short":"yy/M/d ah:mm",shortDate:"yy/M/d",shortTime:"ah:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"¥",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"¤ -",negSuf:"",posPre:"¤ ",posSuf:""}]},id:"zh-cn",pluralCat:function(){return o.OTHER}})}]),angular.module("dachuwang").filter("money",function(){return function(e,o){return e=parseFloat(e)||0,o=0/0!=parseInt(o)?parseInt(o):1,e.toFixed(o)}}),angular.module("dachuwang").directive("updateTitle",["$rootScope","$timeout",function(e,o){return{link:function(s,t){var i=function(e,s){var i="大厨网";s.data&&s.data.pageTitle&&(i=s.data.pageTitle),o(function(){t.text(i)},0,!1)};e.$on("$stateChangeSuccess",i)}}}]),angular.module("dachuwang").directive("updateBackstack",["$rootScope","req",function(e){return{link:function(o,s){var t=function(e,o){var t="page";o.backPath&&(t=o.backPath),s.attr("ui-sref",t)};e.$on("$stateChangeSuccess",t)}}}]),angular.module("dachuwang").directive("reback",["$state",function(e){return{link:function(o,s){s.bind("click",function(){var o=e.current.data;o.backState?e.go(o.backState):history.go(-1)})}}}]),angular.module("dachuwang").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,o,s){function t(e){var o=localStorage.getItem(e);return o?parseInt(JSON.parse(o)):null}function i(){var e=t("role_id");return null===e||-1!==r.indexOf(e)?!0:!1}var n="app/modules/",a="components/",l="大厨CRM",r=[12,14],c={home:0,crm:1,custorm:2,more:3};e.state("page",{url:"/",data:{pageTitle:l,tabIndex:c.home},views:{"":{templateUrl:a+"page/page.html",controller:"pageCtrl"},"@page":{templateUrl:function(){return i()?n+"home/home.html":n+"home/dblist.html"},controllerProvider:function(){return i()?"homeCtrl":"DblistController"}}}}).state("page.home",{url:"home/{bd_id:.*}",templateUrl:n+"home/home.html",controller:"homeCtrl",data:{pageTitle:l,tabIndex:c.home,showBack:i()?!1:!0}}).state("page.homemanage",{url:"statistic",templateUrl:function(){return i()?n+"home/home.html":n+"home/dblist.html"},controllerProvider:function(){return i()?"homeCtrl":"DblistController"},data:{pageTitle:l,tabIndex:c.home}}).state("loginpage",{url:"/user/login",data:{pageTitle:"登录"},templateUrl:n+"user/login.html",controller:"loginCtrl"}).state("page.password",{url:"user/password",data:{pageTitle:"修改密码",showBack:!0},templateUrl:n+"user/password.html",controller:"userPassCtrl"}).state("page.editcustomer",{url:"edit/:customer_id",data:{pageTitle:"编辑客户",showBack:!0},templateUrl:n+"custorm/editcustomer.html",controller:"EditCustomerController"}).state("page.crm",{url:"crm/:invite_id",data:{pageTitle:"客户管理",tabIndex:c.crm,showBack:!0,showMap:!0},templateUrl:function(){return n+"custorm/list.html"},controller:"crmCtrl"}).state("page.potlist",{url:"potlist/:invite_id",data:{pageTitle:"潜在客户",tabIndex:c.crm,showBack:!0},templateUrl:n+"custorm/potlist.html",controller:"PotlistController"}).state("page.openpot",{url:"openpot/:potid",data:{pageTitle:"添加客户",tabIndex:c.custorm,showBack:!0},templateUrl:n+"custorm/openpot.html",controller:"OpenpotController"}).state("page.editpot",{url:"editpot/:potid",data:{pageTitle:"编辑客户",tabIndex:c.custorm,showBack:!0},templateUrl:n+"custorm/editpot.html",controller:"EditpotController"}).state("page.manage",{url:"manage",data:{pageTitle:"客户管理",tabIndex:c.crm,showMap:!0},templateUrl:function(){return i()?n+"custorm/list.html":n+"custorm/manage.html"},controllerProvider:function(){return i()?"crmCtrl":"manageController"}}).state("page.custorm",{url:"custorm",data:{pageTitle:"添加客户",tabIndex:c.custorm},templateUrl:function(){return n+"custorm/create.html"},controller:"custormCtrl"}).state("page.potential",{url:"potential",data:{pageTitle:"潜在客户",tabIndex:c.custorm,showBack:!0},templateUrl:n+"custorm/potential.html",controller:"PotentialController"}).state("page.userCenter",{url:"user/center",templateUrl:n+"user/center.html",controller:"UserCenterCtrl",data:{pageTitle:"个人中心",tabIndex:c.more,showBack:!0}}).state("page.seainfodetail",{url:"seainfo/{uid:int}",templateUrl:n+"cdetail/seainfo.html",controller:"SeainfoController",data:{pageTitle:"客户详情",tabIndex:c.more,showBack:!0}}).state("page.more",{url:"more",templateUrl:n+"more/more.html",controller:"MoreController",data:{pageTitle:"更多",tabIndex:c.more}}).state("page.customerdetail",{url:"cdetail/{uid:int}",data:{pageTitle:"客户详情",tabIndex:c.crm,showBack:!0},views:{"":{templateUrl:n+"cdetail/cdetailnav.html",controller:"CdetailNavController"},"@page.customerdetail":{templateUrl:n+"cdetail/cdetailinfo.html",controller:"CdetailInfoController"}}}).state("page.customerdetail.cdetailhistory",{url:"/his",data:{pageTitle:"历史归属",tabIndex:c.crm,showBack:!0},templateUrl:n+"cdetail/cdetailhis.html",controller:"CdetailHisController"}).state("page.cdetailhistory",{url:"{uid:int}/history",data:{pageTitle:"历史归属",tabIndex:c.crm,showBack:!0},templateUrl:n+"cdetail/history.html",controller:"HisController"}).state("page.customerdetail.trends",{url:"/trends",data:{pageTitle:"客户动态",tabIndex:c.crm,showBack:!0},templateUrl:n+"cdetail/trends.html",controller:"CtrendsController"}).state("page.customerdetail.orderdetail",{url:"/order/{order_number}",data:{pageTitle:"订单详情",tabIndex:c.crm,showBack:!0},templateUrl:n+"cdetail/orderdetail.html",controller:"CtrendsOrderController"}),o.otherwise("/home"),s.html5Mode(!0)}]),angular.module("dachuwang").config(["$tooltipProvider",function(e){e.setTriggers({click:"mouseleave"})}]),angular.module("dachuwang").provider("appConfigure",{$get:["$location",function(e){var o=e.$$host;return o.indexOf("dachuwang")<0&&(o="crm.dachuwang.net"),{bd_and_am:[12,14],url:"http://api."+o}}]}),angular.module("dachuwang").run(["$templateCache",function(e){e.put("components/footer/footer.html",'<nav class="nav fix-bottom action-nav" ng-controller="footerCtrl"><div class="container"><ul class="nav action-nav actionbar-tabs"><li class="col-xs-{{collen}}" ng-repeat="tab in tabList" ng-class="{active : showType == tab.status}"><a ui-sref="{{tab.href}}"><span class="glyphicon {{tab.glyphicon}}"></span>{{tab.name}}</a></li></ul></div></nav>'),e.put("components/header/header.html",'<header class="head" ng-controller="headerCtrl"><div class="container-fluid"><div class="row head-top"><div class="col-xs-4 backup text-left"><a reback="" ng-show="$state.current.data.showBack"><span class="glyphicon glyphicon-menu-left"></span>&nbsp;返回</a> <em ng-show="!$state.current.data.showBack">&nbsp;</em></div><div class="col-xs-4 listname" ng-bind="$state.current.data.pageTitle"></div><div class="col-xs-4"><div class="pull-right" ng-show="$state.current.data.showMap" ng-click="showMap()"><img src="assets/images/icon.png" height="30" width="30"> <span>云图</span></div><em ng-show="!$state.current.data.showMap">&nbsp;</em></div></div></div></header><script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <p class="text-center">{{items.bodyText}}</p> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script>'),e.put("components/page/page.html",'<div ng-include="\'components/header/header.html\'"></div><div ui-view=""></div><div ng-include="\'components/footer/footer.html\'"></div>'),e.put("app/modules/cdetail/cdetailhis.html",'<div ng-show="isLoading === false" class="cdetail_wp"><dl class="block cdedl"><dt><span class="pull-right">所属销售</span> <span>时间</span></dt><dd ng-repeat="m in historylist.list"><span class="pull-right">{{m.name}}({{m.role}})</span> {{m.time | date :\'yyyy/MM/dd\'}}</dd><a ng-click="func.goback()" class="btn btn-block btn-success">返回</a></dl></div><div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div>'),e.put("app/modules/cdetail/cdetailinfo.html",'<div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="cdetail_wp" ng-if="isLoading === false"><accordion close-others="one"><accordion-group is-open="newmsg"><accordion-heading>{{userinfo.newmsg}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : newmsg, \'glyphicon-chevron-right\' : !newmsg}"></i></accordion-heading><div>{{customer.sms}}</div></accordion-group><accordion-group is-open="historymsg"><accordion-heading>{{userinfo.history}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : historymsg, \'glyphicon-chevron-right\' : !historymsg}"></i></accordion-heading><div class="cdelist"><ul class="list-group"><li>历史订单数<span class="pull-right">{{history.order_num}}</span></li><li>历史流水金额<span class="c_fs14 pull-right">{{history.order_amount/100 | currency : \'￥\' : 2}}</span></li><li>历史移交记录<span class="pull-right"><span class="glyphicon glyphicon-chevron-right" ng-click="func.history_detail()"></span></span></li></ul></div></accordion-group><accordion-group is-open="basemsg"><accordion-heading>{{userinfo.baseinfo}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : basemsg, \'glyphicon-chevron-right\' : !basemsg}"></i></accordion-heading><div class="cdelist"><ul class="list-group"><li>注册时间<span class="pull-right">{{baseinfo.created_time*1000 | date:\'yyyy-MM-dd\'}}</span></li><li>店铺名称<span class="pull-right">{{baseinfo.shop_name}}</span></li><li>客户姓名<span class="pull-right">{{baseinfo.name}}</span></li><li class="mobile-phone">手机号<span class="pull-right">{{baseinfo.mobile}}<a class="phone" href="tel:{{baseinfo.mobile}}"><span class="glyphicon glyphicon-earphone ml-10"></span></a></span></li><li>餐饮类别<span class="pull-right">{{baseinfo.shop_type}}</span></li><li>店铺规模<span class="pull-right">{{baseinfo.dimension_name}}</span></li><li class="address">详细地址<span class="pull-right"><a ng-click="func.view_map()"><span class="glyphicon glyphicon-map-marker ml-10"></span></a></span><span class="pull-right adress_text">{{baseinfo.address}}</span></li><li>配送线路<span class="pull-right">{{baseinfo.line}}</span></li><li>备注<span class="pull-right">{{baseinfo.remark}}</span></li></ul></div><div class="img_b mb-10 clearfix" ng-if="imgurl.length > 0"><div class="img_block"><a ng-click="openmodal(0)"><img width="100%" ng-src="{{imgurl[0].url}}"></a></div></div><div class="btn-group btn-group-justified"><a class="btn btn-success" ng-click="func.edit_customer()">编辑</a> <a class="btn btn-warning" ng-click="func.reset_password()">重置密码</a> <a ng-show="role_id && baseinfo.is_new" class="btn btn-info" ng-click="func.new_register_change_shared()">置入公海</a></div></accordion-group></accordion></div>'),e.put("app/modules/cdetail/cdetailnav.html",'<div class="warp-page"><div class="head-bottom"><div class="flex-nav"><ul class="flex-center-50"><li ng-class="{active : showType == tab.status}" ng-repeat="tab in tabs"><a ng-click="setStatus({{tab.status}});" ui-sref="{{tab.href}}">{{tab.name}}</a></li></ul></div></div><div ui-view=""></div></div>'),e.put("app/modules/cdetail/history.html",'<div ng-show="isLoading === false" class="cdetail_wp"><dl class="block cdedl"><dt><span class="pull-right">所属销售</span> <span>时间</span></dt><dd ng-repeat="m in historylist.list"><span class="pull-right">{{m.name}}({{m.role}})</span> {{m.time | date :\'yyyy/MM/dd\'}}</dd><a ng-click="func.goback()" class="btn btn-block btn-success">返回</a></dl></div><div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div>'),e.put("app/modules/cdetail/orderdetail.html",'<div ng-show="isLoading === false" class="cdetail_wp clearfix orderinfo_wp"><dl class="orderinfo_dl"><dt>所属销售</dt><dd>{{customerlist.sale_name}}</dd></dl><dl class="orderinfo_dl"><dt>订单编号</dt><dd>{{customerlist.number}}</dd></dl><dl class="orderinfo_dl"><dt>订单状态</dt><dd class="label" ng-if="customerlist.status === \'已出库\'" ng-class="{out: customerlist.status === \'已出库\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'已完成\'" ng-class="{done: customerlist.status === \'已完成\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'已关闭\'" ng-class="{closed: customerlist.status === \'已关闭\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'已退货\'" ng-class="{back: customerlist.status === \'已退货\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'待审核\'" ng-class="{examine: customerlist.status === \'待审核\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'待生产\'" ng-class="{production: customerlist.status === \'待生产\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'波次中\'" ng-class="{boci: customerlist.status === \'波次中\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'待分拣\'" ng-class="{sort: customerlist.status === \'待分拣\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'已复核\'" ng-class="{review: customerlist.status === \'已复核\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'已分拨\'" ng-class="{allot: customerlist.status === \'已分拨\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'已签收\'" ng-class="{sign: customerlist.status === \'已签收\'}">{{customerlist.status}}</dd><dd class="label" ng-if="customerlist.status === \'待收货\'" ng-class="{willreceived: customerlist.status === \'待收货\'}">{{customerlist.status}}</dd></dl><dl class="orderinfo_dl"><dt>实收金额</dt><dd>{{customerlist.reallymoney | currency : \'&yen;\' : 2}}</dd></dl><dl class="orderinfo_dl"><dt>订单金额</dt><dd>{{customerlist.money | currency : \'&yen;\' : 2}}</dd></dl><dl class="orderinfo_dl"><dt>下单时间</dt><dd>{{customerlist.time | date: \'yyyy-MM-dd HH:mm:ss\'}}</dd></dl><dl class="orderinfo_dl"><dt>送货时间</dt><dd>{{customerlist.deliver_time | date: \'yyyy/MM/dd\'}}</dd></dl><dl class="orderinfo_dl orderconf"><dt>订单内容</dt><dd ng-repeat="m in customerlist.content"><div><div>{{m.name}}*{{m.quantity}} = {{m.sum_price | currency : \'&yen;\' : 2}}</div><div ng-repeat="v in m.spec">{{v.name}}:{{v.val}}</div></div></dd></dl><a ng-click="func.userback()" class="btn mb-10 btn-block btn-success">返回</a></div><div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div>'),e.put("app/modules/cdetail/seainfo.html",'<div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="warp-page cdetail_wp" ng-if="isLoading === false"><accordion close-others="one"><accordion-group is-open="historymsg"><accordion-heading>{{userinfo.history}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : historymsg, \'glyphicon-chevron-right\' : !historymsg}"></i></accordion-heading><div class="cdelist"><ul class="list-group"><li>历史订单数<span class="pull-right">{{history.order_num}}</span></li><li>历史流水金额<span class="c_fs14 pull-right">{{history.amount/100 | currency : \'￥\' : 2}}</span></li><li>历史移交记录<span class="pull-right">{{history.history_belong}}&nbsp;&nbsp;<span class="glyphicon glyphicon-chevron-right" ng-click="func.history_detail()"></span></span></li></ul></div></accordion-group><accordion-group is-open="basemsg"><accordion-heading>{{userinfo.baseinfo}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : basemsg, \'glyphicon-chevron-right\' : !basemsg}"></i></accordion-heading><div class="cdelist"><ul class="list-group"><li>注册时间<span class="pull-right">{{baseinfo.created_time*1000 | date:\'yyyy-MM-dd\'}}</span></li><li>店铺名称<span class="pull-right">{{baseinfo.shop_name}}</span></li><li>客户姓名<span class="pull-right">{{baseinfo.name}}</span></li><li>餐饮类别<span class="pull-right">{{baseinfo.shop_type}}</span></li><li>店铺规模<span class="pull-right">{{baseinfo.dimensions}}</span></li><li>所属系统<span class="pull-right">{{baseinfo.site}}</span></li><li class="address">详细地址<span class="pull-right"><a ng-click="func.view_map()"><span class="glyphicon glyphicon-map-marker ml-10"></span></a></span><span class="pull-right adress_text">{{baseinfo.address}}</span></li><li>配送线路<span class="pull-right">{{baseinfo.line}}</span></li><li>备注<span class="pull-right">{{baseinfo.remark}}</span></li></ul></div><div class="img_b mb-10 clearfix" ng-if="imgurl.length > 0"><div class="img_block" ng-repeat="m in imgurl"><a ng-click="openmodal($index)"><img width="100%" ng-src="{{m.url}}"></a></div></div><div class="btn-group btn-group-justified"><a ng-show="role_id && baseinfo.is_new" class="btn btn-primary" ng-click="func.new_register_change_private()">加入私海</a></div></accordion-group></accordion></div>'),e.put("app/modules/cdetail/trends.html",'<div class="cdetail_wp" ng-show="isloading === false"><div class="row user_state"><div><div class="mt10"><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="起始时间" current-text="今天" clear-text="清除" close-text="关闭"></div><div class="mt-10"><input type="text" is-open="endOpened" datepicker-popup="yyyy-MM-dd" ng-click="endOpen($event)" datepicker-options="endDateOptions" class="form-control" ng-model="endTime" id="endTime" placeholder="结束时间" current-text="今天" clear-text="清除" close-text="关闭"></div><div class="btn-group mt-10 btn-group-justified"><a class="btn btn-success" ng-click="func.sift()">查询</a> <a class="btn btn-info" ng-click="func.clear()">重置</a></div></div></div><div class="row user_state userstate_title"><div class="col-xs-3" style="padding:0 5px;">下单时间</div><div class="col-xs-6">订单编号</div><div class="col-xs-3">状态</div></div><div class="row user_state" ng-repeat="m in orderlist"><a class="orderinfo" ng-click="func.orderinfo(m)"><div class="col-xs-3">{{m.created_time | date:\'yyyy/MM/dd\'}}</div><div class="col-xs-6">{{m.order_number}}</div><div class="col-xs-3" ng-if="m.status === \'已出库\'" ng-class="{out: m.status === \'已出库\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'已完成\'" ng-class="{done: m.status === \'已完成\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'已关闭\'" ng-class="{closed: m.status === \'已关闭\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'已退货\'" ng-class="{back: m.status === \'已退货\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'待审核\'" ng-class="{examine: m.status === \'待审核\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'待生产\'" ng-class="{production: m.status === \'待生产\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'波次中\'" ng-class="{boci: m.status === \'波次中\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'待分拣\'" ng-class="{sort: m.status === \'待分拣\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'已复核\'" ng-class="{review: m.status === \'已复核\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'已分拨\'" ng-class="{allot: m.status === \'已分拨\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'已签收\'" ng-class="{sign: m.status === \'已签收\'}"><span>{{m.status}}</span></div><div class="col-xs-3" ng-if="m.status === \'待收货\'" ng-class="{willreceived: m.status === \'待收货\'}"><span>{{m.status}}</span></div></a></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-show="!pagination.isDone"><h4 class="text-center" ng-click="pagination.nextPage()">点击加载更多...</h4></div><div class="row block pt-10 pb-10" ng-show="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div>'),e.put("app/modules/custorm/create.html",'<script type="text/ng-template" id="suborderInfo.html"><div class="modal-body"> <div class="modal-dialog"> <h4>什么是子母账号？</h4> <ul> <li> 母账号： <ul> <li>非连锁店，自主下单，自主结账</li> <li>连锁店总店，分店及总店均由此账号结账</li> </ul> </li> <li> 子账号： <ul> <li>连锁店分店，自主下单，但由总店的母账号统一结账</li> </ul> </li> </ul> </div> </div></script><div class="container-fluid block block-col pb-nav pt-nav"><div class="mt-10"><h5>请录入客户信息</h5></div><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="create()" novalidate=""><div class="form-group"><label class="col-sm-2 control-label">客户类型：</label><div class="col-sm-10"><select class="form-control" name="customerType" ng-model="customerType" ng-options="m.name for m in types" required=""><option value="">请选择客户类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">子母账号类型：<span class="glyphicon glyphicon-question-sign" ng-click="suborderInfo()"></span></label><div class="col-sm-10"><select class="form-control" name="accountType" ng-model="account_type" ng-options="m.name for m in account_types" ng-change="show_more_account_option()" required=""><option value="">请选择子母账号类型</option></select></div></div><div ng-show="show_account_son == true"><div class="form-group"><label class="col-sm-2 control-label">关联母账号：</label><div class="col-sm-10"><input class="form-control" type="text" name="parentmobile" ng-model="parent_mobile" placeholder="请输入关联母账号手机号"></div></div></div><div class="form-group"><label class="control-label col-sm-2">上传客户门店照片：<a class="btn btn-warning btn-sm" ng-click="upload()">上传照片</a><span ng-if="urls">（已上传）</span></label></div><div class="form-group"><label class="col-sm-2 control-label">餐饮类别：</label><div class="col-sm-10"><select name="shop" ng-model="shop" class="form-control" ng-options="m.name for m in shopTypes" required=""><option value="">请选择餐饮类别</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺规模：</label><div class="col-sm-10"><select class="form-control" name="dimensions" ng-model="info.dimensions" ng-options="m.name for m in oDimensions" required=""><option value="">请选择店铺规模</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（果蔬/肉）：</label><div class="col-sm-10"><select class="form-control" name="estimateVegetable" ng-model="info.estimateVegetable" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（果蔬/肉）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（米面粮油）：</label><div class="col-sm-10"><select class="form-control" name="estimateRice" ng-model="info.estimateRice" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（米面粮油）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input name="mobile" type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码" ng-pattern="/^1\\d{10}$/" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input name="username" type="text" ng-model="info.name" class="form-control" placeholder="请输入客户姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select name="province" ng-model="addr.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required="" ng-disabled="true"><option value="">请选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">配送线路：</label><div class="col-sm-10"><select name="line" ng-model="addr.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">请选择配送线路</option></select></div></div><div class="container form-group"><label class="clearfix control-label">详细地址：<a class="btn btn-warning btn-sm" ng-click="choosePlace()">定位用户地址</a></label></div><div class="input-group w-100"><input name="address" type="text" ng-model="userGeo.addr" class="form-control" placeholder="请填写详细地址" required=""> <span class="input-group-btn address-fw"><select class="form-control" name="direction" ng-model="direction" ng-options="opt as opt.label for opt in dOptions" required=""><option value="">方位</option></select></span></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input name="shop_name" type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：<span class="color-red">选填</span></label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit" ng-show="!isRequesting">提交</button><div ng-show="isRequesting"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div></div></form></div></div>'),e.put("app/modules/custorm/editcustomer.html",'<div class="container-fluid block block-col pb-nav pt-nav"><h4 class="pt-10">编辑客户信息</h4><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="func.create()" novalidate=""><div class="form-group"><label class="control-label col-sm-2">上传客户门店照片：<a class="btn btn-warning btn-sm" ng-click="func.upload()">上传照片</a><span ng-if="is_uploaded>0">(已上传)</span></label></div><div class="form-group"><label class="col-sm-2 control-label">客户类型：<span class="color-red">必填</span></label><div class="col-sm-10"><select class="form-control" name="customerType" ng-model="customerType" ng-options="m.name for m in types" required=""><option value="">请选择客户类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺规模：</label><div class="col-sm-10"><select class="form-control" name="dimensions" ng-model="dimensions" ng-options="m.name for m in oDimensions"><option value="">请选择店铺规模</option></select></div></div><div class="container form-group"><label class="clearfix control-label">详细地址：<a class="btn btn-warning btn-sm" ng-click="func.choosePlace()">定位用户地址</a></label></div><div class="input-group w-100"><input name="address" type="text" ng-model="address" class="form-control" placeholder="请填写详细地址"> <span class="input-group-btn address-fw"><select class="form-control" name="direction" ng-model="direction" ng-options="opt as opt.label for opt in dOptions"><option value="">方位</option></select></span></div><div class="form-group"><label class="col-sm-2 control-label">备注：</label><div class="col-sm-10"><input type="text" name="remark" ng-model="remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group" ng-show="isRequesting===false"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit">确认修改</button></div></div><div ng-show="isRequesting"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></form></div></div>'),e.put("app/modules/custorm/editpot.html",'<script type="text/ng-template" id="suborderInfo.html"><div class="modal-body"> <div class="modal-dialog"> <h4>什么是子母账号？</h4> <ul> <li> 母账号： <ul> <li>非连锁店，自主下单，自主结账</li> <li>连锁店总店，分店及总店均由此账号结账</li> </ul> </li> <li> 子账号： <ul> <li>连锁店分店，自主下单，但由总店的母账号统一结账</li> </ul> </li> </ul> </div> </div></script><div class="container-fluid block block-col pb-nav pt-nav"><h4 class="pt-10">编辑潜在客户信息</h4><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="create()" novalidate=""><div class="form-group"><label class="col-sm-2 control-label">客户类型：</label><div class="col-sm-10"><select class="form-control" name="customerType" ng-model="customerType" ng-options="m.name for m in types" ng-change="show_ka()" required=""><option value="">请选择客户类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">子母账号类型：<span class="glyphicon glyphicon-question-sign" ng-click="suborderInfo()"></span></label><div class="col-sm-10"><select class="form-control" name="accountType" ng-model="account_type" ng-options="m.name for m in account_types" required="" ng-change="show_more_account_option()"><option value="">请选择子母账号类型</option></select></div></div><div ng-show="show_account_son == true"><div class="form-group"><label class="col-sm-2 control-label">关联母账号：</label><div class="col-sm-10"><input class="form-control" type="text" name="parentmobile" ng-model="parent_mobile" placeholder="请输入关联母账号手机号"></div></div></div><div class="form-group"><label class="control-label col-sm-2">上传客户门店照片：<a class="btn btn-warning btn-sm" ng-click="upload()">上传照片</a><span ng-if="is_uploaded>0">(已上传{{is_uploaded}}张)</span></label></div><div class="form-group"><label class="col-sm-2 control-label">餐饮类别：</label><div class="col-sm-10"><select name="shop" ng-model="shop" class="form-control" ng-options="m.name for m in shopTypes" ng-change="getShop()" required=""><option value="">请选择餐饮类别</option></select></div><label class="col-sm-2 control-label" ng-if="shopChilds.length"></label><div class="col-sm-10" ng-if="shopChilds.length"><select ng-model="shopChild" class="form-control" ng-options="m.name for m in shopChilds"><option value="">请选择连锁类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺规模：</label><div class="col-sm-10"><select class="form-control" name="dimensions" ng-model="info.dimensions" ng-options="m.name for m in oDimensions" required=""><option value="">请选择店铺规模</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（果蔬/肉）：</label><div class="col-sm-10"><select class="form-control" name="estimateVegetable" ng-model="info.estimateVegetable" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（果蔬/肉）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（米面粮油）：</label><div class="col-sm-10"><select class="form-control" name="estimateRice" ng-model="info.estimateRice" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（米面粮油）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input name="mobile" type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码" ng-pattern="/^1\\d{10}$/" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input type="text" ng-model="info.name" class="form-control" placeholder="请输入客户姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select name="province" ng-model="info.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required="" ng-disabled="true"><option value="">请选择省份</option></select></div><label class="col-sm-2 control-label">配送线路：</label><div class="col-sm-10"><select name="line" ng-model="info.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">请选择配送线路</option></select></div></div><div class="container form-group"><label class="clearfix control-label">详细地址：<a class="btn btn-warning btn-sm" ng-click="choosePlace()">定位用户地址</a></label></div><div class="input-group w-100"><input name="address" type="text" ng-model="info.address" class="form-control" placeholder="请填写详细地址" required=""> <span class="input-group-btn address-fw"><select class="form-control" name="direction" ng-model="info.direction" ng-options="opt as opt.label for opt in dOptions" required=""><option value="">方位</option></select></span></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input name="shop_name" type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：<span class="color-red">选填</span></label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit" ng-show="!isRequesting">确认修改</button><div ng-show="isRequesting"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div></div></form></div></div>'),e.put("app/modules/custorm/filter.html",'<div class=""><div class="modal-header"><h4 class="modal-title">筛选客户</h4></div><div class="modal-body" style="overflow:hidden;"><form class="form"><div class="form-group row"><label class="control-label col-xs-4">所属地区</label><div class="col-xs-8"><select class="form-control input-sm" ng-options="item.name for item in property.provinces" ng-model="sift.province" ng-change="func.getLines()" ng-disabled="true"></select></div></div><div class="form-group row"><label class="control-label col-xs-4">配送线路</label><div class="col-xs-8"><select class="form-control input-sm" ng-disabled="!sift.province" ng-options="item.name for item in property.lines" ng-model="sift.line"><option value="">全部</option></select></div></div><div class="form-group row"><label class="control-label col-xs-4">客户规模</label><div class="col-xs-8"><select class="form-control input-sm" ng-options="item.name for item in property.dimensions" ng-model="sift.dimensions"><option value="">全部</option></select></div></div><div class="form-group row"><label class="control-label col-xs-4">餐饮类别</label><div class="col-xs-8"><select class="form-control input-sm" ng-options="item.name for item in property.shop_types" ng-model="sift.shop_type"><option value="">全部</option></select></div></div><button class="btn btn-block btn-success" ng-click="func.reset()">重置</button></form></div><div class="modal-footer"><button class="btn btn-primary" type="button" ng-click="func.ensure()" ng-disabled="isloading">确定</button> <button class="btn btn-warning" type="button" ng-click="func.cancel()">取消</button></div></div>'),e.put("app/modules/custorm/list.html",'<div class="warp-page container-fluid"><div class="head-bottom" ng-if="showTabs"><div class="flex-nav"><ul class="sea-flex"><li><select class="form-control input-sm" name="seas" ng-change="seachange(defaultsea)" ng-model="defaultsea" ng-options="m.name for m in oSea" required=""></select></li><li><select class="form-control input-sm" name="seas"><option>按添加时间排序</option></select></li><li class="chose_btn"><a ng-click="filterfunc()">筛选<span class="glyphicon glyphicon-filter"></span></a></li></ul></div></div><div ng-class="{\'mt-nav\': showTabs}" class="row search_block"><div ng-class="{\'col-xs-12\': !role_id && !role_id13,\'col-xs-9\' : role_id&& !role_id13}" style="padding:10px;"><form class="text-left"><div class="input-group"><input type="text" class="form-control" ng-model="key" placeholder="店铺名称/手机号码"> <a class="input-group-addon" ng-click="search()">搜索</a></div></form></div><div ng-show="role_id && !role_id13" class="col-xs-3" style="padding:18px 0 0 0"><a style="font-size:16px; color:#333;" ng-click="filterfunc()">筛选<span class="glyphicon glyphicon-filter"></span></a></div><p style="text-align : center; background-color : rgba(234, 232, 215, 0.90)">筛选结果：{{siftNumber}} / {{totalNumber}}</p></div><div ng-if="showType != 0 && showType !=4 && showType != 5" infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block new_user_block" ng-repeat="item in list"><div class="col-xs-12 block-col"><div><span class="pull-right glyphicon glyphicon-chevron-right shopinfo_icon" ng-click="func.shopInfo(item)"></span> <span class="label label-success pull-right ml-10" ng-if="item.customer_type != 1">KA客户</span> <span class="label label-danger pull-right" ng-if="item.ka_status">{{item.ka_status}}</span> 店铺名称：{{item.shop_name}}</div></div><div class="col-xs-12 block-col"><p>姓名：{{item.name}}</p></div><div class="col-xs-12 block-col"><p>配送线路：{{item.line_name}}</p></div><div class="col-xs-12 block-col"><div class="row"><div class="col-xs-9 dress_indent">地址：{{item.address}}</div><div class="col-xs-3 icon-button"><a ng-click="viewMap(item)" class="color-red"><span class="glyphicon glyphicon-map-marker"></span>路线</a></div></div></div><div class="col-xs-12 block-col"><div class="row"><div class="col-xs-9">电话：{{item.mobile}}</div><div class="col-xs-3 icon-button"><a href="tel:{{item.mobile}}" class="color-green"><span class="glyphicon glyphicon-earphone"></span>电话</a></div></div></div><div class="col-xs-12 block-col" ng-if="item.lack && item.lack!=\'\'"><h5 class="color-red">*系统提示：请编辑补全客户信息</h5></div><div class="col-xs-12 block-col hidden"><a class="btn btn-info btn-sm" ng-diasbled="resetClk" ng-click="resetPass({{item.id}})">重置密码</a> <a class="btn btn-success btn-sm" ng-click="editCustomer(item.id)" ng-disabled="loadingGeo">编辑</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div><div ng-if="showType==4" infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block new_user_block" ng-repeat="item in list"><div class="col-xs-12 block-col"><span class="label label-success pull-right" ng-if="item.customer_type != 1 &&item.customer">KA客户</span> <span class="label label-danger pull-right" ng-if="item.ka_status">{{item.ka_status}}</span> 店铺名称：{{item.shop_name}}</div><div class="col-xs-12 block-col"><p>配送线路：{{item.line_name}}</p></div><div class="col-xs-12 block-col dress_indent"><p><span>地址：</span>{{item.address}}</p></div><div class="col-xs-12 block-col"><a ng-show="!role_id" class="btn btn-primary pull-right btn-sm" ng-click="func.potential_change_private(item)" ng-disabled="change_button">加入私海</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div><div ng-if="showType==0" infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block new_user_block" ng-repeat="item in list"><div class="col-xs-12 block-col"><span class="label label-danger pull-right" ng-if="item.ka_status">{{item.ka_status}}</span> <span class="label label-success pull-right" ng-if="item.customer_type != 1">KA客户</span> 店铺名称：{{item.shop_name}}</div><div class="col-xs-12 block-col"><p>配送线路：{{item.line_name}}</p></div><div class="col-xs-12 block-col dress_indent"><p>地址：{{item.address}}</p></div><div class="col-xs-12 block-col"><a ng-show="!role_id" class="btn btn-info btn-sm" ng-click="openUser({{item.id}})">开通</a> <a class="btn btn-success btn-sm" ng-click="editUser({{item.id}})">编辑</a> <a ng-show="!role_id" class="btn btn-danger btn-sm" ng-click="deleteUser({{item.id}})">删除</a> <a ng-show="!role_id" class="btn btn-primary pull-right btn-sm" ng-click="func.potential_change_shared(item)" ng-disabled="change_button">置入公海</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div><div ng-if="showType==5" infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block new_user_block" ng-repeat="item in list"><div class="col-xs-12 block-col"><span class="pull-right glyphicon glyphicon-chevron-right shopinfo_icon" ng-click="func.shopInfosea(item)"></span> <span class="label label-danger pull-right" ng-if="item.ka_status">{{item.ka_status}}</span> <span class="label label-success pull-right" ng-if="item.customer_type != 1 && item.customer">KA客户</span> 店铺名称：{{item.shop_name}}</div><div class="col-xs-12 block-col"><p>配送线路：{{item.line_name}}</p></div><div class="col-xs-12 block-col dress_indent"><p>地址：{{item.address}}</p></div><div class="col-xs-12 block-col"><a ng-show="!role_id" class="btn btn-primary pull-right btn-sm" ng-click="func.new_register_change_private(item)" ng-disabled="change_button">加入私海</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div></div>'),e.put("app/modules/custorm/manage.html",'<div class="mt-nav warp-page"><div class="list-group"><a class="list-group-item" ng-if="my" ng-click="viewCustom({{my.uid}})"><span class="badge" ng-if="false">{{my.count}}</span><h5>{{my.name}}的客户</h5></a> <a class="list-group-item" ng-repeat="people in mygroup" ng-click="viewCustom({{people.uid}})"><span class="badge" ng-if="false">{{people.count}}</span><h5>{{people.name}}</h5></a></div><div ng-show="isLoading"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div>'),e.put("app/modules/custorm/mycustomer.html",'<div class="mt-nav warp-page"><div class="head-bottom"><div class="flex-nav"><ul class="flex-center-50"><li ng-class="{active : showType == tab.status}" ng-repeat="tab in tabs"><a ng-click="setStatus({{tab.status}});" ui-sref="{{tab.href}}">{{tab.name}}</a></li></ul></div></div><div ui-view=""></div></div>'),e.put("app/modules/custorm/openpot.html",'<script type="text/ng-template" id="suborderInfo.html"><div class="modal-body"> <div class="modal-dialog"> <h4>什么是子母账号？</h4> <ul> <li> 母账号： <ul> <li>非连锁店，自主下单，自主结账</li> <li>连锁店总店，分店及总店均由此账号结账</li> </ul> </li> <li> 子账号： <ul> <li>连锁店分店，自主下单，但由总店的母账号统一结账</li> </ul> </li> </ul> </div> </div></script><div class="container-fluid block block-col pb-nav pt-nav"><h4 class="pt-10">补全潜在客户信息并开通</h4><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="create()" novalidate=""><div class="form-group"><label class="col-sm-2 control-label">客户类型：</label><div class="col-sm-10"><select class="form-control" name="customerType" ng-model="customerType" ng-options="m.name for m in types" required=""><option value="">请选择客户类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">子母账号类型：<span class="glyphicon glyphicon-question-sign" ng-click="suborderInfo()"></span></label><div class="col-sm-10"><select class="form-control" name="accountType" ng-model="account_type" ng-options="m.name for m in account_types" ng-change="show_more_account_option()" required=""><option value="">请选择子母账号账号类型</option></select></div></div><div ng-show="show_account_son == true"><div class="form-group"><label class="col-sm-2 control-label">关联母账号：</label><div class="col-sm-10"><input class="form-control" type="text" name="parentmobile" ng-model="parent_mobile" placeholder="请输入关联母账号手机号"></div></div></div><div class="form-group"><label class="control-label col-sm-2">上传客户门店照片：<a class="btn btn-warning btn-sm" ng-click="upload()">上传照片</a><span ng-if="is_uploaded>0">(已上传{{is_uploaded}}张)</span></label></div><div class="form-group"><label class="col-sm-2 control-label">餐饮类别：</label><div class="col-sm-10"><select name="shop" ng-model="shop" class="form-control" ng-options="m.name for m in shopTypes" required=""><option value="">请选择餐饮类别</option></select></div><label class="col-sm-2 control-label" ng-if="shopChilds.length"></label><div class="col-sm-10" ng-if="shopChilds.length"><select ng-model="shopChild" class="form-control" ng-options="m.name for m in shopChilds"><option value="">请选择连锁类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺规模：</label><div class="col-sm-10"><select class="form-control" name="dimensions" ng-model="info.dimensions" ng-options="m.name for m in oDimensions" required=""><option value="">请选择店铺规模</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（果蔬/肉）：</label><div class="col-sm-10"><select class="form-control" name="estimateVegetable" ng-model="info.estimateVegetable" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（果蔬/肉）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（米面粮油）：</label><div class="col-sm-10"><select class="form-control" name="estimateRice" ng-model="info.estimateRice" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（米面粮油）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input name="mobile" type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码" ng-pattern="/^1\\d{10}$/" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input type="text" name="username" ng-model="info.name" class="form-control" placeholder="请输入客户姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select name="province" ng-model="info.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required="" ng-disabled="true"><option value="">请选择省份</option></select></div><label class="col-sm-2 control-label">配送线路：</label><div class="col-sm-10"><select name="line" ng-model="info.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">请选择配送线路</option></select></div></div><div class="container form-group"><label class="clearfix control-label">详细地址：<a class="btn btn-warning btn-sm" ng-click="choosePlace()">定位用户地址</a></label></div><div class="input-group w-100"><input name="address" type="text" ng-model="info.address" class="form-control" placeholder="请填写详细地址" required=""> <span class="input-group-btn address-fw"><select class="form-control" name="direction" ng-model="info.direction" ng-options="opt as opt.label for opt in dOptions" required=""><option value="">方位</option></select></span></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input name="shop_name" type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：<span class="color-red">选填</span></label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit" ng-show="!isRequesting">确认开通</button><div ng-show="isRequesting"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div></div></form></div></div>'),e.put("app/modules/custorm/potential.html",'<div class="container-fluid block block-col pb-nav pt-nav"><h4 class="pt-10">在这里记录潜在客户信息</h4><h4>还没有获得的信息可以不填</h4><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="create()" novalidate=""><div class="form-group"><label class="col-sm-2 control-label">所属系统：</label><div class="col-sm-10"><select ng-model="site" class="form-control" ng-options="m.name for m in sites" ng-change="getSite()"><option value="">选择所属系统</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">餐饮类别：</label><div class="col-sm-10"><select ng-model="shop" class="form-control" ng-options="m.name for m in tops" ng-change="getShop()"><option value="">选择商家类别</option></select></div><label class="col-sm-2 control-label" ng-if="shopChilds.length"></label><div class="col-sm-10" ng-if="shopChilds.length"><select ng-model="shopChild" class="form-control" ng-options="m.name for m in shopChilds"><option value="">选择连锁类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码"></div></div><div class="form-group"><label class="col-sm-2 control-label">用户名：</label><div class="col-sm-10"><input type="text" ng-model="info.name" class="form-control" placeholder="请输入用户名"></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：<span class="text-red">必填</span></label><div class="col-sm-10"><select name="province" ng-model="info.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required=""><option value="">选择省份</option></select></div><label class="col-sm-2 control-label"></label><div class="col-sm-10"><select name="line" ng-model="info.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">选择配送线路</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">详细地址：<span class="text-red">必填</span></label><div class="col-sm-10"><input name="address" type="text" ng-model="info.address" class="form-control" placeholder="请填写具体方位，路号，大厦，楼号等信息" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：<span class="text-red">必填</span></label><div class="col-sm-10"><input name="shop_name" type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：</label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit">记录</button></div></div></form></div></div>'),e.put("app/modules/custorm/potlist.html",'<div class="warp-page container-fluid"><div class="row block text-center pt-10 pb-10"><h4>总计： {{totalItems}} 家客户</h4></div><div infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block" ng-repeat="item in list"><div class="col-xs-12 block-col"><h5>店铺名称：{{item.shop_name}}</h5></div><div class="col-xs-12 block-col"><h5>地址：{{item.address}}</h5></div><div class="col-xs-12 block-col"><h5>备注：{{item.remark}}</h5></div><div class="col-xs-12 block-col" ng-if="item.mobile"><a href="tel:{{item.mobile}}" class="btn btn-warning">拨打电话:{{item.mobile}}</a></div><div class="col-xs-12 block-col"><a class="btn btn-info btn-sm" ng-click="openUser({{item.id}})">开通</a> <a class="btn btn-success btn-sm" ng-click="editUser({{item.id}})">编辑</a> <a class="btn btn-danger btn-sm" ng-click="deleteUser({{item.id}})">删除</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div></div>'),e.put("app/modules/home/dblist.html",'<div class="mt-nav warp-page"><div class="head-bottom"><div class="flex-nav"><ul class="flex-center-50"><li ng-class="{active : showType == tab.status}" ng-repeat="tab in tabs"><a ng-click="setStatus(\'{{tab.status}}\');">{{tab.name}}</a></li></ul></div></div><div class="list-group mt-nav" ng-show="showLists"><a class="list-group-item" ng-repeat="people in mygroup" ng-click="viewStatistics({{people.uid}})"><h5>{{people.name}}</h5></a></div><div class="" ng-show="showType == 0 && isLoading ==false"><accordion close-others="false"><accordion-group ng-repeat="table in statistics" is-open="openstatus.list[$index]"><accordion-heading>{{table.heading}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': openstatus.list[$index],\'glyphicon-chevron-right\': !openstatus.list[$index]}"></i></accordion-heading><table class="table my-table"><tr ng-repeat="item in table.data"><td>{{item.key}}</td><td>{{item.val}}</td></tr></table></accordion-group></accordion></div><div class="mt-nav" ng-show="showTotal"><table class="table table-white table-striped" ng-show="false"><tr><th>统计项</th><th class="text-right">实时数据</th></tr><tr ng-repeat="item in today"><td>{{item.name}}</td><td class="text-right">{{item.data}}</td></tr><tr ng-repeat="item in all"><td class="">{{item.name}}</td><td class="text-right">{{item.data}}</td></tr></table></div><div ng-show="isLoading" class="mt-10"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div>'),e.put("app/modules/home/home.html",'<div class="warp-page"><div class="mt-nav" ng-if="isloading"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div ng-if="showType===0 && isloading===false"><accordion close-others="false"><accordion-group ng-repeat="table in statistics" is-open="openstatus.list[$index]"><accordion-heading>{{table.heading}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': openstatus.list[$index],\'glyphicon-chevron-right\': !openstatus.list[$index]}"></i></accordion-heading><table class="table my-table"><tr ng-repeat="item in table.data"><td>{{item.key}}</td><td>{{item.val}}</td></tr></table></accordion-group><accordion-group is-open="openstatus.query"><accordion-heading>自选时间段<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': openstatus.query,\'glyphicon-chevron-right\': !openstatus.query}"></i></accordion-heading><form class="form" novalidate="" name="query_form" ng-submit="func.query()"><div class="form-group"><label class="control-label">起始时间</label> <input name="btime" class="form-control" type="text" datepicker-popup="{{date_format}}" ng-model="date.begin_time" is-open="dpicker.begin.status" min-date="{{format.min}}" max-date="{{format.max}}" current-text="今日" clear-text="清除" close-text="关闭" ng-click="func.openDatepicker($event,1)" placeholder="点击选择日期" required=""></div><div class="form-group"><label class="control-label">结束时间</label> <input name="etime" class="form-control" type="text" datepicker-popup="{{date_format}}" ng-model="date.end_time" is-open="dpicker.end.status" min-date="{{format.min}}" max-date="{{format.max}}" current-text="今日" clear-text="清除" close-text="确定" ng-click="func.openDatepicker($event,2)" placeholder="点击选择日期" required=""></div><div class="form-group" ng-if="isquering===false"><button class="btn btn-primary btn-block" type="submit">查询</button></div><div ng-if="isquering===true"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></form><table class="table my-table" ng-show="show_metabolic"><tr ng-repeat="item in metabolic"><td>{{item.key}}</td><td>{{item.val}}</td></tr></table></accordion-group><accordion-group ng-repeat="table in capacity" is-open="capacity_openstatus.list[$index]"><accordion-heading>{{table.heading}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': capacity_openstatus.list[$index],\'glyphicon-chevron-right\': !capacity_openstatus.list[$index]}"></i></accordion-heading><table class="table my-table"><thead><tr><th>项目</th><th>当前</th><th>上限</th></tr></thead><tbody><tr ng-repeat="item in table.data"><td>{{item.key}}</td><td>{{item.val.current}}</td><td>{{item.val.upper}}</td></tr></tbody><tr></tr></table></accordion-group></accordion></div><div class="mt-nav" ng-if="showType!==0"><div class="alert alert-warning" role="alert">正在开发中……</div></div></div>'),e.put("app/modules/more/more.html",'<div class="mt-nav more-body"><div class="list-group"><a class="list-group-item" ui-sref="page.userCenter">个人中心<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a> <a class="list-group-item" ng-click="func.manual()">用户手册<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a> <a class="list-group-item" ng-click="func.map()">离线地图<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a> <a class="list-group-item" ng-click="func.clearCache()">清除缓存<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a></div></div>'),e.put("app/modules/user/center.html",'<div class="warp-page container-fluid"><div class="row block"><div class="col-xs-12"><h4>账户信息</h4></div><div class="col-xs-12 block-col"><a ng-href="/user/password" class="text-primary"><h5>修改密码</h5></a></div><div class="col-xs-12 block-col"><h5>姓名：{{uinfo.name}}</h5></div><div class="col-xs-12 block-col"><h5>地址：{{uinfo.address}}</h5></div><div class="col-xs-12 block-col"><h5>电话：{{uinfo.mobile}}</h5></div></div><div class="row block-btn pb-10"><div class="col-xs-12"><a ng-click="logout()" class="btn btn-danger btn-lg btn-block">退出登录</a></div></div></div>'),e.put("app/modules/user/edit.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid"><form class="row block block-col form-horizontal" role="form" ng-submit="save()" ng-controller="UserEditCtrl"><div class="form-group col-xs-12"><label for="name" class="col-sm-2 control-label"><h5><b>姓名</b></h5></label><div class="col-sm-10"><input type="text" required="" class="input-lg form-control" ng-model="reg.name" name="mobile" id="name" placeholder="请输入您的姓名"></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="address" class="col-sm-2 control-label"><h5><b>地理位置</b></h5></label><div class="col-sm-10"><select ng-model="addr.province" class="input-lg form-control" ng-options="m.name for m in provinces" ng-change="get_child(\'citys\', \'province\');get_market(\'province\')" required=""><option value="">选择省份</option></select><select ng-model="addr.city" ng-options="c.name for c in citys" ng-change="get_child(\'countys\', \'city\');get_market(\'city\')" class="block-space input-lg form-control" required=""><option value="">--选择城市--</option></select><select ng-model="addr.county" ng-options="x.name for x in countys" class="block-space input-lg form-control"><option value="">--选择县--</option></select></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="market" class="col-sm-2 control-label"><h5><b>市场位置</b></h5></label><div class="col-sm-10"><select required="" ng-model="addr.market" class="form-control input-lg" ng-options="m.name for m in markets"><option value="">选择市场信息</option></select></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="detail_address" class="col-sm-2 control-label"><h5><b>详细地址(档口,饭馆名)</b></h5></label><div class="col-sm-10"><input required="" type="text" class="input-lg form-control" ng-model="reg.detailAddress" name="detail_address" id="detail_address" placeholder="请输入详细地址"></div></div><div class="form-group col-xs-12"><div class="col-xs-6"><button type="submit" class="btn col-xs-12 btn-success btn-lg">保存</button></div><div class="col-xs-6"><a ng-click="discard()" class="btn btn-danger btn-lg btn-block">取消</a></div></div></form></div>'),e.put("app/modules/user/login.html",'<div class="login_bg container-fluid"><div class="logo"><h3>CRM</h3></div><form class="login-form row block block-col form" name="loginForm" novalidate="" role="form" ng-submit="login()"><div class="form-group col-xs-12"><input type="tel" required="" class="input-md form-control" ng-model="user.mobile" ng-pattern="/^1\\d{10}$/" ng-minlength="11" ng-maxlength="11" name="mobile" id="tel" placeholder="请输入手机号" ng-focus="isL = false"></div><div class="form-group col-xs-12"><input type="password" required="" class="input-md form-control" ng-minlength="6" ng-model="user.password" name="password" id="password" placeholder="请输入密码" ng-focus="isL = false"></div><div class="form-group alert_box pull-left" ng-show="isL && loginForm.$valid && error.message"><div class="col-sm-10"><div class="alert alert-danger min_alert" style="margin-bottom: 0px"><ul><li role="alert">{{error.message}}</li></ul></div></div></div><div class="form-group alert_box mg pull-left" ng-show="loginForm.$invalid && loginForm.$dirty && show_error"><div class="col-sm-10"><div class="alert alert-danger min_alert" style="margin-bottom: 0px"><ul><li ng-show="loginForm.mobile.$error.minlength">请输入正确的手机号</li><li ng-show="!loginForm.mobile.$error.minlength && loginForm.mobile.$error.pattern">手机号格式不正确</li><li ng-show="loginForm.mobile.$error.required">手机号必填</li><li ng-show="loginForm.password.$error.minlength">密码至少6位</li><li ng-show="loginForm.password.$error.required">密码必填</li></ul></div></div></div><div class="form-group col-xs-12"><button type="submit" class="btn btn-success btn-md btn-block">登录</button></div></form></div>'),e.put("app/modules/user/password.html",'<div class="warp-page container-fluid"><div class="row block"><form class="form-horizontal" role="form" ng-submit="changePassword()" name="passwordForm"><div class="form-group col-xs-12 pt-10"><label for="password" class="col-sm-2 control-label"><h5><b>旧密码</b></h5></label><div class="col-sm-10"><input type="password" required="" class="input-lg form-control" ng-model="reg.password" id="password" placeholder="请输入您的旧密码" ng-minlength="6" name="oldpassword"><div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.oldpassword.$invalid"><small ng-show="passwordForm.oldpassword.$error.minlength">旧密码至少6位</small> <small ng-show="passwordForm.oldpassword.$error.required">旧密码必填</small></div></div></div><div class="form-group col-xs-12"><label for="newpassword" class="col-sm-2 control-label"><h5><b>新密码</b></h5></label><div class="col-sm-10"><input type="password" required="" class="input-lg form-control" ng-model="reg.newPassword" id="newPassword" placeholder="请输入您的新密码" ng-minlength="6" name="password"><div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.password.$invalid"><small ng-show="passwordForm.password.$error.minlength">密码至少6位</small> <small ng-show="passwordForm.password.$error.required">密码必填</small></div></div></div><div class="form-group col-xs-12"><label for="newpassword" class="col-sm-2 control-label"><h5><b>重复输入新密码</b></h5></label><div class="col-sm-10"><input type="password" required="" class="input-lg form-control" ng-model="reg.newRePassword" id="newRePassword" ng-blur="passwordCheck()" ng-minlength="6" placeholder="请再次输入您的新密码" name="repassword"><div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.repassword.$invalid"><small ng-show="passwordForm.repassword.$error.minlength">确认密码至少6位</small> <small ng-show="passwordForm.repassword.$error.required">确认密码必填</small></div></div></div><div class="form-group col-xs-12"><div class="row block-btn col-sm-10"><div class="col-xs-12"><button ng-disabled="checked" type="submit" class="btn btn-block btn-success btn-lg">修改密码</button></div></div></div></form></div></div>'),e.put("app/modules/user/register.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h4>{{items.bodyText}}</h4> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-alert" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid"><form name="regForm" class="row block block-col form-horizontal" role="form" novalidate="" ng-submit="register()" ng-controller="UserRegisterCtrl"><div class="form-group col-xs-12"><label for="market" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 您的身份</b></h6></label><div class="col-sm-10"><select required="" ng-model="addr.userType" name="userType" class="form-control input-md" ng-options="m.name for m in types"><option value="">选择身份</option></select><div class="col-xs-12 block-col label label-danger" ng-show="regForm.submitted && regForm.userType.$invalid"><small ng-show="regForm.userType.$error.required">请选择一个注册身份</small></div></div></div><div class="form-group col-xs-12"><label for="tel" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 手机</b></h6></label><div class="col-sm-10"><input type="text" phone-unique="mobile" required="" class="input-md form-control" ng-pattern="/^1[3|5|6|7|8|9]\\d{9}$/" ng-minlength="11" ng-model="reg.mobile" name="mobile" id="tel" placeholder="请输入您的手机号"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.mobile.$dirty) && regForm.mobile.$invalid"><small ng-show="regForm.mobile.$error.minlength">请输入正确的手机号</small> <small ng-show="!regForm.mobile.$error.minlength && regForm.mobile.$error.pattern">您输入的手机号格式不正确</small> <small ng-show="regForm.mobile.$error.required">请输入您的手机号</small> <small ng-if="regForm.mobile.$error.unique">手机号已被注册</small></div></div></div><div class="form-group col-xs-12"><label for="name" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 姓名</b></h6></label><div class="col-sm-10"><input type="text" required="" class="input-md form-control" ng-model="reg.name" name="name" id="name" placeholder="请输入您的真实姓名"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.name.$dirty) && regForm.name.$invalid"><small ng-show="regForm.name.$error.required">请输入您的姓名</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="address" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 您所在的批发市场</b></h6></label><div class="col-sm-10"><select required="" ng-model="addr.city" name="city" ng-options="c.name for c in cities" ng-change="getMarket()" class="block-space form-control input-md"><option value="">选择城市</option></select><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.city.$dirty) && regForm.city.$invalid"><small ng-show="regForm.city.$error.required">请选择您所在的城市</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><div class="col-sm-10 col-sm-offset-2"><select required="" ng-model="addr.market" class="form-control input-md" name="market" ng-options="m.name for m in markets"><option value="">选择批发市场</option></select><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.market.$dirty) && regForm.market.$invalid"><small ng-show="regForm.market.$error.required">请选择您所在的批发市场</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="detail_address" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 档口位置</b></h6></label><div class="col-sm-10"><input required="" type="text" class="input-md form-control" ng-model="reg.detailAddress" name="detail_address" id="detail_address" placeholder="请描述您在市场里的具体位置"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.detail_address.$dirty) && regForm.detail_address.$invalid"><small ng-show="regForm.detail_address.$error.required">请输入您在市场里的具体位置</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="detail_address" class="col-sm-2 control-label"><h6><b>您的招牌(如 XX果业 )(选填)</b></h6></label><div class="col-sm-10"><input type="text" class="input-md form-control" ng-model="reg.brand" name="brand" id="brand" placeholder="填写您的招牌，树立品牌意识"></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 密码</b></h6></label><div class="col-sm-10"><input type="password" required="" class="input-md form-control" ng-model="reg.password" id="password" name="password" placeholder="请输入您的密码"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.password.$dirty) && regForm.password.$invalid"><small ng-show="regForm.password.$error.required">请输入您的密码</small></div></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 确认密码</b></h6></label><div class="col-sm-10"><input type="password" required="" class="input-md form-control" ng-model="reg.checkPassword" id="checkPassword" name="repassword" placeholder="请再次输入你的密码"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.repassword.$dirty) && regForm.repassword.$invalid"><small ng-show="regForm.repassword.$error.required">请再次输入您的密码</small></div><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.repassword.$dirty) && regForm.repassword.$valid && reg.checkPassword != reg.password"><small>两次密码输入不一致</small></div></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b>请输入推荐人的邀请码(选填)</b></h6></label><div class="col-sm-10"><input type="text" class="input-md form-control" ng-model="reg.invite_code" id="checkPassword" name="invite_code" placeholder="请输入大厨网地推人员邀请码"></div></div><div class="form-group col-xs-12"><label for="code" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 验证码</b></h6></label><div class="col-sm-10"><div class="input-group"><input class="input-md form-control" ng-pattern="/^\\d+$/" required="" ng-model="reg.vcode" id="code" type="number" name="code" placeholder="输入短信验证码"><div ng-model="smsinfo" class="input-group-addon btn {{smsdis||smsable}}" ng-disabled="regForm.mobile.$invalid" ng-click="sms()">{{smsinfo || \'获取验证码\'}}</div></div><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.code.$dirty) && regForm.code.$invalid"><small ng-show="regForm.code.$error.required">请输入短信验证码</small></div></div></div><div class="checkbox col-xs-12"><div class="row"><div class="col-xs-12"><label class="control-label" ng-init="agree=true"><h6><input type="checkbox" name="agree" id="agree" ng-model="agree"> <a href="/user/agreement">我已阅读并同意用户协议</a></h6></label></div></div></div><div class="col-xs-12 block-btn"><button type="submit" class="btn btn-block btn-success btn-lg" ng-disabled="!agree">注册</button></div></form></div>')
}]);