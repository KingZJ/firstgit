"use strict";angular.module("hop",["ngAnimate","ngCookies","ngTouch","ngSanitize","ui.router","ui.bootstrap","ui.sortable","dachu.widget","dachu.widget.tab","dachu.widget.blur","dachu.widget.imagebox","angularFileUpload"]),angular.module("hop").controller("WaveCtrl",["$scope","$state","req","dialog",function(t,e,a,s){a.getdata("wave/wave_list_page_options","GET",function(e){t.sites=e.sites,t.cities=e.cities,t.orderTypeList=e.order_type,t.orderType=t.orderTypeList[0],t.deliverDate=e.deliver_date,t.maxDate=t.deliverDate[1].name,t.deliverTime=e.deliver_time,t.waveType=e.wave_type}),t.init={wave:{},searchValue:"",released:!1,release:!1};var l=function(){var e={wave_type:null==t.init.wave?"":t.init.wave.val,wave_id:t.init.searchValue,city_id:t.listCity?t.listCity.id:0,order_type:t.orderType?t.orderType:0,pick_task_created:t.init.released?1:0,currentPage:t.paginationConf.currentPage,itemsPerPage:t.paginationConf.itemsPerPage};a.getdata("wave/wave_list","POST",function(e){t.list=e.list,t.paginationConf.totalItems=e.total},e)};t.dateOptions={formatYear:"yy",startingDay:1},t.opened=!1,t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.createWave=function(){if("undefined"==typeof t.city.id)return alert("请选择波次所属城市，再继续操作"),!1;if(!t.orderType)return void alert("请先选择订单类型");if(!t.startTime)return alert("请选择波次的配送日期，再继续操作"),!1;if(!t.deliverT)return alert("请选择波次的配送时段，再继续操作"),!1;var e={city_id:t.city.id,order_type:t.orderType.code,deliver_date:Date.parse(t.startTime)/1e3,deliver_time:t.deliverT.val};s.tips({actionText:"确定",bodyText:"确定创建波次？",ok:function(){a.getdata("wave/create_wave","POST",function(t){0===parseInt(t.status)?(alert("波次创建成功,波次号为"+t.wave_id),l()):alert(t.msg)},e)}})},t.setReleased=function(e){var l=t.list.indexOf(e);s.tips({actionText:"确定",bodyText:"确定开始分拣？",ok:function(){a.getdata("wave/create_pick_task","POST",function(e){0===parseInt(e.status)?(t.list[l].pick_task_created=1,t.list[l].task_created=e.msg,alert(e.msg)):alert(e.msg)},{wave_id:t.list[l].id})}})},t.paginationConf={currentPage:1,itemsPerPage:15},t.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",l),t.search=function(){"undefined"!=typeof t.init&&(l(),t.init.release=t.init.released),t.isAll=!1},t.rollWave=function(){var e=[];angular.forEach(t.list,function(t){t.isChecked&&e.push(t.id)}),s.tips(0==e.length?{bodyText:"没有要删除的波次"}:{actionText:"确定",bodyText:"确定删除波次？",ok:function(){e.length>0?a.getdata("wave/delete_wave","POST",function(e){0===parseInt(e.status)?(alert("删除波次成功"),l(),t.isAll=!1):alert("任务创建失败")},{wave_ids:e}):alert("任务创建失败")}})},t.selectAll=function(){t.isAll=!t.isAll,angular.forEach(t.list,function(e){e.isChecked=t.isAll})},t.reset=function(){t.init.wave={},t.init.searchValue="",t.init.released=!1,t.isAll=!1,l(),t.init.release=t.init.released}}]),angular.module("hop").controller("WaveDetailCtrl",["$scope","$stateParams","req",function(t,e,a){var s=function(){var s={wave_id:e.wave_id};a.getdata("wave/wave_info","POST",function(e){t.info=e.info,t.relatedOrders=e.related_orders},s)};s()}]),angular.module("hop").controller("LoginCtrl",["$scope","req","$location","$cookieStore",function(t,e,a,s){t.user={mobile:"",password:""},t.message={text:"",status:""},t.login=function(){if(t.loginForm.$invalid)return t.loginForm.submitted=!0,!1;var a=function(a){return 0!==parseInt(a.status)?(t.error={cls:"alert alert-danger",msg:a.msg},!1):(s.put("type",a.info.type),s.put("id",a.info.id),localStorage.setItem("access",a.access),e.redirect(e.refer),void 0)};e.getdata("user/login","POST",a,t.user)}}]),angular.module("hop").controller("UserListCtrl",["$location","dialog","req","$scope",function(t,e,a,s){s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0};var l=function(){a.getdata("user/role_list","POST",function(t){0==t.status&&(s.role_list=t.role_list)})},o=function(){var t=s.role?s.role.id:0,e={roleId:t,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("user/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list)},e)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",o),s.search=function(){o()},s.reset=function(){s.searchValue="",s.startTime="",s.endTime="",o()},s.setStatus=function(t,l){var o="禁用";1==l&&(o="启用"),e.tips({actionText:"确定",bodyText:"确定"+o+"["+s.list[t].name+"]账号吗?",ok:function(){a.getdata("user/toggle_status","POST",function(a){0==a.status?(e.tips({bodyText:"操作成功！"}),s.list[t].status=l):e.tips({bodyText:"操作失败！"})},{uid:s.list[t].id,status:l})}})},s.resetPassword=function(t){e.tips({actionText:"确定",bodyText:"确定重置用户["+s.list[t].name+"]的密码吗?",ok:function(){a.getdata("user/reset_password","POST",function(t){e.tips(0==t.status?{bodyText:"密码重置成功！"}:{bodyText:"密码重置失败！"})},{uid:s.list[t].id})}})},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除用户["+s.list[t].name+"]吗?",ok:function(){a.getdata("user/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),o()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id})}})};var i=function(){var e=t.$$host,a="http://api.dachuwang.com/";0!==e.indexOf("hop.dachuwang.com")&&(a="http://api.dachuwang.net/");var l=a+"hop/user/export_data?1=1";s.role&&(l+="&userType="+s.role.id),s.status&&(l+="&status="+s.status),s.key&&(l+="&key="+s.key),s.startTime&&(l+="&startTime="+Date.parse(s.startTime)),s.endTime&&(l+="&endTime="+Date.parse(s.endTime)),window.open(l)};s.exportData=function(){e.tips({headerText:"导出数据",actionText:"确定",bodyText:"确定导出数据吗?",ok:function(){i()}})},l()}]),angular.module("hop").controller("UserEditCtrl",["$location","dialog","req","$scope","$stateParams",function(t,e,a,s,l){var o=function(){s.id=l.id;var t={id:s.id};a.getdata("user/edit_input","POST",function(t){0==t.status&&(s.data=t.info,s.dept_list=t.dept_list,s.role_list=t.role_list,s.province_list=t.province_list,angular.forEach(s.dept_list,function(e){e.id==t.info.dept_id&&(s.data.dept=e)}),angular.forEach(s.role_list,function(e){e.id==t.info.role_id&&(s.data.role=e)}),angular.forEach(s.province_list,function(e){e.id==t.info.province_id&&(s.data.province=e)}))},t)};s.edit=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t={id:s.data.id,deptId:s.data.dept.id,roleId:s.data.role.id,name:s.data.name,mobile:s.data.mobile,provinceId:s.data.province.id,address:s.data.address};a.getdata("/user/edit","POST",function(t){0==t.status?(e.tips({bodyText:"修改用户成功！"}),a.redirect("/user/list")):e.tips({bodyText:"修改用户失败,"+t.msg})},t)}},o()}]),angular.module("hop").controller("UserDynamicCtrl",["$location","dialog","req","$scope","$stateParams","$cookieStore",function(t,e,a,s,l,o){var i=function(){return{getUserInfo:function(){a.getdata("customer/view","POST",function(t){0==t.status&&(s.info=t.info)},{id:l.id})},getOrderHistory:function(t,e){a.getdata("customer/history_order","POST",function(t){0==t.status&&(s.orderHistoryList=t.orderlist,s.totalArr=t.total,s.paginationConf.totalItems=t.total_count,s.total=t.total_count)},t,e)},getOrderComplaint:function(t,e){a.getdata("customer/history_complaint","POST",function(t){0==t.status&&(s.orderComplaintList=t.list,s._paginationConf.totalItems=t.total,s.total=t.total)},t,e)}}},n={init:function(){s.model_order={dateOptions:{formatYear:"yy",startingDay:1},endDateOptions:{formatYear:"yy",startingDay:1},endOpened:!1,opened:!1,status:"-1",searchValue:"",startTime:"",endTime:""},s.model_complaint={dateOptions:{formatYear:"yy",startingDay:1},endDateOptions:{formatYear:"yy",startingDay:1},endOpened:!1,opened:!1,status:"-1",searchValue:"",startTime:"",endTime:""},s.openLightboxModal=function(){},this.pagerInit(),this.pagerInitComplaint(),i().getUserInfo(),i().getOrderHistory({userId:l.id}),i().getOrderComplaint({userId:l.id})},filterByStatus:function(t){s.model_order.status=t,o.remove("orderHistorylistCookie"),s.model_order.searchValue="",o.put("orderHistorylistCookie",s.model_order.status),s.paginationConf.currentPage=1,this.getList(!0)},filterByStatus_complaint:function(t){s.model_complaint.status=t,o.remove("orderHistoryComplaintCookie"),s.model_complaint.searchValue="",o.put("orderHistoryComplaintCookie",s.model_complaint.status),s._paginationConf.currentPage=1,this.getList_complaint(!0)},pagerInit:function(){var t=o.get("paginationCookie");s.getpage=function(){o.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:t,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",this.getList)},pagerInitComplaint:function(){var t=o.get("_paginationCookie");s._getpage=function(){o.put("_paginationCookie",s._paginationConf.currentPage)},s._paginationConf={currentPage:t,itemsPerPage:15},s.$watch("_paginationConf.currentPage + _paginationConf.itemsPerPage",this.getList_complaint(!0))},"goto":function(t){$state.go(t)},open:function(t){t.preventDefault(),t.stopPropagation(),s.model_order.opened=!0},endOpen:function(t){t.preventDefault(),t.stopPropagation(),s.model_order.endOpened=!0},open_complaint:function(t){t.preventDefault(),t.stopPropagation(),s.model_complaint.opened=!0},endOpen_complaint:function(t){t.preventDefault(),t.stopPropagation(),s.model_complaint.endOpened=!0},initParam:function(){s.status="-1",s.model_order.searchValue="",s.model_order.startTime="",s.model_order.endTime=""},initParam_complaint:function(){s.model_complaint.status="-1",s.model_complaint.searchValue="",s.model_complaint.startTime="",s.model_complaint.endTime=""},reset:function(t){1==t?(this.initParam(),this.getList()):2==t&&(this.initParam_complaint(),this.getList_complaint())},getList:function(t){var e={searchValue:s.model_order.searchValue,status:s.model_order.status,startTime:Date.parse(s.model_order.startTime),endTime:Date.parse(s.model_order.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage,userId:l.id};i().getOrderHistory(e,t)},getList_complaint:function(t){var e={searchValue:s.model_complaint.searchValue,status:s.model_complaint.status,startTime:Date.parse(s.model_complaint.startTime),endTime:Date.parse(s.model_complaint.endTime),currentPage:s._paginationConf.currentPage,itemsPerPage:s._paginationConf.itemsPerPage,userId:l.id};i().getOrderComplaint(e,t)},"delete":function(t){var s=this;e.tips({actionText:"确定",bodyText:"确定删除投诉单吗?",ok:function(){a.getdata("complaint/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),s.getList_complaint()):e.tips({bodyText:"删除失败！"+t.msg})},{id:t},!0)}})},search:function(){this.getList(!0)},search_complaint:function(){this.getList_complaint(!0)}};n.init(),s.func=n}]),angular.module("hop").controller("UserCreateCtrl",["$location","dialog","req","$scope","$stateParams",function(t,e,a,s){var l=function(){a.getdata("/user/create_input","POST",function(t){0==t.status&&(s.dept_list=t.dept_list,s.role_list=t.role_list,s.province_list=t.province_list)})};s.create=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t={deptId:s.data.dept.id,roleId:s.data.role.id,name:s.data.name,mobile:s.data.mobile,provinceId:s.data.province.id,address:s.data.address};a.getdata("/user/create","POST",function(t){0==t.status?(e.tips({bodyText:"添加用户成功！"}),a.redirect("/user/list")):e.tips({bodyText:"添加用户失败。"})},t)}},l()}]),angular.module("hop").controller("RoleListCtrl",["$location","dialog","req","$scope",function(t,e,a,s){var l=function(){var t={searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("role/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list)},t)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",l),s.search=function(){l()},s.reset=function(){s.searchValue="",l()},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除角色["+s.list[t].name+"]吗?",ok:function(){a.getdata("role/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),l()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id})}})}}]),angular.module("hop").controller("RoleEditCtrl",["$location","dialog","req","$scope","$stateParams",function(t,e,a,s,l){var o=function(){s.id=l.id;var t={id:s.id};a.getdata("role/edit_input","POST",function(t){0==t.status&&(s.list=t.list,s.data=t.info)},t)};s.edit=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t=[];angular.forEach(s.list,function(e){e.checked&&t.push(e.id)});var l={id:s.data.id,name:s.data.name,dataset:s.data.dataset,pri_id:t};a.getdata("role/edit","POST",function(t){0==t.status?(e.tips({bodyText:"修改角色成功！"}),a.redirect("/role/list")):e.tips({bodyText:"修改角色失败。"})},l)}},s.toggle=function(t){var e=s.list[t];angular.forEach(s.list,function(t){e.checked?(t.level<e.level&&-1!==e.path.indexOf(t.path)&&(t.checked=!0),t.level>e.level&&-1!==t.path.indexOf(e.path)&&(t.checked=!0)):t.level>e.level&&-1!==t.path.indexOf(e.path)&&(t.checked=!1)})},o()}]),angular.module("hop").controller("RoleCreateCtrl",["$location","dialog","req","$scope",function(t,e,a,s){var l=function(){a.getdata("role/create_input","POST",function(t){0==t.status&&(s.list=t.list)})};s.create=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t=[];angular.forEach(s.list,function(e){e.checked&&t.push(e.id)});var l={name:s.data.name,dataset:s.data.dataset,pri_id:t};a.getdata("role/create","POST",function(t){0==t.status?(e.tips({bodyText:"添加角色成功！"}),a.redirect("/role/list")):e.tips({bodyText:"添加角色失败。"})},l)}},s.toggle=function(t){var e=s.list[t];angular.forEach(s.list,function(t){e.checked?(t.level<e.level&&-1!==e.path.indexOf(t.path)&&(t.checked=!0),t.level>e.level&&-1!==t.path.indexOf(e.path)&&(t.checked=!0)):t.level>e.level&&-1!==t.path.indexOf(e.path)&&(t.checked=!1)})},l()}]),angular.module("hop").controller("PrivilegeListCtrl",["$location","dialog","req","$scope",function(t,e,a,s){var l=function(){var t={searchValue:s.searchValue,currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("privilege/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list)},t)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",l),s.search=function(){l()},s.reset=function(){s.searchValue="",l()},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除权限["+s.list[t].name+"]吗?",ok:function(){a.getdata("privilege/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),l()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id})}})}}]),angular.module("hop").controller("PrivilegeEditCtrl",["$location","dialog","req","$scope","$stateParams",function(t,e,a,s,l){var o=function(){s.id=l.id;var t={id:s.id};a.getdata("privilege/edit_input","POST",function(t){0==t.status&&(s.data=t.info,s.list=t.list,angular.forEach(s.list,function(e){e.id==t.info.parent_id&&(s.data.parent=e)}))},t)};s.edit=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t=0;s.data.parent&&(t=s.data.parent.id);var l={id:s.data.id,name:s.data.name,parentId:t,module:s.data.module,resource:s.data.resource,operation:s.data.operation};a.getdata("privilege/edit","POST",function(t){0==t.status?(e.tips({bodyText:"修改权限成功！"}),a.redirect("/privilege/list")):e.tips({bodyText:"修改权限失败。"})},l)}},o()}]),angular.module("hop").controller("PrivilegeCreateCtrl",["$location","dialog","req","$scope",function(t,e,a,s){var l=function(){a.getdata("privilege/create_input","POST",function(t){0==t.status&&(s.list=t.list)})};s.create=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t=0;s.data.parent&&(t=s.data.parent.id);var l={name:s.data.name,parentId:t,module:s.data.module,resource:s.data.resource,operation:s.data.operation};a.getdata("privilege/create","POST",function(t){0==t.status?(e.tips({bodyText:"添加权限成功！"}),a.redirect("/privilege/list")):e.tips({bodyText:"添加权限失败。"})},l)}},l()}]),angular.module("hop").controller("PrintPickTaskController",["$location","dialog","req","$scope","$http","$timeout","pickTaskListInfo",function(t,e,a,s,l,o,i){s.list=i.list,o(function(){})}]),angular.module("hop").controller("PrintController",["$location","dialog","req","$scope","$http","$timeout","distListInfo",function(t,e,a,s,l,o,i){s.list=i.list,o(function(){});var n={show:"打印地图",hide:"隐藏地图"};s.togglemap=!0,s.text=n.hide,s.printmap=function(){0==s.togglemap?(s.text=n.hide,s.togglemap=!0):(s.text=n.show,s.togglemap=!1)}}]),angular.module("hop").controller("PickCtrl",["$scope","req","dialog",function(t,e,a){e.getdata("wave/pick_list_page_options","GET",function(e){t.sites=e.sites,t.cities=e.cities,t.order_types=e.order_type}),t.init={waveId:"",pickTaskId:"",pickNo:""},t.status="all";var s=function(){var a=t.city||{id:0},s=t.site||{id:0},l=t.order_type||{code:1},o={wave_id:t.init.waveId,city_id:a.id,site_src:s.id,order_type:l.code,status:t.status,pick_task_id:t.init.pickTaskId,pick_number:t.init.pickNo,currentPage:t.paginationConf.currentPage,itemsPerPage:t.paginationConf.itemsPerPage};e.getdata("wave/pick_task_list","POST",function(e){t.list=e.list,t.total=e.total_count,t.paginationConf.totalItems=e.total},o)};t.paginationConf={currentPage:1,itemsPerPage:15},t.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",s),t.search=function(){"undefined"!=typeof t.init&&s()},t.filterByStatus=function(e){t.status=e,s()},t.reset=function(){t.init.waveId="",t.init.pickTaskId="",t.init.pickNo="",s()},t.checkAll=function(){angular.forEach(t.list,function(e){e.checked=t.check_all})},t.print=function(){var e=[],s="";return angular.forEach(t.list,function(t){t.checked&&(s+=t.id+",",e.push(t.pick_number))}),e&&e.length<=0?void a.tips({bodyText:"请选择要打印的分拣单！"}):void window.open("/print/pickTask/"+s)}}]),angular.module("hop").controller("PickTaskDetailCtrl",["$scope","$stateParams","req","dialog",function(t,e,a,s){var l=function(){var s={pick_task_id:e.task_id};a.getdata("wave/pick_task_info","POST",function(e){t.info=e.info,t.skuList=e.sku_list},s)};l(),t.finishTask=function(){t.clicked=!0,s.tips({actionText:"确定",bodyText:"确定完成分拣任务？",ok:function(){a.getdata("wave/finish_task","POST",function(e){0===parseInt(e.status)?(t.clicked=!0,alert("分拣完成"),a.redirect("/pick")):(t.clicked=!1,console.log(e),alert("分拣失败"))},{pick_task_id:t.info.id})},close:function(){t.clicked=!1}})}}]),angular.module("hop").controller("mapCtrl",["$scope","$modal","$filter","req","dialog","lineRouter",function(t,e,a,s,l){var o=t.orderdata={successorder:{list:[],id:""},iconModel:[],iconObj:[],success:[],okData:[],successObj:[],iconLigt:[],enOrder:[],orderlen:0,successlen:0,waitinglen:0,orderslen:0};t.viewShow="list",t.orderList=[],t.checklist=[],t.idlist=[],t.sum=0,t.quantity=0,t.customerSum=0,t.quantitys=0,t.pagesize=300,t.listOk=function(){if(!t.orderList.length)return void l.tips({bodyText:"请先选择订单！"});t.orderdata.successlen+=t.orderList.length,o.orderslen++,angular.forEach(t.orderList,function(t){o.successorder.id+=t.id+",",o.successorder.line=t.line,o.iconObj.push(t.model),o.successObj.push(t.id),o.iconLigt.push(t.model)}),angular.forEach(t.orderdata.data,function(t){1==t.isChecked&&(t.ngDisabled=!0)}),o.iconModel.push({icon:o.iconObj}),o.successorder.id=o.successorder.id.substring(0,o.successorder.id.length-1);var e=t.sum,a=t.quantity;o.success.push({id:o.successorder.id,line:o.successorder.line,customersum:t.customerSum,line_id:o.line_id,len:t.orderList.length,sum:e,quantity:a,date:new Date}),o.successorder.id="",t.quantity=t.sum=0,t.customerSum=0,o.iconObj=[],t.orderList=[]},t.sortableOptions={containment:"#sortable-container",accept:function(t,e){return t.itemScope.sortableScope.$id===e.$id}},t.removelist=function(e,a,s,l){angular.forEach(t.orderdata.data,function(t){t.id==e&&(t.isChecked=!1)}),t.sum=t.sum-s,t.quantity=t.quantity-l;for(var o in t.orderList)t.orderList[o].id==e&&(t.orderList.splice(o,1),"map"==t.viewShow&&(a.setClickable(!0),a.show()));t.recalc()},t.removeorder=function(e,a,s,l,i){angular.forEach(t.orderdata.data,function(e){if(1==e.isChecked){t.orderidlist=[],t.orderidlists=[],t.orderidlist.push(l),t.orderidlists=t.orderidlist.toString().split(",");for(var a in t.orderidlists)e.id==t.orderidlists[a]&&(e.ngDisabled=!1,e.isChecked=!1)}});for(var n in t.orderdata.success)s==t.orderdata.success[n].date&&(angular.forEach(o.iconModel[n].icon,function(){}),o.orderslen--,o.successlen=o.successlen-i,t.orderdata.success.splice(n,1),o.iconModel.splice(n,1));for(var r=o.scId=l.split(","),n=0;n<o.successObj.length;n++)for(var c=0;c<r.length;c++)o.successObj[n]==r[c]&&o.successObj.splice(n,1);o.line_id&&t.switchRoute(o.line_id)},t.maporderOk=function(e){l.tips({actionText:"确定",bodyText:"确定生成配送单吗?",ok:function(a){return t.orderdata.successlen=0,angular.forEach(e,function(t){o.okData.push({order_ids:t.id,order_count:t.len,line_count:t.sum,sku_count:t.quantity})}),a?void s.getdata("/distribution/create","post",function(t){0==t.status&&(o.success=[],o.okData=[],l.tips({bodyText:t.msg+",配送单号为："+t.dist_numbers}),i())},{distributions:o.okData,deliver_time:a}):(alert("请选择配送时间"),void(o.okData=[]))}},{templateUrl:"dist.html"})},t.switchRoute=function(e){t.switchrouteid=e},t.orderdetail=function(t){l.tips({detail:t},{templateUrl:"orderdetail.html"})},t.view=function(){},t.orderdata.data=null,t.paginationConf={currentPage:1,itemsPerPage:15},t.recalc=function(){var e=[];angular.forEach(t.orderList,function(t){e.push(t.userId)});var a=[];angular.forEach(e,function(t){-1==a.indexOf(t)&&a.push(t)}),t.customerSum=a.length},t.checked=function(e){t.quantitys=0,0==e.isChecked&&angular.forEach(t.orderList,function(a){e.id==a.id&&(e.model=a.model,e.sum=a.sum,e.quantity=a.quantity,t.removelist(e.id,e.model,e.sum,e.quantity))}),1==e.isChecked&&(t.sum+=e.detail.length,angular.forEach(e.detail,function(e){var a=1*e.quantity;t.quantity+=a,t.quantitys+=a}),t.orderList.push({detail:e,name:e.realname,quantity:t.quantitys,sum:e.detail.length,id:e.id,userId:e.user_id,line:e.line,tel:e.mobile,geo:e.geo,address:e.deliver_addr,store:e.shop_name})),t.recalc()},t.selectAll=function(){t.isAll=!t.isAll,t.isAll?angular.forEach(t.orderdata.data,function(e){e.isChecked||(e.isChecked=t.isAll,t.quantitys=0,angular.forEach(e.detail,function(e){var a=1*e.quantity;t.quantity+=a,t.quantitys+=a}),t.orderList.push({detail:e,name:e.realname,quantity:t.quantitys,sum:e.detail.length,id:e.id,userId:e.user_id,tel:e.mobile,address:e.deliver_addr,store:e.shop_name,geo:e.geo}),t.sum+=e.detail.length)}):angular.forEach(t.orderdata.data,function(e){e.ngDisabled||(e.isChecked=t.isAll,angular.forEach(t.orderList,function(a,s){e.id==a.id&&(t.sum-=a.sum,t.quantity-=a.quantity,t.orderList.splice(s,1))}))}),t.recalc()},t.viewFn=function(e){"list"==e?(angular.forEach(t.orderdata.data,function(e){for(var a in t.orderList)e.id==t.orderList[a].id&&(e.isChecked=!0)}),angular.forEach(t.orderdata.data,function(e){for(var a in t.orderdata.success){t.idlist=[],t.idlists=[],t.idlist.push(t.orderdata.success[a].id),t.idlists=t.idlist.toString().split(",");for(var s in t.idlists)t.idlists[s]==e.id&&(e.isChecked=!0,e.ngDisabled=!0)}})):"map"==e&&t.initMarker("","","","",t.orderdata.data),t.viewShow=e},t.dateOptions={formatYear:"yy",startingDay:1},t.opened=!1,t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.timeList=[{id:"today",val:"全天"},{id:1,val:"上午"},{id:2,val:"下午"}];var i=function(){s.getdata("distribution/line_list","POST",function(e){0==e.status&&(t.cityList=e.cities,t.lineListAll=e.list,t.orderTypeList=e.order_type,t.orderType=t.orderTypeList[0],t.switchCity())})};i(),t.switchCity=function(){return t.city?(t.lineListCur=[],void angular.forEach(t.lineListAll,function(e){var a=!0;t.city&&e.location_id!=t.city.id&&(a=!1),a&&t.lineListCur.push(e)})):void(t.lineListCur=t.lineListAll)},t.mapfilter=function(){var e=t.city||{id:0},a=t.time||{id:0},s=t.dateValue||"",l=t.router||{id:0},o=t.orderType||{code:0};return e.id?o.code?s?a.id?void t.initMarker("suborder/lists_assign","post",{line_id:l.id,cityId:e.id,orderType:o.code,chosedate:Date.parse(s),chosetime:a.id,itemsPerPage:t.pagesize},"waiting"):void alert("请选择配送的时段，再继续操作"):void alert("请选择配送的日期，再继续操作"):void alert("请先选择订单类型"):void alert("请选择配送的城市，再继续操作")}}]),angular.module("hop").controller("SuborderListCtrl",["$location","dialog","req","$scope","$cookieStore","appConfigure",function(t,e,a,s,l,o){s.status="-1",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0},s.confirmZip=function(){var t=window.confirm("是否确认明日需要配送的订单已审核完毕？");t&&(window.location.href=o.url+"/temp_export/write_all_city_orders_to_tmp_dir?need_confirm=1")};var i=function(){a.getdata("order/list_options","POST",function(t){0==t.status&&(s.cityList=t.cities,s.siteList=t.sites,s.orderTypeList=t.order_type,s.orderType=s.orderTypeList[0])})};i();var n=function(){var t=l.get("orderlistCookie")||"";s.searchValue=t;var e=l.get("orderlistTabCookie")||"";s.status=e;var o=s.site||{id:0},i=s.city||{id:0},n=s.orderType||{code:0},r={status:s.status,orderType:n.code,cityId:i.id,site_src:o.id,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("suborder/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total_count,s.list=t.orderlist,s.total=t.total)},r)},r=l.get("paginationCookie");s.getpage=function(){l.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:r,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",n),s.search=function(){l.put("orderlistCookie",s.searchValue),n()},s.filterByStatus=function(t){s.status=t,l.remove("orderlistCookie"),s.searchValue="",l.put("orderlistTabCookie",s.status),s.paginationConf.currentPage=1,n()},s.reset=function(){l.remove("orderlistCookie"),s.searchValue="",s.startTime="",s.endTime="",n()}}]),angular.module("hop").controller("SuborderDetailCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams",function(t,e,a,s,l,o,i,n){s.data="",s.deal_price={},s.order_number=n.order_number;var r=i.get("type");s.is_operate=10==r?!0:!1;var c=function(){a.getdata("suborder/info","POST",function(t){if(0==t.status){s.data=t.info,s.deal_price.key=t.info.total_price,s.reasonList=t.cancel_reason,s.deliver_time=t.deliver_time;var e=new Date,a=e.getHours();s.deliver_flag=!1,23>a&&(2==s.data.status||3==s.data.status)&&(s.deliver_flag=!0)}},{order_number:s.order_number})};c(),s.back=function(){history.go(-1)},s.setStatus=function(e){t.tips({bodyText:"确定修改此订单状态吗？",order:s.data,reasonList:s.reasonList,ok:function(t,l){var o=[];angular.forEach(s.data.detail,function(t){o.push({id:t.id,actual_price:t.price,actual_quantity:t.quantity,actual_sum_price:t.sum_price})});var i=t||"";l&&l.code&&6!=l.code&&(i=l.msg);var n={suborder_id:s.data.id,deal_price:s.deal_price.key,remark:i,order_details:o},r="";"delivering"==e?r="suborder/set_delivering":"signed"==e?r="suborder/set_signed":"rejected"==e?r="suborder/set_rejected":"success"==e&&(r="suborder/set_success"),a.getdata(r,"POST",function(){c()},n)},actionText:"确定",closeText:"取消"},{templateUrl:"set_status.html"})},s.setRemark=function(e){t.tips({bodyText:"",order:s.data,ok:function(t){a.getdata("/suborder/add_comment","POST",function(){c()},{order_id:e,remark:t},!0)},actionText:"确定",closeText:"取消"},{templateUrl:"set_remark.html"})},s.plus=function(t){t.quantity=parseInt(t.quantity)+1,s.sumPrice(t)},s.minus=function(t){parseInt(t.quantity)>0&&(t.quantity=parseInt(t.quantity)-1),s.sumPrice(t)},s.backUpNum={},s.clearNum=function(t){s.backUpNum[t.id]=t.quantity,t.quantity="",s.sumPrice(t)},s.setNum=function(t,e){e=e?e:!1,e&&""===t.quantity&&s.backUpNum[t.id]&&(t.quantity=s.backUpNum[t.id],s.backUpNum[t.id]=""),null!=t.quantity&&t.quantity<=0?t.quantity=0:(null!=t.quantity||e)&&(/^\d+$/.test(t.quantity)||(t.quantity=1)),s.sumPrice(t)},s.backUpPrice={},s.clearPrice=function(t){s.backUpPrice[t.id]=t.price,t.price="",s.sumPrice(t)},s.setPrice=function(t,e){e=e?e:!1,e&&""===t.price&&s.backUpPrice[t.id]&&(t.price=s.backUpPrice[t.id],s.backUpPrice[t.id]=""),null!=t.price&&t.price<=0?t.price=0:(null!=t.price||e)&&(/^\d+\.*\d{0,2}$/.test(t.price)||(t.price=1)),s.sumPrice(t)},s.sumPrice=function(t){var e=parseInt(100*t.price);t.sum_price=e*t.quantity/100;var a=0;angular.forEach(s.data.detail,function(t){a+=parseInt(100*t.sum_price)}),s.deal_price.key=a/100},s.setSumPrice=function(t,e){e=e?e:!1,null!=t.sum_price&&t.sum_price<=0?t.sum_price=0:(null!=t.sum_price||e)&&(/^\d+\.*\d{0,2}$/.test(t.sum_price)||(t.sum_price=0))},s.setDealPrice=function(t){t=t?t:!1,null!=s.deal_price.key&&s.deal_price.key<=0?s.deal_price.key=0:(null!=s.deal_price.key||t)&&(/^\d+\.*\d{0,2}$/.test(s.deal_price.key)||(s.deal_price.key=0))},s.setDeliverTime=function(){t.tips({bodyText:"",deliver_times:s.deliver_time,ok:function(t,e){var l={suborder_id:s.data.id,deliver_date:t.val,deliver_time:e.code};a.getdata("/suborder/change_deliver_time","POST",function(){c()},l,!0)},actionText:"确定",closeText:"取消"},{templateUrl:"set_time.html"})}}]),angular.module("hop").controller("OrderListCtrl",["$location","dialog","req","$scope","$cookieStore","appConfigure",function(t,e,a,s,l,o){s.status="-1",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0},s.confirmZip=function(){var t=window.confirm("是否确认明日需要配送的订单已审核完毕？");t&&(window.location.href=o.url+"/temp_export/write_all_city_orders_to_tmp_dir?need_confirm=1")};var i=function(){a.getdata("order/list_options","POST",function(t){0==t.status&&(s.cityList=t.cities)})};i();var n=function(){var t=l.get("orderlistCookie")||"";s.searchValue=t;var e=l.get("orderlistTabCookie")||"";s.status=e;var o=s.city||{id:0},i={status:s.status,cityId:o.id,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("order/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total_count,s.list=t.orderlist,s.total=t.total)},i)},r=l.get("paginationCookie");s.getpage=function(){l.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:r,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",n),s.search=function(){l.put("orderlistCookie",s.searchValue),n()},s.filterByStatus=function(t){s.status=t,l.remove("orderlistCookie"),s.searchValue="",l.put("orderlistTabCookie",s.status),s.paginationConf.currentPage=1,n()},s.reset=function(){l.remove("orderlistCookie"),s.searchValue="",s.startTime="",s.endTime="",n()}}]),angular.module("hop").controller("SuborderSignCtrl",["$location","dialog","req","$scope","$cookieStore",function(t,e,a,s,l){s.status="-1";var o=function(){var t=l.get("orderSignCookie")||"";s.searchValue=t;var e={status:s.status,searchValue:s.searchValue,currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("suborder/lists_sign","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total_count,s.list=t.orderlist,s.total=t.total)},e)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",o),s.search=function(){l.put("orderSignCookie",s.searchValue),o()
},s.filterByStatus=function(t){s.status=t,o()},s.reset=function(){l.remove("orderSignCookie"),s.searchValue="",o()}}]),angular.module("hop").controller("SuborderPaymentCtrl",["$location","dialog","req","$scope","$cookieStore",function(t,e,a,s,l){s.status="-1";var o=function(){var t=l.get("orderPaymentCookie");s.searchValue=t;var e={status:s.status,searchValue:s.searchValue,currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("suborder/lists_payment","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total_count,s.list=t.orderlist,s.total=t.total)},e)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",o),s.search=function(){l.put("orderPaymentCookie",s.searchValue),o()},s.filterByStatus=function(t){s.status=t,o()},s.reset=function(){l.remove("orderPaymentCookie"),s.searchValue="",o()}}]),angular.module("hop").controller("SuborderDeliverCtrl",["$location","dialog","req","$scope","appConfigure","$cookieStore",function(t,e,a,s,l,o){function i(t){var e=Date.parse(t),a=new Date(e),s=a.getFullYear(),l=a.getMonth()+1,o=a.getDate();return s+"-"+l+"-"+o}s.status="-1",s.site_url=l.url;var n=function(){a.getdata("order/list_options","POST",function(t){0==t.status&&(s.orderTypeList=t.order_type,s.cityList=t.cities,s.orderType=s.orderTypeList[0])})};n();var r=function(){var t=o.get("orderDeliverCookie")||"";s.searchValue=t;var e={status:s.status,searchValue:s.searchValue,currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("suborder/lists_deliver","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total_count,s.list=t.orderlist,s.total=t.total,s.cityList=t.cities)},e)};s.getpage=function(){o.put("WaitingOrderPgCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:o.get("WaitingOrderPgCookie"),itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",r),s.search=function(){o.put("orderDeliverCookie",s.searchValue),r()},s.filterByStatus=function(t){s.status=t,r()},s.reset=function(){o.remove("orderDeliverCookie"),s.searchValue="",r()},s.dateOptions={formatYear:"yy",startingDay:1},s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.city=0,s.time=0,s.timeList=[{id:"today",val:"全天"},{id:1,val:"上午"},{id:2,val:"下午"}],s.downloadAll=function(){var t=s.city||{id:0},e=s.time||{id:0},a=s.orderType||{code:0};return 0==a.code?void alert("请先选择订单类型"):0==t.id||0==e.id?void alert("请先选择城市和配送时段再导出数据"):void(window.location.href=s.site_url+"/temp_export/everyday_order?deliver_date="+i(s.dateValue)+"&city_id="+t.id+"&deliver_time="+e.id)},s.downloadDetail=function(){var t=s.city||{id:0},e=s.time||{id:0},a=s.orderType||{code:0};return 0==a.code?void alert("请先选择订单类型"):0==t.id?void alert("请先选择城市和配送时段再导出数据"):void(window.location.href=s.site_url+"/temp_export/export_orders_to_deliver?deliver_date="+i(s.dateValue)+"&city_id="+t.id+"&deliver_time="+e.id+"&order_type="+a.code)},s.dateValue=i(new Date)}]),angular.module("hop").controller("OrderAuditCtrl",["$location","dialog","req","$scope","$cookieStore",function(t,e,a,s,l){s.status="-1";var o=function(){var t=l.get("orderAuditCookie")||"";s.searchValue=t;var e={status:s.status,searchValue:s.searchValue,currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("order/lists_audit","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total_count,s.list=t.orderlist,s.total=t.total)},e)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",o),s.search=function(){l.put("orderAuditCookie",s.searchValue),o()},s.filterByStatus=function(t){s.status=t,o()},s.reset=function(){l.remove("orderAuditCookie"),s.searchValue="",o()},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除订单["+s.list[t].name+"]吗?",ok:function(){a.getdata("order/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),o()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id})}})}}]),angular.module("hop").controller("OrderEditCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams",function(t,e,a,s,l,o,i,n){s.data="",s.order_number=n.order_number;var r=function(){a.getdata("order/info","POST",function(t){if(0==t.status){s.data=t.info,s.dates=t.deliver_time,angular.forEach(s.dates,function(e){e.name==t.info.deliver_date&&(s.data.deliver_date=e,s.times=e.time,angular.forEach(s.times,function(e){e.msg==t.info.deliver_time&&(s.data.deliver_time=e)}))});var e=new Date,a=e.getHours();s.deliver_flag=!1,23>a&&(2==s.data.status||3==s.data.status)&&(s.deliver_flag=!0)}},{order_number:s.order_number})};r(),s.dateChange=function(){angular.forEach(s.dates,function(t){s.data.deliver_date&&t.name==s.data.deliver_date.name&&(s.times=t.time,s.data.deliver_time="")})},s.back=function(){history.go(-1)},s.dialog=t.tips,s.edit=function(){if(!s.data.deliver_date)return void alert("请选择送货日期");if(!s.data.deliver_time)return void alert("请选择送货时间");var t={id:s.data.id,deliver_date:s.data.deliver_date.val,deliver_time:s.data.deliver_time.code};console.log(t),s.dialog({bodyText:"确定修改配送时间为"+s.data.deliver_date.name+" "+s.data.deliver_time.msg+"吗？",ok:function(){a.getdata("order/edit","POST",function(){r(),s.dialog({bodyText:"订单修改成功"})},t)},actionText:"确定",closeText:"取消"})}}]),angular.module("hop").controller("OrderDetailCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams","$filter",function(t,e,a,s,l,o,i,n){s.data="",s.deal_price={},s.order_number=n.order_number;var r=i.get("type");s.is_operate=10==r?!0:!1;var c=function(){a.getdata("order/info","POST",function(t){if(0==t.status){s.data=t.info,s.deal_price.key=t.info.total_price,s.dates=t.deliver_time,s.deliver_date=s.dates[0],s.reasonList=t.cancel_reason,s.deliver_time=t.deliver_time;var e=new Date,a=e.getHours();s.deliver_flag=!1,23>a&&(2==s.data.status||3==s.data.status)&&(s.deliver_flag=!0)}},{order_number:s.order_number})};c(),s.back=function(){history.go(-1)},s.dialog=t.tips,s.setStatus=function(t){return 0!==t&&1==s.data.pay_type&&0==s.data.pay_status?void alert("未支付成功的订单不能通过审核"):void s.dialog({bodyText:0!=t?"确定修改此订单状态吗？":"取消订单后，将不可恢复，是否确认关闭订单？",order:s.data,status:t,reasonList:s.reasonList,ok:function(e,l){var o=e||"";l&&l.code&&6!=l.code&&(o=l.msg);var i={order_id:s.data.id,remark:o},n="confirm"==t?"order/set_order_confirmed":"order/cancel_order";a.getdata(n,"POST",function(){c()},i)},actionText:"确定",closeText:"取消"},{templateUrl:"set_status.html"})},s.setRemark=function(){t.tips({bodyText:"",order:s.data,ok:function(t){a.getdata("/order/add_comment","POST",function(){c()},{order_id:s.data.id,remark:t},!0)},actionText:"确定",closeText:"取消"},{templateUrl:"set_remark.html"})},s.setDeliverTime=function(){t.tips({bodyText:"",deliver_times:s.deliver_time,ok:function(t,e){var l={order_id:s.data.id,deliver_date:t.val,deliver_time:e.code};a.getdata("/order/change_deliver_time","POST",function(){c()},l,!0)},actionText:"确定",closeText:"取消"},{templateUrl:"set_time.html"})},s.change_pay_type=function(t){s.dialog({headerText:"修改支付方式",bodyText:"支付方式",order:{pay_type:1,pay_types:[1,0],remark_msg:"",order_id:t},ok:function(t){t.remark_msg="更改支付方式为货到付款."+t.remark_msg,a.getdata("/order/set_pay_type","POST",function(t){0==t.status?(alert("修改成功"),c()):alert(t.msg)},t,!0)},actionText:"确定",closeText:"取消"},{templateUrl:"change_pay_type.html"})},s.plus=function(t){t.quantity=parseInt(t.quantity)+1,s.sumPrice(t)},s.minus=function(t){parseInt(t.quantity)>0&&(t.quantity=parseInt(t.quantity)-1),s.sumPrice(t)}}]),angular.module("hop").controller("LineListCtrl",["$location","dialog","req","$scope",function(t,e,a,s){var l=function(){a.getdata("line/list_options","POST",function(t){0==t.status&&(s.cityList=t.cities,s.siteList=t.sites)})};l();var o=function(){var t=s.site||{id:0},e=s.city||{id:0},l={cityId:e.id,siteId:t.id,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("line/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list)},l)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",o),s.search=function(){o()},s.reset=function(){s.city="",s.site="",s.searchValue="",o()},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除线路["+s.list[t].name+"]吗?",ok:function(){a.getdata("line/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),o()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id})}})}}]),angular.module("hop").controller("LineEditCtrl",["$location","dialog","req","$scope","$stateParams",function(t,e,a,s,l){var o=function(){s.id=l.id;var t={id:s.id};a.getdata("line/edit_input","POST",function(t){0==t.status&&(s.provinces=t.list,s.warehouses=t.warehouses,s.data=t.info,angular.forEach(s.provinces,function(t){t.id==s.data.location_id&&(s.data.province=t)}),angular.forEach(s.warehouses,function(t){t.id==s.data.warehouse_id&&(s.data.warehouse=t)}))},t)};s.edit=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t={id:s.data.id,name:s.data.name,fullName:s.data.full_name,description:s.data.description,locationId:s.data.province.id,warehouseId:s.data.warehouse.id,warehouseName:s.data.warehouse.name};a.getdata("line/edit","POST",function(t){0==t.status?(e.tips({bodyText:"修改线路成功！"}),a.redirect("/line/list")):e.tips({bodyText:"修改线路失败。"})},t)}},o()}]),angular.module("hop").controller("LineCreateCtrl",["$location","dialog","req","$scope",function(t,e,a,s){var l=function(){a.getdata("line/create_input","POST",function(t){0==t.status&&(s.provinces=t.list,s.warehouses=t.warehouses)})};s.create=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t={name:s.data.name,fullName:s.data.full_name,description:s.data.description,locationId:s.data.province.id,warehouseId:s.data.warehouse.id,warehouseName:s.data.warehouse.name};a.getdata("line/create","POST",function(t){0==t.status?(e.tips({bodyText:"添加线路成功！"}),a.redirect("/line/list")):e.tips({bodyText:"添加线路失败。"})},t)}},l()}]),angular.module("hop").controller("HomeAchieveCtrl",["dialog","req","$scope","$modal","$window","$cookieStore","HopAuth",function(t,e,a){a.data="",e.getdata("hop/summary/index","GET",function(t){0==t.status&&(a.data=t.data)})}]),angular.module("hop").controller("HomeCtrl",["$scope",function(t){t.awesomeThings=[{title:"AngularJS",url:"https://angularjs.org/",description:"HTML enhanced for web apps!",logo:"angular.png"},{title:"BrowserSync",url:"http://browsersync.io/",description:"Time-saving synchronised browser testing.",logo:"browsersync.png"},{title:"GulpJS",url:"http://gulpjs.com/",description:"The streaming build system.",logo:"gulp.png"},{title:"Jasmine",url:"http://jasmine.github.io/",description:"Behavior-Driven JavaScript.",logo:"jasmine.png"},{title:"Karma",url:"http://karma-runner.github.io/",description:"Spectacular Test Runner for JavaScript.",logo:"karma.png"},{title:"Protractor",url:"https://github.com/angular/protractor",description:"End to end test framework for AngularJS applications built on top of WebDriverJS.",logo:"protractor.png"},{title:"Bootstrap",url:"http://getbootstrap.com/",description:"Bootstrap is the most popular HTML, CSS, and JS framework for developing responsive, mobile first projects on the web.",logo:"bootstrap.png"},{title:"Angular UI Bootstrap",url:"http://angular-ui.github.io/bootstrap/",description:"Bootstrap components written in pure AngularJS by the AngularUI Team.",logo:"ui-bootstrap.png"},{title:"Stylus",url:"http://learnboost.github.io/stylus/",description:"Stylus is a revolutionary new language, providing an efficient, dynamic, and expressive way to generate CSS. Supporting both an indented syntax and regular CSS style.",logo:"stylus.png"}],angular.forEach(t.awesomeThings,function(t){t.rank=Math.random()})}]),angular.module("hop").controller("DistributionListCtrl",["$location","dialog","req","$scope","$cookieStore","appConfigure",function(t,e,a,s,l,o){s.site_url=o.url,s.status="-1",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0};var i=function(){a.getdata("distribution/list_options","POST",function(t){0==t.status&&(s.cityList=t.cities,s.siteList=t.sites,s.orderTypeList=t.order_type)})};i();var n=function(){var t=l.get("distListCookie")||"";s.searchValue=t;var e=l.get("distListTabCookie")||"-1";s.status=e;var o=s.city||{id:0},i=s.site||{id:0},n={cityId:o.id,siteId:i.id,orderType:s.orderType?s.orderType.code:0,status:s.status,orderId:s.orderId,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("distribution/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list,s.total=t.total,s.totals=t.totals)},n)},r=l.get("paginationCookie");s.getpage=function(){l.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:r,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",n),s.search=function(){l.put("distListCookie",s.searchValue),n()},s.filterByStatus=function(t){s.status=t,l.remove("distListCookie"),s.searchValue="",l.put("distListTabCookie",s.status),s.paginationConf.currentPage=1,n()},s.reset=function(){l.remove("distListCookie"),s.searchValue="",s.startTime="",s.endTime="",n()},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除配送单["+s.list[t].name+"]吗?",ok:function(){a.getdata("distribution/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),n()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id})}})},s.checkAll=function(){angular.forEach(s.list,function(t){t.checked=s.check_all})},s.print=function(){var t=[],l="";return angular.forEach(s.list,function(e){e.checked&&(t.push(e.id),l+=e.id+",")}),t&&t.length<=0?void e.tips({bodyText:"请选择要打印的配送单！"}):(window.open("/printpage/"+l),void a.getdata("distribution/prints","POST",function(t){0==t.status?(e.tips({bodyText:"打印配送单成功！"}),n()):e.tips({bodyText:"打印配送单失败！"+t.msg})},{dist_ids:t}))},s.export=function(){var t=[],a="";return angular.forEach(s.list,function(e){e.checked&&(t.push(e.dist_number),a+=e.dist_number+",")}),t&&t.length<=0?void e.tips({bodyText:"请选择要导出的配送单！"}):void(window.location.href=s.site_url+"/distribution/export?dist_numbers="+a)}}]),angular.module("hop").controller("DistributionDetailCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams",function(t,e,a,s,l,o,i,n){s.data="",s.deal_price={},s.dist_id=n.dist_id;var r=function(){a.getdata("distribution/view","POST",function(t){0==t.status&&(s.data=t.info,s.orderList=t.list)},{id:s.dist_id})};r(),s.back=function(){history.go(-1)}}]),angular.module("hop").controller("DepartmentListCtrl",["$location","dialog","req","$scope",function(t,e,a,s){var l=function(){var t={searchValue:s.searchValue,currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("department/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list)},t)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",l),s.search=function(){l()},s.reset=function(){s.searchValue="",l()},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除部门["+s.list[t].name+"]吗?",ok:function(){a.getdata("department/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),l()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id})}})}}]),angular.module("hop").controller("DepartmentEditCtrl",["$location","dialog","req","$scope","$stateParams",function(t,e,a,s,l){var o=function(){s.id=l.id;var t={id:s.id};a.getdata("department/edit_input","POST",function(t){0==t.status&&(s.data=t.info,s.list=t.list,angular.forEach(s.list,function(e){e.id==t.info.parent_id&&(s.data.parent=e)}))},t)};s.edit=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t=0;s.data.parent&&(t=s.data.parent.id);var l={id:s.data.id,name:s.data.name,parentId:t,description:s.data.description};a.getdata("department/edit","POST",function(t){0==t.status?(e.tips({bodyText:"修改部门成功！"}),a.redirect("/department/list")):e.tips({bodyText:"修改部门失败。"})},l)}},o()}]),angular.module("hop").controller("DepartmentCreateCtrl",["$location","dialog","req","$scope",function(t,e,a,s){s.addr={province:""};var l=function(){a.getdata("department/create_input","POST",function(t){0==t.status&&(s.departments=t.list)})};s.create=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t=0;s.data.parent&&(t=s.data.parent.id);var l={name:s.data.dept_name,parentId:t,description:s.data.description};a.getdata("department/create","POST",function(t){0==t.status?(e.tips({bodyText:"添加部门成功！"}),a.redirect("/department/list")):e.tips({bodyText:"添加部门失败。"})},l)}},l()}]),angular.module("hop").controller("CustomerNewTransferCtrl",["$location","dialog","req","$scope","$filter","$cookieStore","daChuLocal",function(t,e,a,s,l,o,i){s.show_status="1",s.show_list=!1,s.filterByStatus=function(t){t!=s.show_status&&(s.show_list?e.tips({bodyText:"你确定要切换吗?",actionText:"确定",ok:function(){s.show_list=!1,s.show_status=t,c.initParam()}}):(s.show_status=t,s.disabledS=!1,s.disabledG=!1,s.modelS.inputModelS="",s.modelL.inputModelL="",s.modelS.inputId=-1,s.modelL.inputId=-1,n.initParam(),r.initParam()))},s.$watch("show_status",function(){c.removeCheckAll()});var n={search:function(){s.basic_form_g.$setDirty(),s.basic_form_g.$invalid||(s.disabledG=!0,s.show_list=!0,c.setSystemAndCity(s.modelParamG.system,s.modelParamG.city,s.modelParamG.type,"g"))},reset:function(){s.show_list=!1,s.disabledG=!1,this.initParam(),c.reset()},initParam:function(){s.modelParamG={system:"",city:"",type:""}},init:function(){this.initParam(),s.systemModelG=[],s.cityModelG=[],s.typeModelG=[]}},r={search:function(){return s.modelS.selClickItem?(s.basic_form_s.$setDirty(),void(s.basic_form_s.$invalid||(s.disabledS=!0,s.show_list=!0,c.setSystemAndCity(s.modelParamS.system,s.modelParamS.city,s.modelParamS.type,"s")))):void(s.modelS.inputModelS="")},reset:function(){s.show_list=!1,s.disabledS=!1,s.modelS.inputModelS="",this.initParam(),c.reset()},initParam:function(){s.modelParamS={system:"",city:"",sale_role:"",sale_name:"",type:""}},selectDropSaleName:function(){s.modelS={statusModel:!1,inputModelS:"",inputId:-1,dropList:[],selClickItem:!1,selClickModel:{}},s.keyFunS=function(t){t.preventDefault(),t.stopPropagation(),s.modelS.statusModel=!0,s.modelS.changeOther=!1},s.clickItemS=function(t,e,a){"姓名没有找到"!=t&&(s.modelS.selClickItem=!0,s.modelS.statusModel=!1,s.modelS.inputModelS=t,s.modelS.inputId=e,s.modelS.selClickModel=a,s.$emit("updateModule",a.role_id,a.province_id,a.site_id))},s.$watch("modelS.inputModelS",function(t){if(!s.modelS.changeOther){var e=s.modelParamS.city,a=s.modelParamS.sale_role,o=s.salesList||[];(""!=e&&null!=e||null!=a&&""!=a)&&(s.$emit("updateSaleName",s.modelParamS.city,s.modelParamS.sale_role),o=s.saleNameModelS),s.modelS.statusModel=!0;var i=l("filter")(o,{name:t});i.length>0&&1==s.modelS.selClickItem&&""!=t||(s.modelS.selClickItem=!1),s.saleNameModelS=0==i.length?[{name:"姓名没有找到"}]:i}}),s.$on("updateModule",function(t,e,a){s.modelParamS.city=l("filter")(s.cityModelS,{id:a})[0]})},init:function(){this.initParam(),s.systemModelS=[],s.cityModelS=[],s.saleRoleModelS=[],s.typeModelS=[],this.selectDropSaleName(),s.$on("updateSaleName",function(t,e,a){var o=s.salesList;""!=e&&null!=e&&(o=l("filter")(o,{province_id:e.id})),null!=a&&""!=a&&(o=l("filter")(o,{role_id:a.code})),s.saleNameModelS=o,console.log(l("filter")(o,{id:s.modelS.inputId}).length),0===l("filter")(o,{id:s.modelS.inputId}).length&&(s.modelS.changeOther=!0,s.modelS.inputModelS="",s.modelS.statusModel=!1,s.modelS.selClickItem=!1)}),s.$watch("modelParamS.city",function(t){""!=t&&s.$emit("updateSaleName",t,s.modelParamS.sale_role)}),s.$watch("modelParamS.sale_role",function(t){""!=t&&s.$emit("updateSaleName",s.modelParamS.city,t)})}},c={search:function(){s.isClickShowCheck=!1,s.basic_form_l.$setDirty(),s.basic_form_l.$invalid||(s.show_list=!0,this.getList())},getList:function(){if(s.show_list){var t={provinceId:s.modelParamL.city.id,lineId:null==s.modelParamL.line?"":s.modelParamL.line.id,orderRecord:null==s.modelParamL.orderRecord?0:s.modelParamL.orderRecord.code,customerType:s.modelParamL.customerType.code,saleId:s.modelL.inputId,key:s.modelParamL.searchValue,currentPage:s.paginationConf.currentPage||1,itemsPerPage:s.paginationConf.itemsPerPage};console.log(t),a.getdata("/customer/lists_transfer","POST",function(t){0==t.status&&(s.check_all=!1,s.listSearch=t.list,s.paginationConf.totalItems=t.total,c.pageShowCheck(s.listSearch))},t,!0)}},pagerInitSetting:function(){var t=o.get("paginationCookie");s.getpage=function(){o.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:t,itemsPerPage:15,totalItems:0},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",this.getList)},reset:function(){s.modelParamL.line="",s.modelParamL.selTotalCount=0,s.modelParamL.sale_role="",s.modelParamL.status="",s.modelL.inputModelL="",s.modelParamL.searchValue="",s.modelL.disabledL=!0,s.modelParamL.first_order="",s.modelParamL.selTotalCount_regist=0,s.modelParamL.selTotalCount_potient=0,s.modelS.inputId=-1,s.modelL.inputId=-1,s.listSearch=[],s.statusModelL=[]},checkOne:function(t,e){var a=i.get("$listSelectSearch");a||i.get("$listSelectSearch",[]),this.pushCacheCheck(t,e)},checkAll:function(t){var e=i.get("$listSelectSearch");if(e||i.get("$listSelectSearch",[]),s.check_all=t?!0:!1,angular.forEach(s.listSearch,function(t){t.checked=s.check_all,c.pushCacheCheck(s.check_all,t)}),!t){var a=i.get("$listSelectSearch"),o=l("filter")(a,{customerType:1}).length,n=l("filter")(a,{customerType:2}).length;0==n&&(s.modelParamL.selTotalCount_regist=0),0==o&&(s.modelParamL.selTotalCount_potient=0)}},pageShowCheck:function(t){var e=i.get("$listSelectSearch");0==e.length&&e instanceof Array||e.filter(function(e){t.filter(function(t){e.id==t.id&&(t.checked=!0)})})},pushCacheCheck:function(t,e){var a=i.get("$listSelectSearch");if(null!=a&&a.length>0){var l=a.filter(function(t){return t.id==e.id})[0];if(l&&!t){var o=a.filter(function(t){return t.id!=e.id});i.set("$listSelectSearch",[]),o.length>0?(console.log(o),this.setCheckModel(o)):s.modelParamL.selTotalCount=0}else!l&&t&&(console.log("存在啊"),0==a.length&&i.set("$listSelectSearch",[]),this.setCheckModel(e))}else t&&(i.set("$listSelectSearch",[]),this.setCheckModel(e))},setCheckModel:function(t){var e=i.get("$listSelectSearch");if(0==e.length&&t instanceof Array)i.set("$listSelectSearch",t);else{var a={customerType:s.modelParamL.customerType.code,id:t.id,shop_name:t.shop_name,mobile:t.mobile,line_name:t.line_name,sale:t.sale,shop_type_name:t.shop_type_name,address:t.address,bd_name:t.bd_name,am_name:t.am_name,order_record:t.order_record};e.push(a),i.set("$listSelectSearch",e)}var o=i.get("$listSelectSearch"),n=l("filter")(o,{customerType:1}).length,r=l("filter")(o,{customerType:2}).length;o.length>0&&(s.modelParamL.selTotalCount=o.length,s.modelParamL.selTotalCount_potient=n,s.modelParamL.selTotalCount_regist=r)},removeCheckAll:function(){i.set("$listSelectSearch",[]),s.listSelectSearch=[],s.modelParamL.selTotalCount=0,s.modelParamL.selTotalCount_regist=0,s.modelParamL.selTotalCount_potient=0,s.isClickShowCheck=!1,c.checkAll(!1)},removeCheckOne:function(t){var e=s.listSelectSearch.splice(s.listSelectSearch.indexOf(t),1)[0];console.log(e),s.modelParamL.selTotalCount=s.listSelectSearch.length,this.pushCacheCheck(!1,e)},getCacheCheckList:function(){s.isClickShowCheck=!0,s.listSelectSearch=i.get("$listSelectSearch")},getBack:function(){s.isClickShowCheck=!1,this.getList()},getTransformParam:function(){var t=i.get("$listSelectSearch"),e=[],a=[];t.filter(function(t){2==t.customerType?e.push(t.id):1==t.customerType&&a.push(t.id)});var l={receiverType:s.modelParamL._seaType_.code,userId:s.modelS.inputId,cids:e,pcids:a};return l},startTransform:function(){if(s.modelParamL.selTotalCount<=0)return void e.tips({actionText:"确定",bodyText:"请您先勾选移交客户!"});if(parseInt(s.modelS.selClickModel.leftover_customer)<0||parseInt(s.modelS.selClickModel.leftover_potential_customer)<0)return void e.tips({actionText:"确定",bodyText:"超出客余容量不允许移交操作!"});if(s.isBeyoundMaxCheck2)return void e.tips({actionText:"确定",bodyText:"潜在客户客余容量超出了最大限制，无法移交!"});if(s.isBeyoundMaxCheck1)return void e.tips({actionText:"确定",bodyText:"注册客户客余容量超出了最大限制，无法移交!"});var t=this.getTransformParam();e.tips({actionText:"确定",bodyText:"你确定移交客户?",ok:function(){a.getdata("/customer/set_sales","POST",function(t){0==t.status?(c.removeCheckAll(),e.tips({bodyText:"客户移交成功"}),c.getList()):e.tips({bodyText:"客户移交失败！"})},t)}})},initParam:function(){s.modelParamL={first_order:"",system:"",city:"",sale_role:"",sale_name:"",type:"",line:"",status:"",searchValue:"",orderRecord:"",selTotalCount_regist:0,selTotalCount_potient:0},s.modelParamL.selTotalCount=0,s.listSearch=[],s.saleNameModelL=[],s.statusModelL=[]},setSystemAndCity:function(t,e,a,o){s.show_list=!0,s.modelParamL.system=t,s.modelParamL.city=e,s.modelParamL._type_=o,s.modelParamL._seaType_=a,s.lineModelL=l("filter")(s.lines,{location_id:e.id,site_src:t.id}),s.saleRoleModelL=l("filter")(s.saleRoleModelLC,{sid:a.code}),s.statusModelL=[]},selectDropSaleName:function(){s.modelL={statusModel:!1,inputModelL:"",inputId:-1,dropList:[],selClickItem:!1},s.keyFunL=function(t){t.preventDefault(),t.stopPropagation(),s.modelL.statusModel=!0,s.modelL.changeOther=!1},s.clickItemL=function(t,e,a){"姓名没有找到"!=t&&(s.modelL.selClickItem=!0,s.modelL.statusModel=!1,s.modelL.inputModelL=t,s.modelL.changeOther=!0,s.modelL.inputId=e,s.$emit("updateModuleL",a.role_id))},s.$watch("modelL.inputModelL",function(t){if(t=t||"",!s.modelL.changeOther){s.modelL.inputId=-1;var e=s.modelParamL.city,a=[];null!=e&&""!=e&&(s.$emit("updateSaleNameL",s.modelParamL.city),a=s.saleNameModelL),s.modelL.statusModel=!0;var o=l("filter")(a,{name:t});o.length>0&&1==s.modelL.selClickItem&&""!=t||(s.modelL.selClickItem=!1),s.saleNameModelL=0==o.length?[{name:"姓名没有找到"}]:o}})},initLoadRequest:function(){a.getdata("/customer/list_transfer_options","POST",function(t){0==t.status&&(s.cityModelG=s.cityModelS=s.cities=t.cities,s.customer_types=t.customer_types,s.order_records=t.order_record,s.lines=t.lines,s.saleRoleModelS=s.recvroles=t.recvroles,s.saleNameModelS=s.salesList=s.salesListL=t.sales,s.saleRoleModelL=s.saleRoleModelLC=t.saleroles,s.systemModelG=s.systemModelS=s.sites=t.sites)})},init:function(){this.initParam(),this.initLoadRequest(),this.pagerInitSetting(),s.modelParamL.selTotalCount=0,s.isBeyoundMaxCheck=!1,s.saleRoleModelL=[],s.lineModelL=[],s.statusModelL=[],s.disabledL=!1,s.typeModelL=[],s.first_orderList=[{name:"是",id:1},{name:"否",id:0}],this.selectDropSaleName(),s.$on("updateSaleNameL",function(t,e){var a=s.salesList;""!=e&&null!=e&&(a=l("filter")(a,{province_id:e.id})),s.saleNameModelL=a,s.saleNameModelL=s.saleNameModelL.filter(function(t){return t.id!=s.modelS.inputId});var o=s.saleNameModelL.filter(function(t){return t.id!=s.modelL.inputId});0===o.length&&(s.modelL.changeOther=!0,s.modelL.inputModelL="",s.modelL.statusModel=!1,s.modelL.selClickItem=!1)}),s.$watch("modelParamL.city",function(t){""!=t&&s.$emit("updateSaleNameL",t)}),s.$watch("modelS.inputId",function(t){-1!=t&&s.$emit("updateSaleNameL",s.modelParamL.city)}),s.$watch("modelParamL.selTotalCount_regist",function(){s.tipBackground1={background:"#777777"},"g"==s.modelParamL._type_?s.isBeyoundMaxCheck1=!1:"s"==s.modelParamL._type_&&(parseInt(s.modelParamL.selTotalCount_regist)>parseInt(s.modelS.selClickModel.leftover_customer)?(s.tipBackground1={background:"red"},s.isBeyoundMaxCheck1=!0):s.isBeyoundMaxCheck1=!1)}),s.$watch("modelParamL.selTotalCount_potient",function(){s.tipBackground2={background:"#777777"},console.log("potential:"+parseInt(s.modelParamL.selTotalCount_potient)+","+parseInt(s.modelS.selClickModel.leftover_potential_customer)),"g"==s.modelParamL._type_?s.isBeyoundMaxCheck2=!1:"s"==s.modelParamL._type_&&(parseInt(s.modelParamL.selTotalCount_potient)>parseInt(s.modelS.selClickModel.leftover_potential_customer)?(s.tipBackground2={background:"red"},s.isBeyoundMaxCheck2=!0):s.isBeyoundMaxCheck2=!1)})}};n.init(),r.init(),c.init(),s.gong=n,s.si=r,s.com=c}]),angular.module("hop").controller("CustomerListTransferUserCtrl",["$location","dialog","req","$scope","$state","$stateParams",function(t,e,a,s,l,o){s.status="all",s.cids=o.cids,s.keyList=[{name:"手机号",val:"mobile"},{name:"姓名",val:"name"}],s.bdRoleList=[{name:"请选择销售角色",val:"sale"},{name:"BD",val:"BD"},{name:"AM",val:"AM"}],s.roleType=s.bdRoleList[2],s.searchKey=s.keyList[0];var i=function(){var t=s.searchKey?s.searchKey.val:"",e={roleType:s.roleType.val,searchKey:t,searchValue:s.searchValue,currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("user/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list)},e)};s.paginationConf={currentPage:1,itemsPerPage:5},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",i),s.search=function(){i()},s.setSaleUser=function(t){s.saleUser=t},s.transfer=function(){e.tips({actionText:"确定",bodyText:"确定移交用户吗?",ok:function(){return s.saleUser?s.cids?(console.log(s.saleUser),console.log(s.cids),void a.getdata("customer/set_sales","POST",function(t){alert(0==t.status?"操作成功！":"操作失败！"),l.go("home.customerTransfer")},{userId:s.saleUser,cids:s.cids})):(console.log(s.cids),alert("请选择客户!"),!1):(alert("请选择销售!"),!1)}})},s.reset=function(){s.startTime="",s.endTime="",s.searchKey=s.keyList[0],s.searchValue="",i()}}]),angular.module("hop").controller("CustomerListTransferCtrl",["$location","dialog","req","$scope","$state",function(t,e,a,s,l){s.show_status="all",s.selCustomers=[],s.keyList=[{name:"客户手机号",val:"mobile"},{name:"店铺名称",val:"shop_name"}],s.bdRoleList=[{name:"BD",val:"BD"},{name:"AM",val:"AM"}],s.customerTypeList=[{name:"注册客户",val:"register"},{name:"待分配客户",val:"unallocated"}],s.searchKey=s.keyList[0],s.roleType=s.bdRoleList[0],s.customerType=s.customerTypeList[1];var o=function(){a.getdata("user/sale_lists","POST",function(t){0==t.status&&(s.allSaleList=t.list,s.saleList=t.list,s.bdList=[],s.amList=[],angular.forEach(s.saleList,function(t){14==t.role_id||15==t.role_id||16==t.role_id?s.amList.push(t):s.bdList.push(t)}),s.saleList=s.roleType?"BD"==s.roleType.val?s.bdList:s.amList:s.allSaleList)},{itemsPerPage:"all"})};o();var i=function(){var t=s.sale?s.sale.id:0,e="normal";s.customerType&&"unallocated"==s.customerType.val&&(e="unallocated");var l={status:e,saleId:t,searchKey:s.searchKey.val,searchValue:s.searchValue,currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("customer/lists_transfer","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.total=t.total,s.list=t.list,angular.forEach(s.list,function(t){angular.forEach(s.selCustomers,function(e){t.id==e.id&&(t.checked=e.checked)})}))},l)};s.paginationConf={currentPage:1,itemsPerPage:5},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",i),s.search=function(){i()},s.filterByStatus=function(t){s.show_status=t},s.reset=function(){s.roleType="",s.sale="",s.customerType="",s.searchKey=s.keyList[0],s.searchValue="",i()},s.checkAll=function(){angular.forEach(s.list,function(t,e){t.checked!=s.check_all&&(s.check_all?s.selCustomers.push(s.list[e]):angular.forEach(s.selCustomers,function(t,a){s.list[e].id==t.id&&s.selCustomers.splice(a,1)}),t.checked=s.check_all)
})},s.checkOne=function(t){s.list[t].checked?s.selCustomers.push(s.list[t]):angular.forEach(s.selCustomers,function(e,a){s.list[t].id==e.id&&s.selCustomers.splice(a,1)})},s.remove=function(t){angular.forEach(s.list,function(e){s.selCustomers[t].id==e.id&&(e.checked=!1)}),s.selCustomers.splice(t,1)},s.removeAll=function(){s.selCustomers=[],angular.forEach(s.list,function(t){t.checked=!1})},s.transferCustomer=function(){var t=[];return 0==s.selCustomers.length?void e.tips({bodyText:"请选择要操作的客户！"}):(angular.forEach(s.selCustomers,function(e){t.push(e.id)}),void l.go("home.customerTransferUser",{cids:t}))},s.changeSale=function(){s.saleList=s.roleType?"BD"==s.roleType.val?s.bdList:s.amList:s.allSaleList}}]),angular.module("hop").controller("CustomerListLineCtrl",["$location","dialog","req","$scope",function(t,e,a,s){t.path();s.line_status="toAllot",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0},s.keyList=[{name:"手机号",val:"mobile"},{name:"姓名",val:"name"},{name:"店铺名称",val:"shop_name"}],s.searchKey=s.keyList[0];var l=function(){var t={line_status:s.line_status,searchKey:s.searchKey.val,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("customer/list_line","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list)},t)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",l),s.search=function(){l()},s.filterByStatus=function(t){s.line_status=t,l()},s.setStatus=function(t,l){var o="禁用";1==l&&(o="启用"),e.tips({actionText:"确定",bodyText:"确定"+o+"["+s.list[t].name+"]账号吗?",ok:function(){a.getdata("customer/toggle_status","POST",function(e){0==e.status?(alert("操作成功！"),s.list[t].status=l):alert("操作失败！")},{uid:s.list[t].id,status:l})}})},s.reset=function(){s.startTime="",s.endTime="",s.searchKey=s.keyList[0],s.searchValue="",l()},s.editLine=function(t){console.log(t),e.tips({actionText:"确定",ok:function(){a.getdata("customer/toggle_status","POST",function(e){0==e.status?(alert("操作成功！"),s.list[t].status=status):alert("操作失败！")},{uid:s.list[t].id,status:status})},templateUrl:"line.html"})}}]),angular.module("hop").controller("CustomerListCtrl",["$location","dialog","req","$scope",function(t,e,a,s){s.status="all",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0};var l=function(){a.getdata("customer/lists_options","POST",function(t){0==t.status&&(s.line_list=t.list,s.customerTypes=t.types)})};l(),s.keyList=[{name:"手机号",val:"mobile"},{name:"姓名",val:"name"},{name:"店铺名称",val:"shop_name"}],s.searchKey=s.keyList[0];var o=function(){var t=s.line?s.line.id:0,e={status:s.status,lineId:t,searchKey:s.searchKey.val,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};void 0!=s.customerType&&(e.customer_type=s.customerType.value),a.getdata("customer/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list)},e)};s.paginationConf={currentPage:1,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",o),s.search=function(){o()},s.filterByStatus=function(t){s.status=t,o()},s.setStatus=function(t,l){var o="禁用",i="customer/disable";1==l&&(o="启用",i="customer/enable"),e.tips({actionText:"确定",bodyText:"确定"+o+"["+s.list[t].name+"]账号吗?",ok:function(){a.getdata(i,"POST",function(e){0==e.status?(alert("操作成功！"),s.list[t].status=l):alert("操作失败！")},{uid:s.list[t].id})}})},s.resetPassword=function(t){e.tips({actionText:"确定",bodyText:"确定重置密码吗?",ok:function(){a.getdata("customer/reset_password","POST",function(t){e.tips(0==t.status?{bodyText:"密码重置成功！"}:{bodyText:"密码重置失败！"})},{uid:s.list[t].id})}})},s.reset=function(){s.startTime="",s.endTime="",s.searchKey=s.keyList[0],s.searchValue="",o()},s.batchUpdateLine=function(){var t=[];return angular.forEach(s.list,function(e){e.checked&&t.push(e.id)}),t&&t.length<=0?void e.tips({bodyText:"请选择要操作的客户！"}):void e.tips({actionText:"确定修改",bodyText:"修改选中客户线路：",line_list:s.line_list,ok:function(s){return s?void a.getdata("customer/batch_edit_line","POST",function(t){0==t.status?(e.tips({bodyText:"批量修改线路成功！"}),o()):e.tips({bodyText:"批量修改线路失败！"+t.msg})},{cid:t,line_id:s.id}):void e.tips({bodyText:"请选择线路!"})}},{templateUrl:"line.html"})},s.checkAll=function(){angular.forEach(s.list,function(t){t.checked=s.check_all})}}]),angular.module("hop").controller("CustomerEditLineCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams",function(t,e,a,s,l,o,i,n){s.data="",s.customer_id=n.id;var r=function(){a.getdata("customer/edit_line_input","POST",function(t){0==t.status&&(s.data=t.info,s.lines=t.lines,angular.forEach(s.lines,function(e){e.id==t.info.line_id&&(s.data.line=e)}))},{id:s.customer_id})};r(),s.back=function(){history.go(-1)},s.dialog=t.tips,s.editLine=function(){if(!s.data.line)return void alert("请选择配送线路");var t={id:s.data.id,line_id:s.data.line.id};s.dialog({bodyText:"确定修改配送线路为"+s.data.line.name+"吗？",ok:function(){a.getdata("customer/edit_line","POST",function(){s.dialog({bodyText:"配送线路修改成功",ok:function(){a.redirect("/customer/list_line")},actionText:"确定",closeText:"取消"})},t)},actionText:"确定",closeText:"取消"})}}]),angular.module("hop").controller("CustomerEditCtrl",["$location","dialog","req","$scope","$stateParams","$upload",function(t,e,a,s,l,o){s.addr={province:""};var i={initEditData:function(t,e){return t.filter(function(t){return t.value==e})[0]},init:function(){var t={id:l.id};s.kaCheckDateHalfMonth=[{last:"",next:"",list:[]}],s.kaInvoiceDateHalfMonth=[{last:"",next:"",list:[]}],s.kaPayDateHalfMonth=[{last:"",next:"",list:[]}],a.getdata("customer/edit_input","POST",function(t){if(0==t.status){if(s.info=t.info,s.provinces=t.provinces,s.allLines=t.lines,s.sites=t.sites,s.directionList=t.directions,s.dimensionList=t.dimensions,s.customerLists=t.types,s.estimated=t.estimated,s.banks=t.banks,s.account_types=t.account_types,s.billing_cycles=t.billing_cycles,s.checkDateArr=t.check_dates,s.check_dates=[],s.kaParentMobile=t.info.parent_mobile,s.kaCustomerType=i.initEditData(t.account_types,t.info.account_type),s.kaBank=i.initEditData(t.banks,t.info.bank),s.kaBillCycle=""==t.info.billing_cycle?s.billing_cycles[0]:t.info.billing_cycle,""!=t.info.billing_cycle&&(s.kaBillCycle=i.initEditData(s.billing_cycles,t.info.billing_cycle)),s.kaUserBankBranch=t.info.sub_bank,s.kaUserBandCard=t.info.bank_account,s.greens_meat_estimated=i.initEditData(s.estimated,t.info.greens_meat_estimated),s.rice_grain_estimated=i.initEditData(s.estimated,t.info.rice_grain_estimated),s.kaUserCount="",s.$watch("kaBillCycle",function(e){void 0!=e&&angular.forEach(s.checkDateArr,function(a,l){if(l==e.value)if(s.check_dates=a,s.kaPayDateHalfMonth[0].list=s.kaInvoiceDateHalfMonth[0].list=s.kaCheckDateHalfMonth[0].list=a,"half_month"==e.value){var o=s.info.check_date.split(","),n=s.info.invoice_date.split(","),r=s.info.pay_date.split(",");s.kaCheckDateHalfMonth[0].last=i.initEditData(a[0],o[0]),s.kaCheckDateHalfMonth[0].next=i.initEditData(a[1],o[1]),s.kaInvoiceDateHalfMonth[0].last=i.initEditData(a[0],n[0]),s.kaInvoiceDateHalfMonth[0].next=i.initEditData(a[1],n[1]),s.kaPayDateHalfMonth[0].last=i.initEditData(a[0],r[0]),s.kaPayDateHalfMonth[0].next=i.initEditData(a[1],r[1])}else"none"==e.value||""==t.info.billing_cycle?(s.kaInvoiceDate="none",s.kaCheckDate="none",s.kaPayDate="none"):(s.kaInvoiceDate=t.info.invoice_date,s.kaCheckDate=t.info.check_date,s.kaPayDate=t.info.pay_date),s.kaInvoiceDate=i.initEditData(s.check_dates,s.kaInvoiceDate),s.kaCheckDate=i.initEditData(s.check_dates,s.kaCheckDate),s.kaPayDate=i.initEditData(s.check_dates,s.kaPayDate)})}),s.$on("setKaMotherParam",function(t,e){e.account_type=void 0==s.kaCustomerType?"":s.kaCustomerType.value,e.billing_cycle=void 0==s.kaBillCycle?"":s.kaBillCycle.value,"half_month"==e.billing_cycle?(e.check_date=s.kaCheckDateHalfMonth[0].last.value+","+s.kaCheckDateHalfMonth[0].next.value,e.invoice_date=s.kaInvoiceDateHalfMonth[0].last.value+","+s.kaInvoiceDateHalfMonth[0].next.value,e.pay_date=s.kaPayDateHalfMonth[0].last.value+","+s.kaPayDateHalfMonth[0].next.value):(e.check_date=void 0==s.kaCheckDate?"":s.kaCheckDate.value,e.invoice_date=void 0==s.kaInvoiceDate?"":s.kaInvoiceDate.value,e.pay_date=void 0==s.kaPayDate?"":s.kaPayDate.value)}),s.$on("setKaChildParam",function(t,e){e.account_type=s.kaCustomerType.value,e.parent_mobile=s.kaParentMobile}),s.info.customer_type&&angular.forEach(s.customerLists,function(t){t.value==s.info.customer_type&&(s.customerModel=t)}),s.shopTypes=t.shop_type,s.shop=function(t){var e,a=parseInt(t),l=s.shopTypes.length;for(e=0;l>e;e++)if(s.shopTypes[e].id===a)return s.shopTypes[e];return null}(t.info.shop_type),s.info.province_id){angular.forEach(s.provinces,function(e){e.id==t.info.province_id&&(s.info.province=e)});var e=[];angular.forEach(s.allLines,function(t){s.info.province_id==t.location_id&&e.push(t)}),s.lines=e}if(s.info.line_id&&angular.forEach(s.lines,function(t){t.id==s.info.line_id&&(s.info.line=t)}),s.info.direction){var a=s.info.direction;angular.forEach(s.directionList,function(t){t.value==a&&(s.info.direction=t)})}if(s.info.dimensions){var l=s.info.dimensions;angular.forEach(s.dimensionList,function(t){t.value==l&&(s.info.dimensions=t)})}}},t)},uploadInit:function(){s.imgUploads=[],s.$watch("files",function(){return alert(s.imgUploads),s.imgUploads&&s.imgUploads.length>=5?void alert("最多允许上传5张图片！"):void(void 0!=s.files&&s.upload("imgUploads","files"))}),s.upload=function(t,e){angular.forEach(s[e],function(t){o.upload({url:"http://img.dachuwang.com/upload?bucket=misc",file:t,fileFormDataName:"files[]"}).progress(function(e){var a=parseInt(100*e.loaded/e.total);t.progressPercentage=a}).success(function(e){alert("已经上传了:"+e.files[0].url),console.log(e.files[0].url),t.dataUrl=e.files[0].url,t.size+="bytes",s.imgUploads.push(t)})})},s.picCancel=function(t){s.imgUploads.splice(t,1)}}};s.getLines=function(){return s.info.province?(s.lines=[],void angular.forEach(s.allLines,function(t){s.info.province&&t.location_id==s.info.province.id&&s.lines.push(t)})):void(s.lines=$scopes.allLines)},s.edit=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var t=0,o=0;t=s.shop.id||0;var i=s.info.dimensions||{value:""},n=s.info.direction||{value:""},r={id:l.id,name:s.info.name,shopType:t,customerType:s.customerModel.value,isLink:o,greens_meat_estimated:s.greens_meat_estimated.value,rice_grain_estimated:s.rice_grain_estimated.value,dimensions:i.value,mobile:s.info.mobile,provinceId:s.info.province.id,lineId:s.info.line.id,address:s.info.address,direction:n.value,shopName:s.info.shop_name,remark:s.info.remark};1==s.kaCustomerType.value?s.$emit("setKaMotherParam",r):2==s.kaCustomerType.value&&s.$emit("setKaChildParam",r),void 0!=s.isCheckSuccess&&(r.is_active=s.isCheckSuccess?1:0),a.getdata("customer/edit","POST",function(t){0==t.status?(e.tips({bodyText:"更新客户资料成功！"}),a.redirect("/customer/list")):e.tips(-1==t.status?{bodyText:t.msg,actionText:"确定",ok:function(){s.kaParentMobile=""}}:{bodyText:"更新客户资料失败。"})},r,!0)}},i.init()}]),angular.module("hop").controller("CustomerCreateCtrl",["$location","dialog","req","$scope",function(t,e,a,s){s.addr={province:""};var l=function(){var t={};a.getdata("customer/create_input","POST",function(t){0==t.status&&(s.info=t.info,s.provinces=t.province_list)},t)};s.get_child=function(){},s.create=function(){var t={id:s.id,siteId:s.info.site_id,name:s.info.name,mobile:s.info.mobile,provinceId:s.addr.province.id,address:s.info.address,shopName:s.info.shop_name,remark:s.info.remark};a.getdata("customer/create","POST",function(t){0==t.status?(e.tips({bodyText:"添加客户资料成功！"}),a.redirect("/customer/list")):e.tips({bodyText:"添加客户资料失败。"})},t)},l()}]),angular.module("hop").controller("ConsultListCtrl",["$location","dialog","req","$scope","$cookieStore","$state","appConfigure",function(t,e,a,s,l,o,i){var n=function(){return{queryListData:function(t){a.getdata("consult/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list||[],s.total=t.total_count)},t)},deleteOrder:function(t,s){e.tips({actionText:"确定",bodyText:"确定删除投诉单吗?",ok:function(){a.getdata("consult/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),s.getList()):e.tips({bodyText:"删除失败！"+t.msg})},{id:t},!0)}})},initGetTypes:function(){a.getdata("/consult/list_options","POST",function(t){s.ctypes=t.ctypes,s.statuses=[{msg:t.statuses.processing.msg,code:t.statuses.processing.code},{msg:t.statuses.finish.msg,code:t.statuses.finish.code}]})}}},r={initCtrl:function(){s.site_url=i.url,s.searchValue="",s.status="-1",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,this.pagerInitSetting(),n().queryListData(),n().initGetTypes()},pagerInitSetting:function(){var t=l.get("paginationCookie");s.getpage=function(){l.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:t,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",this.getList)},"goto":function(t){o.go(t)},open:function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},endOpen:function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0},filterByStatus:function(t){s.status=t,l.remove("consultListCookie"),l.put("consultListCookie",s.status),s.paginationConf.currentPage=1,this.getList()},checkAll:function(){angular.forEach(s.list,function(t){t.checked=s.check_all})},"delete":function(t){n().deleteOrder(t,this)},initParam:function(){s.status="-1",s.excuteStatusType="",s.consultStatusType="",s.searchValue="",s.startTime="",s.endTime=""},reset:function(){this.initParam(),this.getList()},getList:function(){var t=s.consultStatusType||{code:0},e={searchValue:s.searchValue,ctype:t.code,status:s.status,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};n().queryListData(e)},search:function(){this.getList()},"export":function(){var t=[],a="";return angular.forEach(s.list,function(e){e.checked&&(t.push(e.id),a+=e.id+",")}),t&&t.length<=0?void e.tips({bodyText:"请选择要导出的投诉单！"}):void e.tips({actionText:"确定",bodyText:"确定导出选中咨询单吗?",ok:function(){window.location.href=s.site_url+"/consult/export?ids="+a}})},exportAll:function(){e.tips({actionText:"确定",bodyText:"确定导出全部咨询单吗?",ok:function(){window.location.href=s.site_url+"/consult/export"}})}};r.initCtrl(),s.func=r}]).filter("filterStatus",function(){return function(t,e){var a="未知";return angular.forEach(e,function(e){t==e.code&&(a=e.msg)}),a}}),angular.module("hop").controller("ConsultEditCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams","$state",function(t,e,a,s,l,o,i,n){var r=function(){return{getInfo:function(t){a.getdata("consult/edit_input","POST",function(e){0==e.status&&(s.order=e.info,s.ctypes=e.ctypes,s.sources=e.sources,s.statues=e.statues,s.channnels=e.channnels,t.initSelect())},{id:s.id})},edit:function(e){a.getdata("/consult/edit","POST",function(e){0==e.status?(t.tips({bodyText:"修改咨询单成功！"}),a.redirect("/consult/list")):t.tips({bodyText:"修改咨询单失败。"})},e,!0)}}},c={edit:function(){if(s.show_error=!0,s.basic_form.$setDirty(),s.basic_form.$invalid)return void(s.order.validaContact=""==s.order.mobile&&""==s.order.qq&&""==s.order.wechat?"1":"0");if(""==s.order.mobile&&""==s.order.qq&&""==s.order.wechat)return void(s.order.validaContact="1");s.order.validaContact="0";var e=-1;void 0!=s.channelType&&(e=s.channelType.code),s.order.content.length>100&&t.tips({bodyText:"咨询内容长度不能超过100",actionText:"确定"});var a={id:s.id,ctype:s.cType.code,source:s.sourceType.code,name:s.order.name,mobile:s.order.mobile,qq:s.order.qq,wechat:s.order.wechat,channel:e,companyName:s.order.company_name,companyArea:s.order.company_area,companyAddress:s.order.company_address,content:s.order.content,solution:s.order.solution,status:s.statusType.code};r().edit(a)},cancel:function(){t.tips({bodyText:"确定要取消吗?",actionText:"确定",ok:function(){a.redirect("/consult/list")}})},initParam:function(){s.id=n.id,s.sourceType=0,s.statusType=0,s.channelType=0,s.cType=0},initCtrl:function(){this.initParam(),r().getInfo(this)},initSelect:function(){angular.forEach(s.sources,function(t,e){s.order.source==t.code&&(s.sourceType=s.sources[e])}),angular.forEach(s.statues,function(t,e){s.order.status==t.code&&(s.statusType=s.statues[e])}),angular.forEach(s.channnels,function(t,e){s.order.channel==t.code&&(s.channelType=s.channnels[e])}),angular.forEach(s.ctypes,function(t,e){s.order.ctype==t.code&&(s.cType=s.ctypes[e])})}};c.initCtrl(),s.dialog=t.tips,s.func=c}]),angular.module("hop").controller("ConsultCreateCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams","$state",function(t,e,a,s){var l=function(){return{initGetInfo:function(){a.getdata("consult/create_input","POST",function(t){0==t.status&&(s.ctypes=t.ctypes,s.sources=t.sources,s.statues=t.statues,s.channnels=t.channnels,s.data={},s.data.status_type=s.statues[0])},{id:s.id})},add:function(e){a.getdata("/consult/create","POST",function(e){0==e.status?(t.tips({bodyText:"添加咨询单成功！"}),a.redirect("/consult/list")):t.tips({bodyText:"添加咨询单失败。"})},e,!0)}}},o={add:function(){if(s.show_error=!0,s.basic_form.$setDirty(),s.basic_form.$invalid)return void(s.data.validaContact=void 0!=s.data.mobile&&""!=s.data.mobile||void 0!=s.data.qq&&""!=s.data.qq||void 0!=s.data.wechat&&""!=s.data.wechat?"0":"1");if(!(void 0!=s.data.mobile&&""!=s.data.mobile||void 0!=s.data.qq&&""!=s.data.qq||void 0!=s.data.wechat&&""!=s.data.wechat))return void(s.data.validaContact="1");s.data.validaContact="0";var e=-1;void 0!=s.data.channel_type&&(e=s.data.channel_type.code),s.data.content.length>100&&t.tips({bodyText:"咨询内容长度不能超过100",actionText:"确定"});var a={ctype:s.data.c_type.code,source:s.data.source_type.code,name:s.data.name,mobile:s.data.mobile,qq:s.data.qq,wechat:s.data.wechat,channel:e,companyName:s.data.company_name,companyArea:s.data.company_area,companyAddress:s.data.company_address,content:s.data.content,solution:s.data.solution,status:s.data.status_type.code};l().add(a)},cancel:function(){t.tips({bodyText:"确定要取消吗?",actionText:"确定",ok:function(){a.redirect("/consult/list")}})},initParam:function(){var t={name:"",mobile:"",qq:"",wechat:"",content:"",company_name:"",company_area:"",company_address:"",solution:"",source_type:-1,status_type:-1,channel_type:-1,c_type:-1};s.data=t},initCtrl:function(){this.initParam(),l().initGetInfo()}};o.initCtrl(),s.dialog=t.tips,s.func=o}]),angular.module("hop").controller("ComplaintListOrderCtrl",["$location","dialog","req","$scope","$cookieStore",function(t,e,a,s,l){s.status="-1",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0};var o=function(){a.getdata("complaint/list_options","POST",function(t){0==t.status&&(s.cityList=t.cities,s.siteList=t.sites)})};o();var i=function(){var t=s.site||{id:0},e=s.city||{id:0},l={cityId:e.id,site_src:t.id,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("complaint/list_order","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total_count,s.list=t.orderlist,s.total=t.total)},l)},n=l.get("paginationCookie");s.getpage=function(){l.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:n,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",i),s.search=function(){i()},s.filterByStatus=function(){s.searchValue="",s.paginationConf.currentPage=1,i()},s.reset=function(){s.searchValue="",s.startTime="",s.endTime="",i()}}]),angular.module("hop").controller("ComplaintListCtrl",["$location","dialog","req","$scope","$cookieStore","$state","appConfigure",function(t,e,a,s,l,o,i){s.site_url=i.url,s.status="-1",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0};var n=function(){a.getdata("complaint/list_options","POST",function(t){0==t.status&&(s.lineListAll=t.list,s.cityList=t.cities,s.siteList=t.sites,s.ctypeList=t.ctypes)})};n();var r=function(){var t=s.ctype||{code:0},e=s.site||{id:0},l=s.city||{id:0},o=s.line||{id:0},i={status:s.status,searchValue:s.searchValue,ctype:t.code,cityId:l.id,siteId:e.id,lineId:o.id,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("complaint/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list,s.total=t.total)},i)},c=l.get("paginationCookie");s.getpage=function(){l.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:c,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",r),s.switchCity=function(){return s.site||s.city?(s.lineList=[],void angular.forEach(s.lineListAll,function(t){var e=!0;s.site&&t.site_src!=s.site.id&&(e=!1),s.city&&t.location_id!=s.city.id&&(e=!1),e&&s.lineList.push(t)})):void(s.lineList=s.lineListAll)},s.search=function(){r()},s.filterByStatus=function(t){s.status=t,l.remove("complaintListCookie"),s.searchValue="",l.put("complaintListTabCookie",s.status),s.paginationConf.currentPage=1,r()},s.create=function(){o.go("home.complaintListOrder")},s.reset=function(){s.otype="",s.site="",s.city="",s.line="",s.searchValue="",s.startTime="",s.endTime="",r()},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除投诉单吗?",ok:function(){a.getdata("complaint/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),r()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id},!0)}})},s.export=function(){var t=[],a="";return angular.forEach(s.list,function(e){e.checked&&(t.push(e.id),a+=e.id+",")}),t&&t.length<=0?void e.tips({bodyText:"请选择要导出的投诉单！"}):void e.tips({actionText:"确定",bodyText:"确定导出选中投诉单吗?",ok:function(){window.location.href=s.site_url+"/complaint/export?ids="+a}})},s.exportAll=function(){e.tips({actionText:"确定",bodyText:"确定导出全部投诉单吗?",ok:function(){window.location.href=s.site_url+"/complaint/export"}})},s.checkAll=function(){angular.forEach(s.list,function(t){t.checked=s.check_all})}}]),angular.module("hop").controller("ComplaintEditCtrl",["dialog","$location","$upload","daChuLocal","req","$scope","$modal","$window","$cookieStore","$stateParams","$state",function(t,e,a,s,l,o,i,n,r,c){o.id=c.id,o.deal_price={};var d=function(){l.getdata("complaint/edit_input","POST",function(t){0==t.status&&(o.order=t.order,o.data=t.info,o.contents=[],o.imgUploads=t.info.images,o.ctypeList=t.ctypes,o.feedbackList=t.feedbacks,o.statusList=t.statuses,o.saleList=t.sales,o.logisticsList=t.logistics,o.sourceList=t.sources,angular.forEach(t.info.contents,function(e){angular.forEach(t.order.detail,function(t){t.id==e.product_id&&(t.single_price=e.single_price,o.contents.push({product:t,quantity:e.quantity,sumPrice:e.sum_price,price:e.price}))})}),angular.forEach(o.feedbackList,function(t){t.code==o.data.feedback&&(o.data.feedback=t)}),angular.forEach(o.ctypeList,function(t){t.code==o.data.ctype&&(o.data.ctype=t)}),angular.forEach(o.saleList,function(t){t.id==o.data.sale_id&&(o.data.sale=t)}),angular.forEach(o.logisticsList,function(t){t.id==o.data.logistics_id&&(o.data.logistics=t)}),angular.forEach(o.statusList,function(t){t.code==o.data.status&&(o.data.status=t)}),angular.forEach(o.sourceList,function(t){t.code==o.data.source&&(o.data.source=t)}))},{id:o.id})};d(),o.back=function(){history.go(-1)},o.addContent=function(){return o.contents.length>=o.order.detail.length?void alert("投诉单内容产品数量不能超过"+o.order.detail.length+"个"):void o.contents.push({product:{},quantity:1,sumPrice:0})},o.removeContent=function(t){o.contents.splice(t,1),o.calcProduct()},o.changeProduct=function(t){var e=o.contents[t],a=e.product||{id:0};if(e.product){var s=parseInt(e.product.quantity*e.product.price/e.product.single_price*100)/100;e.quantity>s&&(e.quantity=s)}angular.forEach(o.contents,function(e,s){return s!=t&&e.product.id==a.id?(alert("投诉单内容中不能选择重复的产品！请重新选择"),void(o.contents[t]={product:{},quantity:1,sumPrice:0})):void 0}),o.calcProduct()},o.backUpNum={},o.clearNum=function(t){var e=t.product||{id:0};o.backUpNum[e.id]=t.quantity,t.quantity="",o.calcProduct()},o.setNum=function(t,e){var a=t.product||{id:0};if(0==a.id)return void(t.quantity=1);var s=parseInt(t.product.quantity*t.product.price/t.product.single_price*100)/100;t.quantity>s&&(t.quantity=s),e=e?e:!1,e&&""===t.quantity&&o.backUpNum[a.id]&&(t.quantity=o.backUpNum[a.id],o.backUpNum[a.id]=""),null!=t.quantity&&t.quantity<=0?t.quantity=0:(null!=t.quantity||e)&&(t.quantity<=0?o.remove(t):/^\d+\.?\d*$/.test(t.quantity)||(t.quantity=1)),o.calcProduct()},o.calcProduct=function(t){if(t){var e=parseInt(t.product.quantity*t.product.price/t.product.single_price);t.quantity>e&&(t.quantity=e)}var a=0;angular.forEach(o.contents,function(t){t.product&&t.product.id&&(t.sumPrice=parseInt(t.product.single_price*t.quantity*100)/100,a+=t.sumPrice)}),o.data.total_price=parseInt(100*a)/100},o.edit=function(){if(o.show_error=!0,o.basic_form.$setDirty(),!o.basic_form.$invalid){var e=o.data.feedback||{code:0},a=o.data.source||{code:0},s=o.data.ctype||{code:0},i=o.data.sale||{id:0},n=o.data.logistics||{id:0},r=o.data.status||{code:0},c=!1;if(angular.forEach(o.contents,function(t){return t&&t.product&&t.product.id?void 0:void(c=!0)}),c)return void alert("请选择投诉单内容！");var d={id:o.data.id,orderNumber:o.data.order_number,source:a.code,feedback:e.code,ctype:s.code,contents:o.contents,description:o.data.description,imgUploads:o.imgUploads,suggest:o.data.suggest,progress1:o.data.progress1,saleId:i.id,progress2:o.data.progress2,logisticsId:n.id,progress3:o.data.progress3,solution:o.data.solution,status:r.code};l.getdata("/complaint/edit","POST",function(e){0==e.status?(t.tips({bodyText:"修改投诉单成功！"}),l.redirect("/complaint/list")):t.tips({bodyText:"修改投诉单失败。"})},d,!0)}},o.dialog=t.tips,o.$watch("files",function(){return console.log(o.imgUploads),o.imgUploads&&o.imgUploads.length>=5?void alert("最多允许上传5张图片！"):void(void 0!=o.files&&o.upload("imgUploads","files"))}),o.upload=function(t,e){angular.forEach(o[e],function(t){a.upload({url:"http://img.dachuwang.com/upload?bucket=misc",file:t,fileFormDataName:"files[]"}).progress(function(e){var a=parseInt(100*e.loaded/e.total);t.progressPercentage=a}).success(function(e){t.dataUrl=e.files[0].url,t.size+="bytes",o.imgUploads.push(t)})})},o.picCancel=function(t){o.imgUploads.splice(t,1)}}]),angular.module("hop").controller("ComplaintDetailCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams","$state",function(t,e,a,s,l,o,i,n,r){s.data="",s.deal_price={},s.order_number=n.order_number;var c=function(){a.getdata("complaint/order_info","POST",function(t){0==t.status&&(s.data=t.info,s.deal_price.key=t.info.total_price)},{order_number:s.order_number})};c(),s.back=function(){history.go(-1)},s.create=function(t){r.go("home.complaintCreate",{order_number:t})},s.dialog=t.tips}]),angular.module("hop").controller("ComplaintCreateCtrl",["dialog","$location","$upload","daChuLocal","req","$scope","$modal","$window","$cookieStore","$stateParams","$state",function(t,e,a,s,l,o,i,n,r,c){o.data="",o.deal_price={},o.order_number=c.order_number;var d=function(){l.getdata("complaint/create_input","POST",function(t){0==t.status&&(o.data=t.info,o.ctypeList=t.ctypes,o.feedbackList=t.feedbacks,o.statusList=t.statuses,o.saleList=t.sales,o.logisticsList=t.logistics,o.sourceList=t.sources,o.data.status=o.statusList[0])},{order_number:o.order_number}),o.contents=[{product:{},quantity:1,sumPrice:0}]};d(),o.back=function(){history.go(-1)},o.addContent=function(){return o.contents.length>=o.data.detail.length?void alert("投诉单内容产品数量不能超过"+o.data.detail.length+"个"):void o.contents.push({product:{},quantity:1,sumPrice:0})},o.removeContent=function(t){o.contents.splice(t,1),o.calcProduct()},o.changeProduct=function(t){var e=o.contents[t],a=e.product||{id:0};if(e.product){var s=parseInt(e.product.quantity*e.product.price/e.product.single_price);e.quantity>s&&(e.quantity=s)}angular.forEach(o.contents,function(e,s){return s!=t&&e.product.id==a.id?(alert("投诉单内容中不能选择重复的产品！请重新选择"),void(o.contents[t]={product:{},quantity:1,sumPrice:0})):void 0}),o.calcProduct()},o.backUpNum={},o.clearNum=function(t){var e=t.product||{id:0};o.backUpNum[e.id]=t.quantity,t.quantity="",o.calcProduct()},o.setNum=function(t,e){var a=t.product||{id:0};if(0==a.id)return void(t.quantity=1);var s=parseInt(t.product.quantity*t.product.price/t.product.single_price*100)/100;t.quantity>s&&(t.quantity=s),e=e?e:!1,e&&""===t.quantity&&o.backUpNum[a.id]&&(t.quantity=o.backUpNum[a.id],o.backUpNum[a.id]=""),null!=t.quantity&&t.quantity<=0?t.quantity=0:(null!=t.quantity||e)&&(t.quantity<=0?o.remove(t):/^\d+\.?\d*$/.test(t.quantity)||(t.quantity=1)),o.calcProduct()},o.calcProduct=function(t){if(t){var e=parseInt(t.product.quantity*t.product.price/t.product.single_price*100)/100;t.quantity>e&&(t.quantity=e)}var a=0;angular.forEach(o.contents,function(t){t.product&&t.product.id&&(t.sumPrice=parseInt(t.product.single_price*t.quantity*100)/100,a+=t.sumPrice)}),o.totalPrice=parseInt(100*a)/100},o.create=function(){if(o.show_error=!0,o.basic_form.$setDirty(),!o.basic_form.$invalid){var e=o.data.feedback||{code:0},a=o.data.source||{code:0},s=o.data.ctype||{code:0},i=o.data.sale||{id:0},n=o.data.logistics||{id:0},r=o.data.status||{code:0},c=o.imgUploads||[],d=!1;if(angular.forEach(o.contents,function(t){return t&&t.product&&t.product.id?void 0:void(d=!0)}),d)return void alert("请选择投诉单内容！");var m={orderNumber:o.data.order_number,source:a.code,feedback:e.code,ctype:s.code,contents:o.contents,totalPrice:o.totalPrice,description:o.data.description,imgUploads:c,suggest:o.data.suggest,progress1:o.data.progress1,saleId:i.id,progress2:o.data.progress2,logisticsId:n.id,progress3:o.data.progress3,solution:o.data.solution,status:r.code};l.getdata("/complaint/create","POST",function(e){0==e.status?(t.tips({bodyText:"添加投诉单成功！"}),l.redirect("/complaint/list")):t.tips({bodyText:"添加投诉单失败。"})},m,!0)}},o.dialog=t.tips,o.$watch("files",function(){return o.imgUploads&&o.imgUploads.length>=5?void alert("最多允许上传5张图片！"):void(void 0!=o.files&&o.upload("imgUploads","files"))});var m=[];o.upload=function(t,e){angular.forEach(o[e],function(e){a.upload({url:"http://img.dachuwang.com/upload?bucket=misc",file:e,fileFormDataName:"files[]"}).progress(function(t){var a=parseInt(100*t.loaded/t.total);e.progressPercentage=a}).success(function(a){e.dataUrl=a.files[0].url,e.size+="bytes",m.push(e),o[t]=m,s.set(t,o[t])})})},o.picCancel=function(t){o.imgUploads.splice(t,1)}}]),angular.module("hop").controller("WeixinpayCtrl",["$scope","$cookieStore","req","daChuConfig",function(t,e,a,s){t.pay_status="all",t.payExportUrl=s.url.paylist_export,t.dateOptions={formatYear:"yy",startingDay:1},t.endDateOptions={formatYear:"yy",startingDay:1},t.endOpened=t.opened=!1,t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.endOpen=function(e){e.preventDefault(),e.stopPropagation(),t.endOpened=!0
};var l={all:"count_all",0:"count_waitting",1:"count_success","-1":"count_failed"},o=function(){a.getdata("order/list_options","POST",function(e){0==e.status&&(t.cityList=e.cities,t.siteList=e.sites)})};o();var i=function(){var s=e.get("orderlistCookie")||"";t.searchValue=s;var o=e.get("orderlistTabCookie")||"";t.status=o;var i=t.site||{id:0},n=t.city||{id:0},r=parseInt(t.pay_status);isNaN(r)&&(r=t.pay_status);var c={pay_type:1,pay_status:r,site_src:i.id,cityId:n.id,searchValue:t.searchValue,startTime:t.startTime,endTime:t.endTime,currentPage:t.paginationConf.currentPage,itemsPerPage:t.paginationConf.itemsPerPage};a.getdata("order/lists_online_pay","POST",function(e){0==e.status&&(t.paginationConf.totalItems=e.count[l[t.pay_status]].total,t.list=e.data,t.total=e.count)},c)},n=e.get("paginationCookie");t.getpage=function(){e.put("paginationCookie",t.paginationConf.currentPage)},t.paginationConf={currentPage:n,itemsPerPage:15},t.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",i),t.search=function(){e.put("orderlistCookie",t.searchValue),i()},t.filterByStatus=function(a){t.pay_status=a,e.remove("orderlistCookie"),t.searchValue="",e.put("orderlistTabCookie",t.pay_status),t.paginationConf.currentPage=1,i()},t.reset=function(){e.remove("orderlistCookie"),t.searchValue="",t.startTime="",t.endTime="",i()}}]),angular.module("hop").controller("AbnormalListOrderCtrl",["$location","dialog","req","$scope","$cookieStore",function(t,e,a,s,l){s.status="-1",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0};var o=function(){a.getdata("order/list_options","POST",function(t){0==t.status&&(s.cityList=t.cities,s.siteList=t.sites)})};o();var i=function(){var t=s.site||{id:0},e=s.city||{id:0},l={cityId:e.id,site_src:t.id,searchValue:s.searchValue,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("abnormal_order/list_order","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total_count,s.list=t.orderlist,s.total=t.total)},l)},n=l.get("paginationCookie");s.getpage=function(){l.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:n,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",i),s.search=function(){i()},s.filterByStatus=function(){s.searchValue="",s.paginationConf.currentPage=1,i()},s.reset=function(){s.searchValue="",s.startTime="",s.endTime="",i()}}]),angular.module("hop").controller("AbnormalOrderListCtrl",["$location","dialog","req","$scope","$cookieStore","$state","appConfigure",function(t,e,a,s,l,o,i){s.site_url=i.url,s.status="-1",s.dateOptions={formatYear:"yy",startingDay:1},s.endDateOptions={formatYear:"yy",startingDay:1},s.endOpened=s.opened=!1,s.open=function(t){t.preventDefault(),t.stopPropagation(),s.opened=!0},s.endOpen=function(t){t.preventDefault(),t.stopPropagation(),s.endOpened=!0};var n=function(){a.getdata("abnormal_order/list_options","POST",function(t){0==t.status&&(s.lineListAll=t.list,s.cityList=t.cities,s.siteList=t.sites,s.otypeList=t.otypes)})};n();var r=function(){var t=s.otype||{val:0},e=s.site||{id:0},l=s.city||{id:0},o=s.line||{id:0},i={status:s.status,searchValue:s.searchValue,otype:t.val,cityId:l.id,siteId:e.id,lineId:o.id,startTime:Date.parse(s.startTime),endTime:Date.parse(s.endTime),currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage};a.getdata("abnormal_order/lists","POST",function(t){0==t.status&&(s.paginationConf.totalItems=t.total,s.list=t.list,s.total=t.total)},i)},c=l.get("paginationCookie");s.getpage=function(){l.put("paginationCookie",s.paginationConf.currentPage)},s.paginationConf={currentPage:c,itemsPerPage:15},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",r),s.switchCity=function(){return s.site||s.city?(s.lineList=[],void angular.forEach(s.lineListAll,function(t){var e=!0;s.site&&t.site_src!=s.site.id&&(e=!1),s.city&&t.location_id!=s.city.id&&(e=!1),e&&s.lineList.push(t)})):void(s.lineList=s.lineListAll)},s.search=function(){r()},s.filterByStatus=function(t){s.status=t,s.searchValue="",s.paginationConf.currentPage=1,r()},s.create=function(){o.go("home.abnormalListOrder")},s.reset=function(){s.otype="",s.site="",s.city="",s.line="",s.searchValue="",s.startTime="",s.endTime="",r()},s.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除异常单吗?",ok:function(){a.getdata("abnormal_order/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),r()):e.tips({bodyText:"删除失败！"+t.msg})},{id:s.list[t].id},!0)}})},s.export=function(){var t=[],a="";return angular.forEach(s.list,function(e){e.checked&&(t.push(e.id),a+=e.id+",")}),t&&t.length<=0?void e.tips({bodyText:"请选择要导出的异常单！"}):void e.tips({actionText:"确定",bodyText:"确定导出选中异常单吗?",ok:function(){window.location.href=s.site_url+"/abnormal_order/export?ids="+a}})},s.exportAll=function(){e.tips({actionText:"确定",bodyText:"确定导出全部异常单吗?",ok:function(){window.location.href=s.site_url+"/abnormal_order/export"}})},s.checkAll=function(){angular.forEach(s.list,function(t){t.checked=s.check_all})}}]),angular.module("hop").controller("AbnormalOrderEditCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams","$state",function(t,e,a,s,l,o,i,n){s.id=n.id,s.contents=[];var r=function(){a.getdata("abnormal_order/edit_input","POST",function(t){0==t.status&&(s.order=t.order,s.data=t.info,s.otypes=t.otypes,s.statusList=t.statuses,angular.forEach(s.otypes,function(t){t.val==s.data.otype&&(s.data.otype=t)}),angular.forEach(s.statusList,function(t){t.code==s.data.status&&(s.data.status=t)}),angular.forEach(t.info.contents,function(e){angular.forEach(t.order.detail,function(t){t.id==e.product_id&&s.contents.push({product:t})})}))},{id:s.id})};r(),s.back=function(){history.go(-1)},s.addContent=function(){return s.contents.length>=s.order.detail.length?void alert("异常单内容产品数量不能超过"+s.order.detail.length+"个"):void s.contents.push({product:{}})},s.removeContent=function(t){s.contents.splice(t,1)},s.changeProduct=function(t){var e=s.contents[t],a=e.product||{id:0};angular.forEach(s.contents,function(e,l){return l!=t&&e.product.id==a.id?(alert("异常单内容中不能选择重复的产品！请重新选择"),void(s.contents[t]={product:{},quantity:1,sumPrice:0})):void 0})},s.edit=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var e=!1;if(angular.forEach(s.contents,function(t){return t&&t.product&&t.product.id?void 0:void(e=!0)}),e)return void alert("请选择投诉单内容！");var l={id:s.id,otype:s.data.otype.val,contents:s.contents,reason:s.data.reason,solution:s.data.solution,suggest:s.data.suggest,status:s.data.status.code};a.getdata("/abnormal_order/edit","POST",function(e){0==e.status?(t.tips({bodyText:"修改异常单成功！"}),a.redirect("/abnormal_order/list")):t.tips({bodyText:"修改异常单失败。"})},l,!0)}},s.dialog=t.tips}]),angular.module("hop").controller("AbnormalOrderDetailCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams","$state",function(t,e,a,s,l,o,i,n,r){s.data="",s.deal_price={},s.order_number=n.order_number;var c=function(){a.getdata("abnormal_order/order_info","POST",function(t){if(0==t.status){s.data=t.info,s.deal_price.key=t.info.total_price,s.dates=t.deliver_time,s.deliver_date=s.dates[0];var e=new Date,a=e.getHours();s.deliver_flag=!1,23>a&&(2==s.data.status||3==s.data.status)&&(s.deliver_flag=!0)}},{order_number:s.order_number})};c(),s.back=function(){history.go(-1)},s.create=function(t){r.go("home.abnormalOrderCreate",{order_number:t})},s.dialog=t.tips}]),angular.module("hop").controller("AbnormalOrderCreateCtrl",["dialog","$location","req","$scope","$modal","$window","$cookieStore","$stateParams","$state",function(t,e,a,s,l,o,i,n){s.data="",s.deal_price={},s.order_number=n.order_number;var r=function(){a.getdata("abnormal_order/create_input","POST",function(t){0==t.status&&(s.data=t.info,s.otypes=t.otypes,s.statusList=t.statuses,s.data.status=s.statusList[0])},{order_number:s.order_number}),s.contents=[{product:{}}]};r(),s.back=function(){history.go(-1)},s.addContent=function(){return s.contents.length>=s.data.detail.length?void alert("异常单内容产品数量不能超过"+s.data.detail.length+"个"):void s.contents.push({product:{},quantity:1,sumPrice:0})},s.removeContent=function(t){s.contents.splice(t,1)},s.changeProduct=function(t){var e=s.contents[t],a=e.product||{id:0};angular.forEach(s.contents,function(e,l){return l!=t&&e.product.id==a.id?(alert("异常单内容中不能选择重复的产品！请重新选择"),void(s.contents[t]={product:{},quantity:1,sumPrice:0})):void 0})},s.create=function(){if(s.show_error=!0,s.basic_form.$setDirty(),!s.basic_form.$invalid){var e=!1;if(angular.forEach(s.contents,function(t){return t&&t.product&&t.product.id?void 0:void(e=!0)}),e)return void alert("请选择异常单内容！");var l={orderNumber:s.order_number,otype:s.data.otype.val,contents:s.contents,reason:s.data.reason,solution:s.data.solution,suggest:s.data.suggest,status:s.data.status.code};a.getdata("/abnormal_order/create","POST",function(e){0==e.status?(t.tips({bodyText:"添加异常单成功！"}),a.redirect("/abnormal_order/list")):t.tips({bodyText:"添加异常单失败。"})},l,!0)}},s.dialog=t.tips}]),angular.module("hop").controller("TopCtrl",["$scope","$cookieStore","$location","HopAuth",function(t,e,a,s){if(t.currentUrl=a.$$url.split("_")[0],t.status={isopen:!1},s.auth(),t.isLogin=s.isLogin,t.title="大厨网运营支撑平台",t.isLogin){var l=e.get("type");100===parseInt(l)?t.userInfo="超级管理员":10==parseInt(l)?t.userInfo="运营":11===parseInt(l)?t.userInfo="财务":103===parseInt(l)&&(t.userInfo="仓管"),t.toggleDropdown=function(e){e.preventDefault(),e.stopPropagation(),t.status.isopen=!t.status.isopen},t.logout=function(){s.logout()},t.changePwd=function(){s.pwd()}}else a.path("/login")}]),angular.module("hop").controller("SidebarCtrl",["$scope","$location","$cookieStore",function(t,e,a){t.currentUrl=e.$$url.split("_")[0],t.selectedItem=null,t.changeUrl=function(e){t.selectedItem=e};var s=parseInt(a.get("type")),l={name:"组织权限管理",val:[{name:"部门列表",val:"home.department"},{name:"用户列表",val:"home.user"}]},o={name:"组织权限管理",val:[{name:"部门列表",val:"home.department"},{name:"用户列表",val:"home.user"},{name:"角色列表",val:"home.role"},{name:"权限列表",val:"home.privilege"}]},i={name:"客户管理",val:[{name:"客户列表",val:"home.customer"},{name:"客户线路管理",val:"home.customerLine"},{name:"客户移交",val:"home.customerTransfer"}]},n={name:"客户管理",val:[{name:"客户线路管理",val:"home.customerLine"}]},r={name:"客户管理",val:[{name:"客户移交",val:"home.customerTransfer"}]},c={name:"线路管理",val:[{name:"线路列表",val:"home.line"}]},d={name:"订单管理",val:[{name:"待审核订单",val:"home.orderAudit"},{name:"待生产子订单",val:"home.suborderDeliver"},{name:"波次浏览",val:"home.wave"},{name:"分拣任务列表",val:"home.pickList"},{name:"配送路线单列表",val:"home.distribution"},{name:"待回款子订单",val:"home.suborderPayment"},{name:"子订单列表",val:"home.suborder"},{name:"订单列表",val:"home.order"}]},m={name:"订单管理",val:[{name:"待生产子订单",val:"home.suborderDeliver"},{name:"待签收子订单",val:"home.suborderSign"},{name:"待回款子订单",val:"home.suborderPayment"},{name:"子订单列表",val:"home.suborder"},{name:"订单列表",val:"home.order"}]},p={name:"客服系统",val:[{name:"异常单管理",val:"home.abnormalOrder"},{name:"投诉单管理",val:"home.complaint"},{name:"咨询单管理",val:"home.consult"}]},u={name:"客服系统",val:[{name:"异常单管理",val:"home.abnormalOrder"}]},g={name:"对账管理",val:[{name:"微信支付管理",val:"home.weixinpay"}]};t.urls=[],10===s?t.urls=[d,p,i,l,g]:103===s?t.urls=[d,u,n,c]:100===s?t.urls=[d,p,i,c,o,g]:11===s?t.urls=[m,g]:15===s?t.urls=[r]:16===s&&(t.urls=[r])}]),angular.module("hop").controller("NavbarCtrl",["$scope","$cookieStore","$location",function(t,e,a){t.currentUrl=a.$$url.split("_")[0],t.status={isopen:!1},t.title="大厨网运营支撑平台"}]),angular.module("hop").factory("daChuTimer",function(){var t={getNow:function(){return parseInt((new Date).getTime()/1e3)},cacheTime:30};return{getNow:t.getNow,setCacheTime:function(e){t.cacheTime=parseInt(e)},compare:function(e){var a=this.getNow();return parseInt(e)+t.cacheTime>a?!0:!1}}}),angular.module("hop").factory("rpc",["$http","$q","$location","$cookieStore","appConfigure","daChuLocal",function(t,e,a,s,l,o){return{load:function(a,s,i){var n=this,r=e.defer();return void 0==s&&(s="POST"),t({url:l.url+"/"+a+"?r="+Math.random(),method:s,cache:!1,withCredentials:!0,data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(t){t&&-100===t.status?(o.remove("token"),r.reject("您还未登录，请先登录。"),n.redirect("/user/login",n.refer)):t&&0===t.status?r.resolve(t):r.reject(t&&0!==t.status?t.msg:"请求失败，请检查网络。")}).error(function(t){r.reject(t)}),r.promise},init:a,refer:"/",redirect:function(t,e){return void 0!=e?this.refer=e:""==t&&a.path(this.refer),a.path(t),!1}}}]),angular.module("hop").factory("req",["$http","$location","$cookieStore","appConfigure","$rootScope",function(t,e,a,s,l){var o=(e.$$host,s.url);return{getdata:function(e,s,i,n,r){void 0==s&&(s="POST");var c=this;l.isAjaxLoading=!1,void 0!=r&&"boolean"==typeof r&&(l.isAjaxLoading=!0),t({url:o+"/"+e+"?r="+Math.random(),method:s,cache:!1,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:n}).success(function(t){l.isAjaxLoading=!1,t&&-100===t.status&&(a.remove("id"),a.remove("type"),c.redirect("/user/login")),i(t)})},init:e,refer:"/",redirect:function(t,a){void 0!=a?this.refer=a:""==t&&e.path(this.refer),e.path(t)}}}]),angular.module("hop").factory("pagination",function(){var t={page:1,isProcessing:!1,processingText:"努力加载中...",isDone:!1,more:"点击加载更多",callback:null};return t.nextPage=function(){t.isProcessing||t.isDone||(t.more="正在加载更多...",t.isProcessing=!0,t.page++,t.callback&&t.callback(function(e){e?(t.isDone=!0,t.more="没有更多了"):t.more="点击加载更多",t.isProcessing=!1}))},t.init=function(e){t.page=1,t.isProcessing=!1,t.isDone=!1,t.more="点击加载更多",t.callback=e},t}),angular.module("hop").factory("orderService",["$http","$q","rpc",function(t,e,a){var s=function(t){var e=a.load("/distribution/lists","POST",{dist_ids:t,itemsPerPage:"all"});return e},l=function(t){var e=a.load("/wave/pick_task_list","POST",{pick_ids:t,itemsPerPage:"all"});return e};return{getDistList:s,getPickTaskList:l}}]),angular.module("hop").factory("daChuLocal",function(){var t={get:function(t){var e=localStorage.getItem(t);return e?JSON.parse(e):null},set:function(t,e){localStorage.setItem(t,JSON.stringify(e))},remove:function(t){localStorage.removeItem(t)}};return t}),angular.module("hop").factory("lineRouter",function(){var t={};return t}),angular.module("hop").factory("dialog",["$modal",function(t){var e=function(e,a){var s={headerText:"提示信息",bodyText:"设置成功",closeText:"关闭"},l={templateUrl:"myModalContent.html"};angular.extend(l,a),angular.extend(s,e);t.open({templateUrl:l.templateUrl,controller:"ModalInstanceCtrl",resolve:{items:function(){return s}}})};return{tips:e}}]).controller("ModalInstanceCtrl",["$scope","$modalInstance","items",function(t,e,a){t.items=a,t.selected={item:t.items[0]},t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),angular.module("hop").factory("daChuConfig",["$location",function(t){var e=0,a=1,s={weixin:a,delivery:e},l="http://pay.dachuwang.com/weixin/wxpay/download.php",o=t.$$host;o.indexOf("test4")>0?l="http://pay.test4.dachuwang.com/weixin/wxpay/download.php":o.indexOf("test3")>0?l="http://pay.test3.dachuwang.com/weixin/wxpay/download.php":o.indexOf("test2")>0?l="http://pay.test2.dachuwang.com/weixin/wxpay/download.php":o.indexOf("test")>0&&(l="http://pay.test.dachuwang.com/weixin/wxpay/download.php");var i={paylist_export:l},n={payby:s,url:i};return n}]),angular.module("hop").factory("HopPermit",["req",function(){var t=[100,10,11,12,15,16,103],e={menus:{},checkType:function(e){return-1!==t.indexOf(e)?!0:!1}};return{getPermit:function(t){return e.checkType(t)?!0:!1}}}]).factory("HopAuth",["HopPermit","$cookieStore","req","dialog",function(t,e,a,s){var l={isLogin:!1,getAuth:function(){var a=parseInt(e.get("type"));return t.getPermit(a)?(this.isLogin=!0,!0):(this.isLogin=!1,!1)},changePwd:function(t){var l=this;l.isLogin&&s.tips({headerText:"修改密码",actionText:"修改密码",ok:function(o){return o.newRePassword!=o.newPassword?!1:(angular.isDefined(t)||(t=e.get("id")),a.getdata("user/update_password","POST",function(t){0===parseInt(t.status)?(s.tips({bodyText:t.msg}),l.isLogin=!1,e.remove("type"),e.remove("id"),a.redirect("/user/login")):s.tips({bodyText:t.msg})},o),!1)}},{templateUrl:"password.html"})}};return{isLogin:l.isLogin,auth:l.getAuth,info:{id:e.get("id"),type:e.get("type")},logout:function(){a.getdata("user/logout","GET",function(){e.remove("type"),e.remove("id"),a.redirect("/login")})},pwd:l.changePwd}}]),angular.module("ngLocale",[],["$provide",function(t){var e={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};t.value("$locale",{DATETIME_FORMATS:{AMPMS:["上午","下午"],DAY:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ERANAMES:["公元前","公元"],ERAS:["公元前","公元"],FIRSTDAYOFWEEK:6,MONTH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],SHORTMONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],WEEKENDRANGE:[5,6],fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"y年M月d日 ah:mm:ss",mediumDate:"y年M月d日",mediumTime:"ah:mm:ss","short":"yy/M/d ah:mm",shortDate:"yy/M/d",shortTime:"ah:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"¥",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"¤ -",negSuf:"",posPre:"¤ ",posSuf:""}]},id:"zh-cn",pluralCat:function(){return e.OTHER}})}]),angular.module("dachu.widget.tab",[]).directive("tabs",function(){return{restrict:"E",transclude:!0,scope:{},controller:["$scope",function(t){var e=t.panes=[];t.select=function(t){angular.forEach(e,function(t){t.selected=!1}),t.selected=!0},this.addPane=function(a){0==e.length&&t.select(a),e.push(a)}}],template:'<div class="tabbable"><ul class="nav nav-tabs"><li ng-repeat="pane in panes" style="background:none" ng-class="{active:pane.selected}"><a href="" ng-click="select(pane)">{{pane.title}}</a></li></ul><div class="tab-content" ng-transclude></div></div>',replace:!0}}).directive("pane",function(){return{require:"^tabs",restrict:"E",transclude:!0,scope:{title:"@"},link:function(t,e,a,s){s.addPane(t)},template:'<div class="tab-pane" ng-class="{active: selected}" ng-transclude></div>',replace:!0}}),angular.module("dachu.widget",[]).directive("dachuPagination",[function(){return{restrict:"EA",template:'<div class="page-list"><ul class="pagination" ng-show="conf.totalItems > 0"><li ng-class="{disabled: conf.currentPage == 1}" ng-click="prevPage()"><span>&laquo;</span></li><li ng-repeat="item in pageList track by $index" ng-class="{active: item == conf.currentPage, separate: item == \'...\'}" ng-click="changeCurrentPage(item)"><span>{{ item }}</span></li><li ng-class="{disabled: conf.currentPage == conf.numberOfPages}" ng-click="nextPage()"><span>&raquo;</span></li></ul><div class="page-total" ng-show="conf.totalItems > 0">第<input type="text" ng-model="jumpPageNum"  ng-keyup="jumpToPage($event)"/>页 每页<select ng-model="conf.itemsPerPage" ng-options="option for option in conf.perPageOptions " ng-change="changeItemsPerPage()"></select>/共<strong>{{ conf.totalItems }}</strong>条</div><div class="no-items" ng-show="conf.totalItems <= 0">暂无数据</div></div>',replace:!0,scope:{conf:"="},link:function(t){function e(){t.conf.currentPage=parseInt(t.conf.currentPage)?parseInt(t.conf.currentPage):1,t.conf.totalItems=parseInt(t.conf.totalItems),t.conf.rememberPerPage?(parseInt(localStorage[t.conf.rememberPerPage])||(localStorage[t.conf.rememberPerPage]=parseInt(t.conf.itemsPerPage)?parseInt(t.conf.itemsPerPage):15),t.conf.itemsPerPage=parseInt(localStorage[t.conf.rememberPerPage])):t.conf.itemsPerPage=parseInt(t.conf.itemsPerPage)?parseInt(t.conf.itemsPerPage):15,t.conf.numberOfPages=Math.ceil(t.conf.totalItems/t.conf.itemsPerPage),t.conf.currentPage<1&&(t.conf.currentPage=1),t.conf.currentPage>t.conf.numberOfPages&&(t.conf.currentPage=t.conf.numberOfPages),t.jumpPageNum=t.conf.currentPage;for(var e,a=t.conf.perPageOptions.length,s=0;a>s;s++)parseInt(t.conf.perPageOptions[s])==parseInt(t.conf.itemsPerPage)&&(e=!0);if(e||t.conf.perPageOptions.push(t.conf.itemsPerPage),t.conf.perPageOptions.sort(function(t,e){return t-e}),t.pageList=[],t.conf.numberOfPages<=t.conf.pagesLength)for(s=1;s<=t.conf.numberOfPages;s++)t.pageList.push(s);else{var l=(t.conf.pagesLength-1)/2;if(t.conf.currentPage<=l){for(s=1;l+1>=s;s++)t.pageList.push(s);t.pageList.push("..."),t.pageList.push(t.conf.numberOfPages)}else if(t.conf.currentPage>t.conf.numberOfPages-l){for(t.pageList.push(1),t.pageList.push("..."),s=l+1;s>=1;s--)t.pageList.push(t.conf.numberOfPages-s);t.pageList.push(t.conf.numberOfPages)}else{for(t.pageList.push(1),t.pageList.push("..."),s=Math.ceil(l/2);s>=1;s--)t.pageList.push(t.conf.currentPage-s);for(t.pageList.push(t.conf.currentPage),s=1;l/2>=s;s++)t.pageList.push(t.conf.currentPage+s);t.pageList.push("..."),t.pageList.push(t.conf.numberOfPages)}}t.conf.onChange&&t.conf.onChange(),t.$parent.conf=t.conf}t.changeCurrentPage=function(e){"..."!==e&&(t.conf.currentPage=e)},t.conf.pagesLength=parseInt(t.conf.pagesLength)?parseInt(t.conf.pagesLength):9,t.conf.pagesLength%2===0&&(t.conf.pagesLength=t.conf.pagesLength-1),t.conf.perPageOptions||(t.conf.perPageOptions=[5,10,15,20,30,50]),t.prevPage=function(){t.conf.currentPage>1&&(t.conf.currentPage-=1)},t.nextPage=function(){t.conf.currentPage<t.conf.numberOfPages&&(t.conf.currentPage+=1)},t.jumpToPage=function(){t.jumpPageNum=t.jumpPageNum.replace(/[^0-9]/g,""),""!==t.jumpPageNum&&(t.conf.currentPage=t.jumpPageNum)},t.changeItemsPerPage=function(){t.conf.rememberPerPage&&localStorage.removeItem(t.conf.rememberPerPage)},t.$watch(function(){var e=t.conf.currentPage+" "+t.conf.totalItems+" ";return e+=t.conf.rememberPerPage&&localStorage[t.conf.rememberPerPage]?localStorage[t.conf.rememberPerPage]:t.conf.itemsPerPage},e)}}}]),angular.module("hop").directive("map",["req","dialog",function(t,e){return{restrict:"A",link:function(a){function s(){n=new AMap.Map("mapContainer",{level:11})}function l(t,e){var a=document.createElement("div");a.className="info";var s=document.createElement("div"),l=document.createElement("div"),i=document.createElement("img");s.className="info-top",l.innerHTML=t,i.src="http://webapi.amap.com/images/close2.gif",i.onclick=o,s.appendChild(l),s.appendChild(i),a.appendChild(s);var n=document.createElement("div");n.className="info-middle",n.style.backgroundColor="white",n.innerHTML=e,a.appendChild(n);var r=document.createElement("div");r.className="info-bottom",r.style.position="relative",r.style.top="0px",r.style.margin="0 auto";var c=document.createElement("img");return c.src="http://webapi.amap.com/images/sharp.png",r.appendChild(c),a.appendChild(r),a}function o(){n.clearInfoWindow()}function i(){n.clearMap()}var n,r,c=[];s();var d=null;n.plugin(["AMap.ToolBar"],function(){d=new AMap.ToolBar,n.addControl(d)}),n.plugin(["AMap.MapType"],function(){var t=new AMap.MapType({defaultType:0});n.addControl(t)}),a.markList=[],a.geolist=[],a._initmark=function(t,s){function o(){g&&"success"!==t?(r=new AMap.Marker({map:n,title:s[p].shop_name,position:v,content:'<div class="mapIcon"  style="background:url(assets/images/will.png); width:45px; height:38px;text-align: right; padding-right: 5px;">'+s[p].id+"</div>",offset:{x:-8,y:-34}}),r.hide()):g||"waiting"===t||(r=new AMap.Marker({map:n,title:s[p].shop_name,clickable:!1,position:v,content:'<div class="mapIcon"  style="background:url(assets/images/ed.png); width:45px; height:38px;text-align: right; padding-right: 5px;">'+s[p].id+"</div>",offset:{x:-8,y:-34}}),r.hide()),"hideMarker"==h&&r.show(),a.markList.push(r)}if(a.geolist=[],i(),s.orderlist?a.orderdata.data=s=s.orderlist:s=s,!s.length)return void e.tips({bodyText:"您选择的线路目前没有订单!"});a.orderdata.orderlen=s.length,n.setFitView(a.markList);var d=null,m=a.orderdata.successObj;s=a.orderList;for(var p=0,u=s.length;u>p;p++){var g=!0,h=null;if(""==s[p].geo&&a.geolist.push(s[p].username),s[p].geo){d=JSON.parse(s[p].geo);for(var v=new AMap.LngLat(1*d.lng,1*d.lat),f=0;f<m.length;f++)if(m.length&&s[p].id==m[f])var g=!1;for(var b=0;b<a.orderList.length;b++)a.orderList[b].id==s[p].id&&(h="hideMarker");o(),function(t){AMap.event.addListener(r,"click",function(e){var o=new AMap.InfoWindow({isCustom:!0,content:l("&nbsp;"+s[t].shop_name+'&nbsp;<span style="font-size:11px;">客户:'+s[t].realname+"</span>","地址："+s[t].deliver_addr+"<br/>电话："+s[t].mobile+"<br/>"),offset:new AMap.Pixel(16,-45)});o.open(n,this.getPosition()),a.orderdata.enOrder.push(s[t].id);var i=e.target.getContent().toString().replace(/will/,"will");e.target.setContent(i)})}(p),c.push(r)}}n.setFitView(a.markList)},a.initMarker=function(e,s,l,o,n){return i(),n?void a._initmark(o,n):(t.getdata(e,s,function(t){a.ordersuccess=[],a.alldata=[],angular.forEach(a.orderdata.success,function(t){a.ordersuccess.push(t.id)}),a.alldata=a.ordersuccess.toString().split(","),a.alldata&&angular.forEach(a.alldata,function(e){angular.forEach(t.orderlist,function(t){e==t.id&&(t.ngDisabled=!0,t.isChecked=!0)})}),a.orderList&&angular.forEach(a.orderList,function(e){angular.forEach(t.orderlist,function(t){e.id==t.id&&(t.isChecked=!0)})}),a._initmark(o,t)},l),void(!l.city_id||!l.chosedate||!l.chosetime))}}}}]),angular.module("dachu.widget.blur",[]).directive("ngBlur",["$parse",function(t){return function(e,a,s){var l=t(s.ngBlur);a.bind("blur",function(t){t.preventDefault(),t.stopPropagation(),e.$apply(function(){l(e,{$event:t})})})}}]),angular.module("dachu.widget.imagebox",[]).directive("imageModal",["$compile",function(t){return{require:"^imageBox",restrict:"E",transclude:!0,scope:{url:"@",title:"="},link:function(e,a,s){var l=[];e._count_=0,e.$watch("url",function(){e.showIndex=s.show,e._showIndex_=parseInt(s.show)+1;var o=a.find(".image-placeholder");if(o.children().remove(),"array"==typeof e.url)l=e.url;else if("string"==typeof e.url){if(e.url.indexOf(",")>-1){var i=e.url.split(",");l=i}else l.push(e.url);e._count_=l.length}angular.forEach(l,function(s,l){""!=s&&(o.append(e.showIndex==l?"<img ng-show='showIndex=="+l+"' style='width:400px;height:300px;' src="+s+"  class='show'>":"<img ng-show='showIndex=="+l+"' style='width:400px;height:300px;' src="+s+">"),t(a.contents())(e))})}),e.close=function(){a.parent(".tab-content-image").hide()},e.next=function(){var t=parseInt(s.show)==l.length-1?parseInt(s.show):parseInt(s.show)+1;e.showIndex=t,a.attr("show",t),e._showIndex_=t+1},e.prev=function(){var t=0==parseInt(s.show)?0:parseInt(s.show)-1;e.showIndex=t,a.attr("show",t),e._showIndex_=t+1}},template:'<div style="position:fixed;z-index:1038;left:0;top:0;"><div style="position:fixed;padding:30px;"><div style="position:fixed;margin:15% 0 0 35%;width:420px;height:368px;padding:10px;background:#ddd;left:0;top:0;bottom:0;right:0;"><div class="image-placeholder"></div><div style="width:400px;height:48px;" class="btn-button"><ul style="list-style-type:none;"><li style="float:left;padding:10px 5px;">{{_count_}}/{{ _showIndex_ }}</li><li style="padding:10px 23px;margin:0px 12px;float:left;background:#296ad4;color:white;" ng-click="prev()">上一张</li><li style="padding:10px 23px;margin:0px 12px;float:left;background:#296ad4;color:white;" ng-click="next()">下一张</li><li style="padding:10px 23px;margin:0px 12px;float:left;background:#296ad4;color:white;" ng-click="close()">关闭</li></ul></div></div></div></div>',replace:!0}}]).directive("imageBox",function(){return{restrict:"E",transclude:!0,scope:{url:"@"},link:function(t,e){t.$watch("url",function(){if(""!=t.url){var a=e.find(".image-Box");a.html("<img alt='点击放大' src="+t.url+" style='width:120px;height:120px;'/>")}}),t.open=function(){e.find(".tab-content-image").show()}},controller:["$scope",function(){}],template:'<div><div class="image-Box" ng-click="open()"></div><div style="display:none;" class="tab-content-image" ng-transclude></div></div>',replace:!0}}),angular.module("hop").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,a){var s="app/modules";t.state("home",{url:"/",templateUrl:s+"/home/home.html",controller:"HomeCtrl"}).state("home.department",{url:"department/list",templateUrl:s+"/department/list.html",controller:"DepartmentListCtrl"}).state("home.departmentCreate",{url:"department/create",templateUrl:s+"/department/create.html",controller:"DepartmentCreateCtrl"}).state("home.departmentEdit",{url:"department/edit/{id:[0-9]{1,}}",templateUrl:s+"/department/edit.html",controller:"DepartmentEditCtrl"}).state("home.user",{url:"user/list",templateUrl:s+"/user/list.html",controller:"UserListCtrl"}).state("home.userCreate",{url:"user/create",templateUrl:s+"/user/create.html",controller:"UserCreateCtrl"}).state("home.userEdit",{url:"user/edit/{id:[0-9]{1,}}",templateUrl:s+"/user/edit.html",controller:"UserEditCtrl"}).state("home.userDynamic",{url:"user/dynamic/{id:[0-9]{1,}}",templateUrl:s+"/user/dynamic.html",controller:"UserDynamicCtrl"}).state("home.role",{url:"role/list",templateUrl:s+"/role/list.html",controller:"RoleListCtrl"}).state("home.roleCreate",{url:"role/create",templateUrl:s+"/role/create.html",controller:"RoleCreateCtrl"}).state("home.roleEdit",{url:"role/edit/{id:[0-9]{1,}}",templateUrl:s+"/role/edit.html",controller:"RoleEditCtrl"}).state("home.privilege",{url:"privilege/list",templateUrl:s+"/privilege/list.html",controller:"PrivilegeListCtrl"}).state("home.privilegeCreate",{url:"privilege/create",templateUrl:s+"/privilege/create.html",controller:"PrivilegeCreateCtrl"}).state("home.privilegeEdit",{url:"privilege/edit/{id:[0-9]{1,}}",templateUrl:s+"/privilege/edit.html",controller:"PrivilegeEditCtrl"}).state("home.customer",{url:"customer/list",templateUrl:s+"/customer/list.html",controller:"CustomerListCtrl"}).state("home.customerLine",{url:"customer/list_line",templateUrl:s+"/customer/listLine.html",controller:"CustomerListLineCtrl"}).state("home.customerTransfer",{url:"customer/list_transfer",templateUrl:s+"/customer/newTransfer.html",controller:"CustomerNewTransferCtrl"}).state("home.customerTransferUser",{url:"customer/list_transfer_user/{cids:[0-9,]{1,}}",templateUrl:s+"/customer/listTransferUser.html",controller:"CustomerListTransferUserCtrl"}).state("home.customerEditLine",{url:"customer/edit_line/{id:[0-9]{1,}}",templateUrl:s+"/customer/editLine.html",controller:"CustomerEditLineCtrl"}).state("home.customerCreate",{url:"customer/create",templateUrl:s+"/customer/create.html",controller:"CustomerCreateCtrl"}).state("home.customerEdit",{url:"customer/edit/{id:[0-9]{1,}}",templateUrl:s+"/customer/edit.html",controller:"CustomerEditCtrl"}).state("home.propertyEdit",{url:"property/{id:[0-9]{1,}}",templateUrl:s+"/property/add.html",controller:"PropertyEditCtrl"}).state("home.orderMap",{url:"orderMap/index",templateUrl:s+"/orderMap/index.html",controller:"mapCtrl"}).state("home.propertyAdd",{url:"property/add",templateUrl:s+"/property/add.html",controller:"PropertyAddCtrl"}).state("home.categoryEdit",{url:"category/{id:[0-9]{1,}}",templateUrl:s+"/category/add.html",controller:"CategoryEditCtrl"}).state("home.category",{url:"category",templateUrl:s+"/category/list.html",controller:"CategoryCtrl"}).state("home.editMap",{url:"map/{id:[0-9]{1,}}",templateUrl:s+"/category/map.html",controller:"CateMapEditCtrl"}).state("home.cateMapAdd",{url:"category/map_add",templateUrl:s+"/category/map.html",controller:"CateMapAddCtrl"}).state("home.cateMap",{url:"category/map",templateUrl:s+"/category/map_list.html",controller:"CateMapCtrl"}).state("home.categoryAdd",{url:"category/add",templateUrl:s+"/category/add.html",controller:"CategoryAddCtrl"}).state("home.property",{url:"property",templateUrl:s+"/property/list.html",controller:"PropertyCtrl"}).state("home.product",{url:"product",templateUrl:s+"/product/list.html",controller:"ProductCtrl"}).state("home.productAdd",{url:"product/add",templateUrl:s+"/product/add.html",controller:"ProductAddCtrl"}).state("home.productEdit",{url:"product/{productId:[0-9]{1,}}",templateUrl:s+"/product/add.html",controller:"ProductAddCtrl"}).state("login",{url:"/login",templateUrl:s+"/user/login.html",controller:"LoginCtrl"}).state("home.order",{url:"order/list",templateUrl:s+"/order/list.html",controller:"OrderListCtrl"}).state("home.suborder",{url:"order/sublist",templateUrl:s+"/order/sublist.html",controller:"SuborderListCtrl"}).state("home.wave",{url:"wave",templateUrl:s+"/wave/list.html",controller:"WaveCtrl"}).state("home.pickList",{url:"pick",templateUrl:s+"/pick/list.html",controller:"PickCtrl"}).state("home.waveAdd",{url:"wave/add",templateUrl:s+"/wave/add.html",controller:"WaveAddCtrl"}).state("home.pickTaskDetail",{url:"pick/detail/{task_id:[0-9]{1,}}",templateUrl:s+"/pick/detail.html",controller:"PickTaskDetailCtrl"}).state("home.waveDetail",{url:"wave/detail/{wave_id:[0-9]{1,}}",templateUrl:s+"/wave/detail.html",controller:"WaveDetailCtrl"}).state("home.orderAudit",{url:"order/listAudit",templateUrl:s+"/order/listAudit.html",controller:"OrderAuditCtrl"}).state("home.suborderDeliver",{url:"order/sublistDeliver",templateUrl:s+"/order/sublistDeliver.html",controller:"SuborderDeliverCtrl"}).state("home.suborderSign",{url:"order/sublistSign",templateUrl:s+"/order/sublistSign.html",controller:"SuborderSignCtrl"}).state("home.suborderPayment",{url:"order/sublistPayment",templateUrl:s+"/order/sublistPayment.html",controller:"SuborderPaymentCtrl"}).state("home.suborderDetail",{url:"order/subDetail/{order_number:[0-9]{1,}}",templateUrl:s+"/order/subDetail.html",controller:"SuborderDetailCtrl"}).state("home.orderDetail",{url:"order/detail/{order_number:[0-9]{1,}}",templateUrl:s+"/order/detail.html",controller:"OrderDetailCtrl"}).state("home.abnormalOrder",{url:"abnormal_order/list",templateUrl:s+"/abnormal_order/list.html",controller:"AbnormalOrderListCtrl"}).state("home.abnormalListOrder",{url:"abnormal_order/listOrder",templateUrl:s+"/abnormal_order/listOrder.html",controller:"AbnormalListOrderCtrl"}).state("home.abnormalOrderDetail",{url:"abnormal_order/detail/{order_number:[0-9]{1,}}",templateUrl:s+"/abnormal_order/detail.html",controller:"AbnormalOrderDetailCtrl"}).state("home.abnormalOrderCreate",{url:"abnormal_order/create/{order_number:[0-9]{1,}}",templateUrl:s+"/abnormal_order/create.html",controller:"AbnormalOrderCreateCtrl"}).state("home.abnormalOrderEdit",{url:"abnormal_order/edit/{id:[0-9]{1,}}",templateUrl:s+"/abnormal_order/edit.html",controller:"AbnormalOrderEditCtrl"}).state("home.complaint",{url:"complaint/list",templateUrl:s+"/complaint/list.html",controller:"ComplaintListCtrl"}).state("home.complaintListOrder",{url:"complaint/listOrder",templateUrl:s+"/complaint/listOrder.html",controller:"ComplaintListOrderCtrl"}).state("home.complaintDetail",{url:"complaint/detail/{order_number:[0-9]{1,}}",templateUrl:s+"/complaint/detail.html",controller:"ComplaintDetailCtrl"}).state("home.complaintCreate",{url:"complaint/create/{order_number:[0-9]{1,}}",templateUrl:s+"/complaint/create.html",controller:"ComplaintCreateCtrl"}).state("home.complaintEdit",{url:"complaint/edit/{id:[0-9]{1,}}",templateUrl:s+"/complaint/edit.html",controller:"ComplaintEditCtrl"}).state("home.consult",{url:"consult/list",templateUrl:s+"/consult/list.html",controller:"ConsultListCtrl"}).state("home.consultListOrder",{url:"consult/listOrder",templateUrl:s+"/consult/listOrder.html",controller:"ConsultListOrderCtrl"}).state("home.consultDetail",{url:"consult/detail/{order_number:[0-9]{1,}}",templateUrl:s+"/consult/detail.html",controller:"ConsultDetailCtrl"}).state("home.consultCreate",{url:"consult/create",templateUrl:s+"/consult/create.html",controller:"ConsultCreateCtrl"}).state("home.consultEdit",{url:"consult/edit/{id:[0-9]{1,}}",templateUrl:s+"/consult/edit.html",controller:"ConsultEditCtrl"}).state("home.orderEdit",{url:"order/edit/{order_number:[0-9]{1,}}",templateUrl:s+"/order/edit.html",controller:"OrderEditCtrl"}).state("home.weixinpay",{url:"account/weinxinpay",templateUrl:s+"/account/weixinpay.html",controller:"WeixinpayCtrl"}).state("printpage",{url:"/printpage/{dist_numbers:[0-9A-Z,]{1,}}",templateUrl:s+"/printpage/printpage.html",controller:"PrintController",resolve:{orderService:"orderService",distListInfo:["orderService","$stateParams",function(t,e){return t.getDistList(e.dist_numbers)
}]}}).state("printpicktask",{url:"/print/pickTask/{pick_numbers:[0-9A-Z,]{1,}}",templateUrl:s+"/printpage/printPickTask.html",controller:"PrintPickTaskController",resolve:{orderService:"orderService",pickTaskListInfo:["orderService","$stateParams",function(t,e){return t.getPickTaskList(e.pick_numbers)}]}}).state("home.distribution",{url:"distribution/list",templateUrl:s+"/distribution/list.html",controller:"DistributionListCtrl"}).state("home.distributionDetail",{url:"distribution/detail/{dist_id:[0-9]{1,}}",templateUrl:s+"/distribution/detail.html",controller:"DistributionDetailCtrl"}).state("home.line",{url:"line/list",templateUrl:s+"/line/list.html",controller:"LineListCtrl"}).state("home.lineCreate",{url:"line/create",templateUrl:s+"/line/create.html",controller:"LineCreateCtrl"}).state("home.lineEdit",{url:"line/edit/{id:[0-9]{1,}}",templateUrl:s+"/line/edit.html",controller:"LineEditCtrl"}),e.otherwise("/"),a.html5Mode(!0)}]),angular.module("hop").provider("appConfigure",{$get:["$location",function(t){var e=t.$$host;return e.indexOf("dachuwang")<0&&(e="hop.dachuwang.net"),{url:"http://api."+e}}]}),angular.module("hop").run(["$templateCache",function(t){t.put("components/navbar/navbar.html",'<nav class="navbar navbar-inverse navbar-fixed-top" ng-controller="TopCtrl"><script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 style="word-wrap: break-word">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><script type="text/ng-template" id="password.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <form class="row block block-col form-horizontal" role="form" name="passwordForm"> <div class="form-group col-xs-12"> <label for="password" class="col-sm-2 control-label"> <h5> <b>旧密码</b> </h5> </label> <div class="col-sm-10"> <input type="password" required class="input-lg form-control" ng-model="reg.password" id="password" placeholder="请输入您的旧密码" ng-minlength="6" name="oldpassword"> <div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.oldpassword.$dirty && passwordForm.oldpassword.$invalid"> <small ng-show="passwordForm.oldpassword.$error.minlength">旧密码至少6位</small> <small ng-show="passwordForm.oldpassword.$error.required">旧密码必填</small> </div> </div> </div> <div class="form-group col-xs-12"> <label for="newpassword" class="col-sm-2 control-label"> <h5> <b>新密码</b> </h5> </label> <div class="col-sm-10"> <input type="password" required class="input-lg form-control" ng-model="reg.newPassword" id="newPassword" placeholder="请输入您的新密码" ng-minlength="6" name="password"> <div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.password.$dirty && passwordForm.password.$invalid"> <small ng-show="passwordForm.password.$error.minlength">密码至少6位</small> <small ng-show="passwordForm.password.$error.required">密码必填</small> </div> </div> </div> <div class="form-group col-xs-12"> <label for="newpassword" class="col-sm-2 control-label"> <h5> <b>输入新密码</b> </h5> </label> <div class="col-sm-10"> <input type="password" required class="input-lg form-control" ng-model="reg.newRePassword" id="newRePassword" ng-minlength="6" placeholder="请再次输入您的新密码" name="repassword"> <div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.repassword.$dirty && passwordForm.repassword.$invalid"> <small ng-show="passwordForm.repassword.$error.minlength">确认密码至少6位</small> <small ng-show="passwordForm.repassword.$error.required">确认密码必填</small> </div> <div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.repassword.$dirty && passwordForm.repassword.$valid && reg.newRePassword != reg.newPassword"> <small>两次密码不一致</small> </div> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(reg);cancel()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid" ng-controller="NavbarCtrl"><div class="navbar-header" style="width:100%;"><a style="padding-right:0;" href="javascript:history.back()" class="glyphicon navbar-brand glyphicon-chevron-left"></a> <a href="/" class="navbar-brand">{{title}}</a><div ng-if="isLogin"><ul class="nav navbar-nav navbar-right"><li class="dropdown" dropdown=""><a href="/" class="dropdown-toggle" dropdown-toggle="">{{userInfo}}<span class="caret"></span></a><ul class="dropdown-menu"><li ng-click="changePwd()"><a href="#">修改密码</a></li><li ng-click="logout()"><a href="#">登出</a></li><div class="mobile_menu" ng-controller="SidebarCtrl"><ul ng-repeat="url in urls"><li ng-repeat="item in url.val"><a ng-href="{{item.val}}" ng-class="{\'active\': item.val==currentUrl}" class="nav-li-child">{{item.name}}</a></li></ul></div></ul></li></ul></div></div></div></nav><div class="nav-mt"></div>'),t.put("components/navbar/navsidebar.html",'<div class="col-xs-2 sidebar" ng-controller="SidebarCtrl"><ul class="nav nav-sidebar"><li role="presentation" ng-click="changeUrl(item.val)"><a ng-href="/" ng-class="{\'active\': currentUrl==\'/\'}" class="nav-li">首页</a></li></ul><ul class="nav nav-sidebar" ng-repeat="url in urls"><li><h4 class="nav-li">{{url.name}}</h4></li><li ng-repeat="item in url.val" ng-click="changeUrl(item.val)"><a ui-sref="{{item.val}}" ng-class="{\'active\': item.val===selectedItem}" class="nav-li-child">{{item.name}}</a></li></ul></div>'),t.put("app/modules/sublist.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>订单列表</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'-1\');" ng-class="{\'btn-info\': status == \'-1\'}" class="btn">全部 <span class="badge">{{total[-1]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">待审核 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'3\');" ng-class="{\'btn-info\': status == \'3\'}" class="btn">待生产 <span class="badge">{{total[3]}}</span></a> <a ng-click="filterByStatus(\'11\');" ng-class="{\'btn-info\': status == \'11\'}" class="btn">波次中 <span class="badge">{{total[11]}}</span></a> <a ng-click="filterByStatus(\'12\');" ng-class="{\'btn-info\': status == \'12\'}" class="btn">待分拣 <span class="badge">{{total[12]}}</span></a> <a ng-click="filterByStatus(\'13\');" ng-class="{\'btn-info\': status == \'13\'}" class="btn">已复核 <span class="badge">{{total[13]}}</span></a> <a ng-click="filterByStatus(\'14\');" ng-class="{\'btn-info\': status == \'14\'}" class="btn">已分拨 <span class="badge">{{total[14]}}</span></a> <a ng-click="filterByStatus(\'5\');" ng-class="{\'btn-info\': status == \'5\'}" class="btn">已出库 <span class="badge">{{total[5]}}</span></a> <a ng-click="filterByStatus(\'6\');" ng-class="{\'btn-info\': status == \'6\'}" class="btn">已签收 <span class="badge">{{total[6]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已完成 <span class="badge">{{total[1]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已关闭 <span class="badge">{{total[0]}}</span></a> <a ng-click="filterByStatus(\'7\');" ng-class="{\'btn-info\': status == \'7\'}" class="btn">已退货 <span class="badge">{{total[7]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">订单类别</div><select class="form-control" ng-model="orderType" ng-options="m.msg for m in orderTypeList"><option value="">请选择订单类别</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">所属系统</div><select class="form-control" ng-change="switchCity()" ng-model="site" ng-options="m.name for m in siteList"><option value="">请选择系统</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group" style="margin-left:10px;"><button class="btn btn-block btn-danger" ng-click="confirmZip()">生成出库单</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5>内部编号</h5></td><td class="text-center" width="12%"><h5>订单编号</h5></td><td class="text-center" width="8%"><h5>客户姓名</h5></td><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="15%"><h5>送货地址</h5></td><td class="text-center" width="10%"><h5>送货时间</h5></td><td class="text-center" width="5%"><h5>订单金额</h5></td><td class="text-center" width="5%"><h5>应付金额</h5></td><td class="text-center" width="5%"><h5>订单状态</h5></td><td class="text-center" width="10%"><h5>支付状态</h5></td><td class="text-center" width="5%"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="12" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5><a ng-href="/user/dynamic/{{item.user_id}}">{{item.mobile}}</a></h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5><h5><span class="label label-warning" ng-if="item.deliver_fee > 0">运费{{item.deliver_fee}}元</span></h5><h5><span class="label label-warning" ng-if="item.pay_reduce > 0">支付减免{{item.pay_reduce}}元</span></h5></td><td class="text-center"><h5>{{item.final_price}}</h5></td><td class="text-center"><h5 class="label {{item.class}}">{{item.status_cn}}</h5></td><td class="text-center"><div ng-if="item.pay_type == 1 && item.pay_status == 0"><h5>微信支付</h5><h5 class="label label-warning">未支付</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == 1"><h5>微信支付</h5><h5 class="label label-success">支付成功</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == -1"><h5>微信支付</h5><h5 class="label label-danger">支付失败</h5></div><h5 class="label label-info" ng-if="item.pay_type == 0">货到付款</h5></td><td class="text-center"><h5><a ng-click="getpage()" ng-href="order/detail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/abnormal_order/create.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>新异常单填写</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.otype.$error.required">请选择异常单类型！</li><li ng-show="basic_form.product.$error.required">请选择异常单内容！</li><li ng-show="basic_form.reason.$error.required">请输入异常原因！</li><li ng-show="basic_form.solution.$error.required">请输入处理方案！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">运营组受理人：</label><div class="col-sm-10"><input type="text" name="cur_name" ng-model="data.cur_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所属系统：</label><div class="col-sm-10"><input type="text" name="site_name" ng-model="data.site_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地区：</label><div class="col-sm-10"><input type="text" name="city_name" ng-model="data.city_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">线路：</label><div class="col-sm-10"><input type="text" name="line" ng-model="data.line" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">订单号：</label><div class="col-sm-10"><input type="text" name="order_number" ng-model="data.order_number" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input type="text" name="shop_name" ng-model="data.shop_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input type="text" name="realname" ng-model="data.realname" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户电话：</label><div class="col-sm-10"><input type="text" name="mobile" ng-model="data.mobile" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户地址：</label><div class="col-sm-10"><input type="text" name="address" ng-model="data.address" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">送货日期：</label><div class="col-sm-10"><input type="text" name="deliver_date" ng-model="data.deliver_date" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">异常单类型：</label><div class="col-sm-10"><select name="otype" ng-model="data.otype" class="form-control" ng-options="m.name for m in otypes" required=""><option value="">请选择异常单类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">异常单内容：</label><div class="col-sm-10"><div ng-repeat="item in contents"><select name="product" ng-model="item.product" class="" ng-options="m.name for m in data.detail" ng-change="changeProduct($index);" required=""><option value="">请选择异常单内容</option></select><button type="button" class="btn btn-success" ng-click="addContent();" ng-if="$index == 0"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 增加</button> <button type="button" class="btn btn-danger" ng-click="removeContent($index);" ng-if="$index > 0"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span> 删除</button></div></div></div><div class="form-group"><label class="col-sm-2 control-label">异常原因：</label><div class="col-sm-10"><input type="text" name="reason" ng-model="data.reason" class="form-control" placeholder="请输入异常原因" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">处理方案：</label><div class="col-sm-10"><input type="text" name="solution" ng-model="data.solution" class="form-control" placeholder="请输入处理方案" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">物流部处理意见：</label><div class="col-sm-10"><input type="text" name="suggest" ng-model="data.suggest" class="form-control" placeholder="请输入物流部处理意见"></div></div><div class="form-group"><label class="col-sm-2 control-label">处理状态：</label><div class="col-sm-10"><select name="status" ng-model="data.status" class="form-control" ng-options="m.msg for m in statusList"></select></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="back();">取消</button></div></form></div></div></div></div>'),t.put("app/modules/abnormal_order/detail.html",'<div class="container-fluid"><script type="text/ng-template" id="set_status.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> <div class="form-group" ng-if="items.order.status == 6 || items.order.status == 5"> 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.sign_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.sign_msg);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>内部编号：{{data.id}}</h4><h4>订单编号：{{data.order_number}}</h4><h5 style="margin-top:10px;">状态：{{data.status_cn}}</h5></div><div class="row text-center" ng-if="data==\'\'"><h5>暂无记录</h5></div><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>客户名称</h5></td><td class="text-center"><h5>{{data.realname}}</h5></td><td class="text-center"><h5>电话</h5></td><td class="text-center"><h5>{{data.mobile}}</h5></td></tr><tr><td class="text-center"><h5>送货地点</h5></td><td class="text-center"><h5>{{data.deliver_addr}}</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>{{data.deliver_date}} {{data.deliver_time}}</h5></td></tr><tr><td class="text-center"><h5>下单时间</h5></td><td class="text-center"><h5>{{data.created_time}}&nbsp;</h5></td><td class="text-center"><h5>订单应收金额</h5></td><td class="text-center"><h5>{{data.total_price}}&nbsp;元&nbsp;<span class="label label-danger" ng-if="data.minus_amount > 0">优惠{{data.minus_amount}}元</span></h5></td></tr><tr><td class="text-center"><h5>订单线路</h5></td><td class="text-center"><h5>{{data.line}}&nbsp;</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>{{data.shop_name}}&nbsp;</h5></td></tr><tr><td class="text-center"><h5>销售姓名</h5></td><td class="text-center"><h5>{{data.sale.role}}：{{data.sale.name}}</h5></td><td class="text-center"><h5>销售电话</h5></td><td class="text-center"><h5>{{data.sale.mobile}}</h5></td></tr><tr><td class="text-center"><h5>订单备注</h5></td><td class="text-left" colspan="3"><h5>{{data.remarks}}&nbsp;</h5></td></tr></tbody></table><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody ng-if="data.status != 6"><tr><td class="text-center" colspan="5"><h5>订单内容</h5></td></tr><tr><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>结算单价</strong></h5></td><td class="text-center"><h5><strong>单价</strong></h5></td><td class="text-center"><h5><strong>数量</strong></h5></td><td class="text-center"><h5><strong>小计</strong></h5></td></tr><tr ng-repeat="item in data.detail"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><h5>{{item.single_price}}元/{{item.close_unit}}</h5></td><td class="text-center"><h5>{{item.price}}元</h5></td><td class="text-center"><h5>{{item.quantity}}{{item.unit_id}}</h5></td><td class="text-center"><h5>{{item.sum_price}}元</h5></td></tr></tbody></table><table class="table table-bordered table-striped"><tbody ng-if="data.status == 6"><tr><td class="text-center" colspan="4"><h5>订单内容</h5></td></tr><tr><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>实收单价</strong></h5></td><td class="text-center"><h5><strong>实收数量</strong></h5></td><td class="text-center"><h5><strong>实收小计</strong></h5></td></tr><tr ng-repeat="item in data.detail" ng-if="data.status == 6"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="item.price" ng-focus="clearPrice(item)" ng-blur="setPrice(item, true)" ng-change="setPrice(item)"> <span class="input-group-addon">元</span></div></td><td class="text-center"><div class="input-group input-group-sm"><span class="input-group-addon"><em class="glyphicon glyphicon-minus text-primary" ng-click="minus(item)"></em></span> <input type="text" class="form-control text-center" ng-model="item.quantity" ng-focus="clearNum(item)" ng-blur="setNum(item, true)" ng-change="setNum(item)"> <span class="input-group-addon"><em class="glyphicon glyphicon-plus text-primary" ng-click="plus(item)"></em></span></div></td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="item.sum_price" ng-blur="setSumPrice(item, true)" ng-change="setSumPrice(item)"> <span class="input-group-addon">元</span></div></td></tr><tr><td></td><td></td><td class="text-center">实收金额总计:</td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="deal_price.key" ng-blur="setDealPrice(true)" ng-change="setDealPrice();"> <span class="input-group-addon">元</span></div></td></tr></tbody></table><table class="table table-bordered table-striped"><tbody ng-if="data.status == 1"><tr class="success"><td class="text-center" colspan="4"><h5>订单内容(已回款确认)</h5></td></tr><tr class="success"><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>实收单价</strong></h5></td><td class="text-center"><h5><strong>实收数量</strong></h5></td><td class="text-center"><h5><strong>实收小计</strong></h5></td></tr><tr ng-repeat="item in data.detail" class="success"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><h5>{{item.actual_price}}元</h5></td><td class="text-center"><h5>{{item.actual_quantity}}</h5></td><td class="text-center"><h5>{{item.actual_sum_price}}元</h5></td></tr><tr class="success"><td></td><td></td><td class="text-center">实收金额总计:</td><td class="text-center">{{data.deal_price}}</td></tr></tbody></table></div><div class="col-xs-12 btn-group form-group"><button class="btn col-xs-3 btn-lg btn-primary pull-left" ng-click="create(data.order_number);">填写异常单</button> <button class="btn col-xs-3 btn-lg btn-success pull-left" ng-click="back();">返回</button></div><table class="table table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-6"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center" colspan="3"><h5>订单动态</h5></td></tr><tr><td class="text-center"><h5><strong>处理时间</strong></h5></td><td class="text-center"><h5><strong>处理信息</strong></h5></td><td class="text-center"><h5><strong>操作人</strong></h5></td></tr><tr ng-repeat="item in data.log_list"><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5>{{item.log_info}}<span ng-if="item.remark">备注：{{item.remark}}</span></h5></td><td class="text-center"><h5>{{item.operator_type_cn}}[{{item.operator}}]</h5></td></tr></tbody></table></div></div></div>'),t.put("app/modules/abnormal_order/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>异常单编辑</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.otype.$error.required">请选择异常单类型！</li><li ng-show="basic_form.product.$error.required">请选择异常单内容！</li><li ng-show="basic_form.reason.$error.required">请输入异常原因！</li><li ng-show="basic_form.solution.$error.required">请输入处理方案！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">运营组受理人：</label><div class="col-sm-10"><input type="text" name="cur_name" ng-model="data.creator" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所属系统：</label><div class="col-sm-10"><input type="text" name="site_name" ng-model="order.site_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地区：</label><div class="col-sm-10"><input type="text" name="city_name" ng-model="order.city_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">线路：</label><div class="col-sm-10"><input type="text" name="line" ng-model="order.line" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">订单号：</label><div class="col-sm-10"><input type="text" name="order_number" ng-model="order.order_number" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input type="text" name="shop_name" ng-model="order.shop_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input type="text" name="realname" ng-model="order.realname" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户电话：</label><div class="col-sm-10"><input type="text" name="mobile" ng-model="order.mobile" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户地址：</label><div class="col-sm-10"><input type="text" name="address" ng-model="order.address" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">送货日期：</label><div class="col-sm-10"><input type="text" name="deliver_date" ng-model="order.deliver_date" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">异常单类型：</label><div class="col-sm-10"><select name="otype" ng-model="data.otype" class="form-control" ng-options="m.name for m in otypes" required=""><option value="">请选择异常单类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">异常单内容：</label><div class="col-sm-10"><div ng-repeat="item in contents"><select name="product" ng-model="item.product" class="" ng-options="m.name for m in order.detail" ng-change="changeProduct($index);" required=""><option value="">请选择异常单内容</option></select><button type="button" class="btn btn-success" ng-click="addContent();" ng-if="$index == 0"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 增加</button> <button type="button" class="btn btn-danger" ng-click="removeContent($index);" ng-if="$index > 0"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span> 删除</button></div></div></div><div class="form-group"><label class="col-sm-2 control-label">异常原因：</label><div class="col-sm-10"><input type="text" name="reason" ng-model="data.reason" class="form-control" placeholder="请输入异常原因" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">处理方案：</label><div class="col-sm-10"><input type="text" name="solution" ng-model="data.solution" class="form-control" placeholder="请输入处理方案" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">物流部处理意见：</label><div class="col-sm-10"><input type="text" name="suggest" ng-model="data.suggest" class="form-control" placeholder="请输入物流部处理意见"></div></div><div class="form-group"><label class="col-sm-2 control-label">处理状态：</label><div class="col-sm-10"><select name="status" ng-model="data.status" class="form-control" ng-options="m.msg for m in statusList"></select></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/abnormal_order/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>异常单列表</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'-1\');" ng-class="{\'btn-info\': status == \'-1\'}" class="btn">全部 <span class="badge">{{totals[-1]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">处理中 <span class="badge">{{totals[1]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">已处理 <span class="badge">{{totals[2]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">异常单类型</div><select class="form-control" ng-model="otype" ng-options="m.name for m in otypeList"><option value="">全部</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">所属系统</div><select class="form-control" ng-change="switchCity()" ng-model="site" ng-options="m.name for m in siteList"><option value="">请选择系统</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-change="switchCity()" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">线路</div><select class="form-control" ng-model="line" ng-options="m.name for m in lineList"><option value="">请选择线路</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><button class="btn btn-block btn-primary" ng-click="export()">导出异常单</button></div><div class="form-group"><button class="btn btn-block btn-danger" ng-click="exportAll()">导出全部异常单</button></div><div class="form-group"><button class="btn btn-block btn-success" ng-click="create()">新异常单</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5><input type="checkbox" ng-click="checkAll();" ng-model="check_all"></h5></td><td class="text-center" width="5%"><h5>异常单序号</h5></td><td class="text-center" width="10%"><h5>填写时间</h5></td><td class="text-center" width="5%"><h5>处理状态</h5></td><td class="text-center" width="10%"><h5>异常单类型</h5></td><td class="text-center" width="5%"><h5>所属系统</h5></td><td class="text-center" width="5%"><h5>地区</h5></td><td class="text-center" width="5%"><h5>线路</h5></td><td class="text-center" width="10%"><h5>订单号</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="5%"><h5>客户姓名</h5></td><td class="text-center" width="5%"><h5>客户电话</h5></td><td class="text-center" width="15%"><h5>异常单内容</h5></td><td class="text-center" width="5%"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="14" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5><input type="checkbox" ng-model="item.checked"></h5></td><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5><span class="label label-warning" ng-if="item.status == 1">处理中</span></h5><h5><span class="label label-success" ng-if="item.status == 2">已处理</span></h5></td><td class="text-center"><h5>{{item.otype_name}}</h5></td><td class="text-center"><h5>{{item.site_name}}</h5></td><td class="text-center"><h5>{{item.city_name}}</h5></td><td class="text-center"><h5>{{item.line_name}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5 ng-repeat="product in item.contents">{{product.name}}</h5></td><td class="text-center"><h5><a class="btn btn-primary btn_mb5 btn-sm" ng-href="abnormal_order/edit/{{item.id}}">编辑</a></h5><h5><a class="btn btn-danger btn-sm" ng-click="delete($index)">删除</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/abnormal_order/listOrder.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>新异常单</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">所属系统</div><select class="form-control" ng-change="switchCity()" ng-model="site" ng-options="m.name for m in siteList"><option value="">请选择系统</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td class="text-center"><h5>内部编号</h5></td><td class="text-center"><h5>订单编号</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>客户电话</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>送货地址</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>订单金额</h5></td><td class="text-center"><h5>订单状态</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="10" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5></td><td class="text-center"><h5 class="label {{item.class}}">{{item.status_cn}}</h5></td><td class="text-center"><a class="btn btn-primary btn_mb5 btn-sm" href="abnormal_order/detail/{{item.order_number}}">查看</a> <a class="btn btn-success btn_mb5 btn-sm" href="abnormal_order/create/{{item.order_number}}">填写异常单</a></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/abnormal_order/orderList.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>新异常单</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">所属系统</div><select class="form-control" ng-change="switchCity()" ng-model="site" ng-options="m.name for m in siteList"><option value="">请选择系统</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td class="text-center"><h5>内部编号</h5></td><td class="text-center"><h5>订单编号</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>客户电话</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>送货地址</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>订单金额</h5></td><td class="text-center"><h5>订单状态</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="10" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5></td><td class="text-center"><h5 class="label {{item.class}}">{{item.status_cn}}</h5></td><td class="text-center"><h5><a ng-href="abnormal_order/detail/{{item.order_number}}">查看</a></h5><h5><a ng-href="abnormal_order/create/{{item.order_number}}">填写异常单</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/account/weixinpay.html",'<div class="container-fluid"><div class="width_change" id="row block-tilte"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>微信支付管理</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': pay_status == \'all\'}" class="btn">全部&nbsp<span class="badge">{{total.count_all.total}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': pay_status == \'0\'}" class="btn">未支付&nbsp<span class="badge">{{total.count_waitting.total}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': pay_status == \'1\'}" class="btn">已支付&nbsp<span class="badge">{{total.count_success.total}}</span></a> <a ng-click="filterByStatus(\'-1\');" ng-class="{\'btn-info\': pay_status == \'-1\'}" class="btn">支付失败&nbsp<span class="badge">{{total.count_failed.total}}</span></a> <a class="btn btn-primary pull-right" href="{{payExportUrl}}" target="_blank">微信对账单导出</a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div></form><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center"><h5>内部编号</h5></td><td class="text-center"><h5>交易时间</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>客户电话</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>支付方式/状态</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>订单金额</h5></td><td class="text-center"><h5>支付金额</h5></td><td class="text-center"><h5>订单状态</h5></td><td class="text-center"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5>{{item.user_info.name}}</h5></td><td class="text-center"><h5>{{item.user_info.mobile}}</h5></td><td class="text-center"><h5>{{item.user_info.shop_name}}</h5></td><td class="text-center"><h5>{{item.pay_type.msg}}<h5 class="label {{item.pay_status.class}}">{{item.pay_status.msg}}</h5></h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time.msg}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5 class="label label-danger" ng-if="item.pay_reduce > 0">支付减免{{item.pay_reduce}}元</h5></td><td class="text-center"><h5>{{item.pay_price}}</h5></td><td class="text-center"><h5 class="label {{item.order_status.class}}">{{item.order_status.msg}}</h5></td><td class="text-center"><h5><a ng-click="getpage()" ng-href="order/detail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div></div></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>'),t.put("app/modules/complaint/create.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>新投诉单填写</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.source.$error.required">请选择投诉来源！</li><li ng-show="basic_form.feedback.$error.required">请选择反馈人！</li><li ng-show="basic_form.ctype.$error.required">请选择投诉单类型！</li><li ng-show="basic_form.description.$error.required">请输入问题描述！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">运营组受理人：</label><div class="col-sm-10"><input type="text" name="cur_name" ng-model="data.cur_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所属系统：</label><div class="col-sm-10"><input type="text" name="site_name" ng-model="data.site_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地区：</label><div class="col-sm-10"><input type="text" name="city_name" ng-model="data.city_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">线路：</label><div class="col-sm-10"><input type="text" name="line" ng-model="data.line" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">订单号：</label><div class="col-sm-10"><input type="text" name="order_number" ng-model="data.order_number" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所属销售：</label><div class="col-sm-10"><input type="text" name="invite_name" ng-model="data.sale.name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input type="text" name="shop_name" ng-model="data.shop_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input type="text" name="realname" ng-model="data.realname" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户电话：</label><div class="col-sm-10"><input type="text" name="mobile" ng-model="data.mobile" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户地址：</label><div class="col-sm-10"><input type="text" name="address" ng-model="data.address" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">送货日期：</label><div class="col-sm-10"><input type="text" name="deliver_date" ng-model="data.deliver_date" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">投诉来源：</label><div class="col-sm-10"><select name="source" ng-model="data.source" class="form-control" ng-options="m.msg for m in sourceList" required=""><option value="">请选择投诉来源</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">反馈人：</label><div class="col-sm-10"><select name="feedtype" ng-model="data.feedback" class="form-control" ng-options="m.msg for m in feedbackList" required=""><option value="">请选择反馈人</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">投诉单类型：</label><div class="col-sm-10"><select name="ctype" ng-model="data.ctype" class="form-control" ng-options="m.msg for m in ctypeList" required=""><option value="">请选择投诉单类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">投诉单内容：</label><div class="col-sm-10"><div ng-repeat="item in contents"><select name="product" ng-model="item.product" class="" ng-options="m.name for m in data.detail" ng-change="changeProduct($index);" required=""><option value="">请选择投诉单内容</option></select><button type="button" class="btn btn-success" ng-click="addContent();" ng-if="$index == 0"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 增加</button> <button type="button" class="btn btn-danger" ng-click="removeContent($index);" ng-if="$index > 0"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span> 删除</button> <input type="text" name="price" ng-model="item.product.single_price" class="" placeholder="" style="width:100px;" ng-change="calcProduct(item);"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> <input type="number" name="quantity" ng-model="item.quantity" class="" placeholder="" style="width:100px;" ng-focus="clearNum(item)" ng-blur="setNum(item,true)" ng-change="setNum(item)"> = <input type="text" name="sumPrice" ng-model="item.sumPrice" class="" placeholder="" style="width:100px;" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">总计金额：</label><div class="col-sm-10"><input type="text" name="totalPrice" ng-model="totalPrice" class="form-control" placeholder="总金额" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">问题描述：</label><div class="col-sm-10"><input type="text" name="description" ng-model="data.description" class="form-control" placeholder="请输入问题描述" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">相关图片：</label><span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"><i class="glyphicon glyphicon-plus"></i> <span class="button" ng-file-select="" ng-model="files">上传图片</span></span></div><div class="form-group"><label class="col-sm-2 control-label">已上传图片列表：</label><div class="col-sm-2 col-md-2" ng-repeat="files in imgUploads"><div class="thumbnail"><img width="100" ng-show="files.dataUrl != null" ng-src="{{files.dataUrl}}" class="thumbnail"><div class="caption text-center"><p><a href="#" class="btn btn-primary" role="button" ng-click="picCancel($index)">删除</a></p></div></div></div></div><div class="form-group"><label class="col-sm-2 control-label">处理意见：</label><div class="col-sm-10"><input type="text" name="suggest" ng-model="data.suggest" class="form-control" placeholder="请输入处理意见"></div></div><div class="form-group"><label class="col-sm-2 control-label">问题进度1：</label><div class="col-sm-10"><input type="text" name="progress1" ng-model="data.progress1" class="form-control" placeholder="请输入问题进度1"></div></div><div class="form-group"><label class="col-sm-2 control-label">销售/品控受理人：</label><div class="col-sm-10"><select name="sale" ng-model="data.sale" class="form-control" ng-options="m.name for m in saleList"><option value="">请选择销售/品控受理人</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">问题进度2：</label><div class="col-sm-10"><input type="text" name="progress2" ng-model="data.progress2" class="form-control" placeholder="请输入问题进度2"></div></div><div class="form-group"><label class="col-sm-2 control-label">物流组受理人：</label><div class="col-sm-10"><select name="logistics" ng-model="data.logistics" class="form-control" ng-options="m.name for m in logisticsList"><option value="">请选择物流组受理人</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">问题进度3：</label><div class="col-sm-10"><input type="text" name="progress3" ng-model="data.progress3" class="form-control" placeholder="请输入问题进度3"></div></div><div class="form-group"><label class="col-sm-2 control-label">处理结果：</label><div class="col-sm-10"><input type="text" name="solution" ng-model="data.solution" class="form-control" placeholder="请输入处理结果"></div></div><div class="form-group"><label class="col-sm-2 control-label">处理状态：</label><div class="col-sm-10"><select name="status" ng-model="data.status" class="form-control" ng-options="m.msg for m in statusList"></select></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="back();">取消</button></div></div></form></div></div></div></div>'),t.put("app/modules/complaint/detail.html",'<div class="container-fluid"><script type="text/ng-template" id="set_status.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> <div class="form-group" ng-if="items.order.status == 6 || items.order.status == 5"> 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.sign_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.sign_msg);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>内部编号：{{data.id}}</h4><h4>订单编号：{{data.order_number}}</h4><h5 style="margin-top:10px;">状态：{{data.status_cn}}</h5></div><div class="row text-center" ng-if="data==\'\'"><h5>暂无记录</h5></div><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>客户名称</h5></td><td class="text-center"><h5>{{data.realname}}</h5></td><td class="text-center"><h5>电话</h5></td><td class="text-center"><h5>{{data.mobile}}</h5></td></tr><tr><td class="text-center"><h5>送货地点</h5></td><td class="text-center"><h5>{{data.deliver_addr}}</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>{{data.deliver_date}} {{data.deliver_time}}</h5></td></tr><tr><td class="text-center"><h5>下单时间</h5></td><td class="text-center"><h5>{{data.created_time}}&nbsp;</h5></td><td class="text-center"><h5>订单应收金额</h5></td><td class="text-center"><h5>{{data.total_price}}&nbsp;元&nbsp;<span class="label label-danger" ng-if="data.minus_amount > 0">优惠{{data.minus_amount}}元</span></h5></td></tr><tr><td class="text-center"><h5>订单线路</h5></td><td class="text-center"><h5>{{data.line}}&nbsp;</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>{{data.shop_name}}&nbsp;</h5></td></tr><tr><td class="text-center"><h5>销售姓名</h5></td><td class="text-center"><h5>{{data.sale.role}}：{{data.sale.name}}</h5></td><td class="text-center"><h5>销售电话</h5></td><td class="text-center"><h5>{{data.sale.mobile}}</h5></td></tr><tr><td class="text-center"><h5>订单备注</h5></td><td class="text-left" colspan="3"><h5>{{data.remarks}}&nbsp;</h5></td></tr></tbody></table><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody ng-if="data.status != 6"><tr><td class="text-center" colspan="5"><h5>订单内容</h5></td></tr><tr><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>结算单价</strong></h5></td><td class="text-center"><h5><strong>单价</strong></h5></td><td class="text-center"><h5><strong>数量</strong></h5></td><td class="text-center"><h5><strong>小计</strong></h5></td></tr><tr ng-repeat="item in data.detail"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><h5>{{item.single_price}}元/{{item.close_unit}}</h5></td><td class="text-center"><h5>{{item.price}}元</h5></td><td class="text-center"><h5>{{item.quantity}}{{item.unit_id}}</h5></td><td class="text-center"><h5>{{item.sum_price}}元</h5></td></tr></tbody></table><table class="table table-bordered table-striped"><tbody ng-if="data.status == 6"><tr><td class="text-center" colspan="4"><h5>订单内容</h5></td></tr><tr><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>实收单价</strong></h5></td><td class="text-center"><h5><strong>实收数量</strong></h5></td><td class="text-center"><h5><strong>实收小计</strong></h5></td></tr><tr ng-repeat="item in data.detail" ng-if="data.status == 6"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="item.price" ng-focus="clearPrice(item)" ng-blur="setPrice(item, true)" ng-change="setPrice(item)"> <span class="input-group-addon">元</span></div></td><td class="text-center"><div class="input-group input-group-sm"><span class="input-group-addon"><em class="glyphicon glyphicon-minus text-primary" ng-click="minus(item)"></em></span> <input type="text" class="form-control text-center" ng-model="item.quantity" ng-focus="clearNum(item)" ng-blur="setNum(item, true)" ng-change="setNum(item)"> <span class="input-group-addon"><em class="glyphicon glyphicon-plus text-primary" ng-click="plus(item)"></em></span></div></td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="item.sum_price" ng-blur="setSumPrice(item, true)" ng-change="setSumPrice(item)"> <span class="input-group-addon">元</span></div></td></tr><tr><td></td><td></td><td class="text-center">实收金额总计:</td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="deal_price.key" ng-blur="setDealPrice(true)" ng-change="setDealPrice();"> <span class="input-group-addon">元</span></div></td></tr></tbody></table><table class="table table-bordered table-striped"><tbody ng-if="data.status == 1"><tr class="success"><td class="text-center" colspan="4"><h5>订单内容(已回款确认)</h5></td></tr><tr class="success"><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>实收单价</strong></h5></td><td class="text-center"><h5><strong>实收数量</strong></h5></td><td class="text-center"><h5><strong>实收小计</strong></h5></td></tr><tr ng-repeat="item in data.detail" class="success"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><h5>{{item.actual_price}}元</h5></td><td class="text-center"><h5>{{item.actual_quantity}}</h5></td><td class="text-center"><h5>{{item.actual_sum_price}}元</h5></td></tr><tr class="success"><td></td><td></td><td class="text-center">实收金额总计:</td><td class="text-center">{{data.deal_price}}</td></tr></tbody></table></div><div class="col-xs-12 btn-group form-group"><button class="btn col-xs-3 btn-lg btn-primary pull-left" ng-click="create(data.order_number);">填写投诉单</button> <button class="btn col-xs-3 btn-lg btn-success pull-left" ng-click="back();">返回</button></div><table class="table table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-6"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center" colspan="3"><h5>订单动态</h5></td></tr><tr><td class="text-center"><h5><strong>处理时间</strong></h5></td><td class="text-center"><h5><strong>处理信息</strong></h5></td><td class="text-center"><h5><strong>操作人</strong></h5></td></tr><tr ng-repeat="item in data.log_list"><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5>{{item.log_info}}<span ng-if="item.remark">备注：{{item.remark}}</span></h5></td><td class="text-center"><h5>{{item.operator_type_cn}}[{{item.operator}}]</h5></td></tr></tbody></table></div></div></div>'),t.put("app/modules/complaint/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>投诉单编辑</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.source.$error.required">请选择投诉来源！</li><li ng-show="basic_form.feedback.$error.required">请选择反馈人！</li><li ng-show="basic_form.ctype.$error.required">请选择投诉单类型！</li><li ng-show="basic_form.description.$error.required">请输入问题描述！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">运营组受理人：</label><div class="col-sm-10"><input type="text" name="cur_name" ng-model="data.creator" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所属系统：</label><div class="col-sm-10"><input type="text" name="site_name" ng-model="data.site_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地区：</label><div class="col-sm-10"><input type="text" name="city_name" ng-model="data.city_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">线路：</label><div class="col-sm-10"><input type="text" name="line" ng-model="data.line_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">订单号：</label><div class="col-sm-10"><input type="text" name="order_number" ng-model="data.order_number" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input type="text" name="shop_name" ng-model="data.shop_name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户电话：</label><div class="col-sm-10"><input type="text" name="mobile" ng-model="data.mobile" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户地址：</label><div class="col-sm-10"><input type="text" name="address" ng-model="data.address" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">送货日期：</label><div class="col-sm-10"><input type="text" name="deliver_date" ng-model="data.deliver_date" class="form-control" placeholder="" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">投诉来源：</label><div class="col-sm-10"><select name="source" ng-model="data.source" class="form-control" ng-options="m.msg for m in sourceList" required=""><option value="">请选择投诉来源</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">反馈人：</label><div class="col-sm-10"><select name="feedtype" ng-model="data.feedback" class="form-control" ng-options="m.msg for m in feedbackList" required=""><option value="">请选择反馈人</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">投诉单类型：</label><div class="col-sm-10"><select name="ctype" ng-model="data.ctype" class="form-control" ng-options="m.msg for m in ctypeList" required=""><option value="">请选择投诉单类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">投诉单内容：</label><div class="col-sm-10"><div ng-repeat="item in contents"><select name="product" ng-model="item.product" class="" ng-options="m.name for m in order.detail" ng-change="changeProduct($index);" required=""><option value="">请选择投诉单内容</option></select><button type="button" class="btn btn-success" ng-click="addContent();" ng-if="$index == 0"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 增加</button> <button type="button" class="btn btn-danger" ng-click="removeContent($index);" ng-if="$index > 0"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span> 删除</button> <input type="text" name="price" ng-model="item.product.single_price" class="" placeholder="" style="width:100px;" ng-change="calcProduct(item);"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> <input type="text" name="quantity" ng-model="item.quantity" class="" placeholder="" style="width:100px;" ng-focus="clearNum(item)" ng-blur="setNum(item,true)" ng-change="setNum(item)"> = <input type="text" name="sumPrice" ng-model="item.sumPrice" class="" placeholder="" style="width:100px;" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">总计金额：</label><div class="col-sm-10"><input type="text" name="totalPrice" ng-model="data.total_price" class="form-control" placeholder="总金额" readonly=""></div></div><div class="form-group"><label class="col-sm-2 control-label">问题描述：</label><div class="col-sm-10"><input type="text" name="description" ng-model="data.description" class="form-control" placeholder="请输入问题描述" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">相关图片：</label><span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"><i class="glyphicon glyphicon-plus"></i> <span class="button" ng-file-select="" ng-model="files">上传图片</span></span></div><div class="form-group"><label class="col-sm-2 control-label">已上传图片列表：</label><div class="col-sm-2 col-md-2" ng-repeat="files in imgUploads"><div class="thumbnail"><img width="100" ng-show="files.dataUrl != null" ng-src="{{files.dataUrl}}" class="thumbnail"><div class="caption text-center"><p><a href="#" class="btn btn-primary" role="button" ng-click="picCancel($index)">删除</a></p></div></div></div></div><div class="form-group"><label class="col-sm-2 control-label">处理意见：</label><div class="col-sm-10"><input type="text" name="suggest" ng-model="data.suggest" class="form-control" placeholder="请输入处理意见"></div></div><div class="form-group"><label class="col-sm-2 control-label">问题进度1：</label><div class="col-sm-10"><input type="text" name="progress1" ng-model="data.progress1" class="form-control" placeholder="请输入问题进度1"></div></div><div class="form-group"><label class="col-sm-2 control-label">销售/品控受理人：</label><div class="col-sm-10"><select name="sale" ng-model="data.sale" class="form-control" ng-options="m.name for m in saleList"><option value="">请选择销售/品控受理人</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">问题进度2：</label><div class="col-sm-10"><input type="text" name="progress2" ng-model="data.progress2" class="form-control" placeholder="请输入问题进度2"></div></div><div class="form-group"><label class="col-sm-2 control-label">物流组受理人：</label><div class="col-sm-10"><select name="logistics" ng-model="data.logistics" class="form-control" ng-options="m.name for m in logisticsList"><option value="">请选择物流组受理人</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">问题进度3：</label><div class="col-sm-10"><input type="text" name="progress3" ng-model="data.progress3" class="form-control" placeholder="请输入问题进度3"></div></div><div class="form-group"><label class="col-sm-2 control-label">处理结果：</label><div class="col-sm-10"><input type="text" name="solution" ng-model="data.solution" class="form-control" placeholder="请输入处理结果"></div></div><div class="form-group"><label class="col-sm-2 control-label">处理状态：</label><div class="col-sm-10"><select name="status" ng-model="data.status" class="form-control" ng-options="m.msg for m in statusList"></select></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="back();">取消</button></div></div></form></div></div></div></div>'),t.put("app/modules/complaint/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>投诉单列表</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'-1\');" ng-class="{\'btn-info\': status == \'-1\'}" class="btn">全部 <span class="badge">{{totals[-1]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">处理中 <span class="badge">{{totals[1]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">已处理 <span class="badge">{{totals[2]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">投诉单类型</div><select class="form-control" ng-model="ctype" ng-options="m.msg for m in ctypeList"><option value="">全部</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">所属系统</div><select class="form-control" ng-change="switchCity()" ng-model="site" ng-options="m.name for m in siteList"><option value="">请选择系统</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-change="switchCity()" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">线路</div><select class="form-control" ng-model="line" ng-options="m.name for m in lineList"><option value="">请选择线路</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><button class="btn btn-block btn-primary" ng-click="export()">导出投诉单</button></div><div class="form-group"><button class="btn btn-block btn-danger" ng-click="exportAll()">导出全部投诉单</button></div><div class="form-group"><button class="btn btn-block btn-success" ng-click="create()">新投诉单</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5><input type="checkbox" ng-click="checkAll();" ng-model="check_all"></h5></td><td class="text-center" width="5%"><h5>投诉单号</h5></td><td class="text-center" width="10%"><h5>填写时间</h5></td><td class="text-center" width="5%"><h5>处理状态</h5></td><td class="text-center" width="10%"><h5>投诉单类型</h5></td><td class="text-center" width="5%"><h5>所属系统</h5></td><td class="text-center" width="5%"><h5>地区</h5></td><td class="text-center" width="5%"><h5>所属销售</h5></td><td class="text-center" width="10%"><h5>订单号</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="5%"><h5>客户姓名</h5></td><td class="text-center" width="5%"><h5>客户电话</h5></td><td class="text-center" width="15%"><h5>投诉单内容</h5></td><td class="text-center" width="5%"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="14" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5><input type="checkbox" ng-model="item.checked"></h5></td><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5><span class="label label-warning" ng-if="item.status == 1">处理中</span></h5><h5><span class="label label-success" ng-if="item.status == 2">已处理</span></h5></td><td class="text-center"><h5>{{item.ctype_name}}</h5></td><td class="text-center"><h5>{{item.site_name}}</h5></td><td class="text-center"><h5>{{item.city_name}}</h5></td><td class="text-center"><h5>{{item.invite_name}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5><a ng-href="/user/dynamic/{{item.user_id}}">{{item.mobile}}</a></h5></td><td class="text-center"><h5 ng-repeat="content in item.contents">{{content.name}}</h5></td><td class="text-center"><h5><a class="btn btn-primary btn_mb5 btn-sm" ng-href="complaint/edit/{{item.id}}">编辑</a></h5><h5><a class="btn btn-danger btn-sm" ng-click="delete($index)">删除</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/complaint/listOrder.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>新建投诉</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">所属系统</div><select class="form-control" ng-change="switchCity()" ng-model="site" ng-options="m.name for m in siteList"><option value="">请选择系统</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td class="text-center"><h5>内部编号</h5></td><td class="text-center"><h5>订单编号</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>客户电话</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>送货地址</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>订单金额</h5></td><td class="text-center"><h5>订单状态</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="10" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5></td><td class="text-center"><h5 class="label {{item.class}}">{{item.status_cn}}</h5></td><td class="text-center"><a class="btn btn-primary btn_mb5 btn-sm" href="complaint/detail/{{item.order_number}}">查看</a> <a class="btn btn-success btn_mb5 btn-sm" href="complaint/create/{{item.order_number}}">填写新投诉</a></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/consult/create.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>新建咨询单</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error || data.validaContact==\'1\'"><div class="col-sm-12"><div class="alert alert-danger" ng-show=\'basic_form.$invalid && basic_form.$dirty && show_error || ((data.mobile==undefined || data.mobile=="") && (data.qq==undefined || data.qq=="") && (data.wechat==undefined || data.wechat==""))\'><ul><li ng-show="basic_form.source_type.$error.required">请选择咨询来源！</li><li ng-show="basic_form.c_type.$error.required">请选择咨询类型！</li><li ng-show="basic_form.status_type.$error.required">请选择处理状态！</li><li ng-show="basic_form.name.$error.required">请输入姓名！</li><li ng-show="(data.mobile==undefined || data.mobile==\'\') && (data.qq==undefined || data.qq==\'\') && (data.wechat==undefined || data.wechat==\'\')">请输入联系方式,(手机、qq、微信)中至少一个！</li><li ng-show="basic_form.content.$error.required">请输入咨询内容！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">咨询来源：</label><div class="col-sm-10"><select name="source_type" ng-model="data.source_type" class="form-control" ng-options="m.msg for m in sources" required=""><option value="">请选择咨询来源</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">咨询类型：</label><div class="col-sm-10"><select name="c_type" ng-model="data.c_type" class="form-control" ng-options="m.msg for m in ctypes" required=""><option value="">请选择咨询类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">姓名：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">联系方式：</label><div class="col-sm-10"><input type="text" name="mobile" ng-model="data.mobile" class="form-control" placeholder="请输入手机号"></div></div><div class="form-group"><label class="col-sm-2 control-label"></label><div class="col-sm-10"><input type="text" name="qq" ng-model="data.qq" class="form-control" placeholder="请输入QQ号"></div></div><div class="form-group"><label class="col-sm-2 control-label"></label><div class="col-sm-10"><input type="text" name="wechat" ng-model="data.wechat" class="form-control" placeholder="请输入微信号"></div></div><div class="form-group"><label class="col-sm-2 control-label">了解渠道：</label><div class="col-sm-10"><select name="channel_type" ng-model="data.channel_type" class="form-control" ng-options="m.msg for m in channnels"><option value="">请选择渠道</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">企业名：</label><div class="col-sm-10"><input type="text" name="company_name" ng-model="data.company_name" class="form-control" placeholder="请输入企业名"></div></div><div class="form-group"><label class="col-sm-2 control-label">企业地区：</label><div class="col-sm-10"><input type="text" name="company_area" ng-model="data.company_area" class="form-control" placeholder="请输入企业地区"></div></div><div class="form-group"><label class="col-sm-2 control-label">企业地址：</label><div class="col-sm-10"><input type="text" name="company_address" ng-model="data.company_address" class="form-control" placeholder="请输入企业地址"></div></div><div class="form-group"><label class="col-sm-2 control-label">咨询内容：</label><div class="col-sm-10"><input type="text" name="content" maxlength="100" ng-model="data.content" class="form-control" placeholder="请输入咨询内容" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">处理结果：</label><div class="col-sm-10"><input type="text" name="solution" ng-model="data.solution" class="form-control" placeholder="请输入处理结果"></div></div><div class="form-group"><label class="col-sm-2 control-label">处理状态：</label><div class="col-sm-10"><select name="status_type" ng-model="data.status_type" class="form-control" ng-options="m.msg for m in statues" required=""></select></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="func.add()">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="func.cancel()">取消</button></div></form></div></div></div></div>'),t.put("app/modules/consult/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>咨询单编辑</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error || order.validaContact==\'1\'"><div class="col-sm-12"><div class="alert alert-danger" ng-show=\'basic_form.$invalid && basic_form.$dirty && show_error || (order.mobile=="" && order.qq=="" && order.wechat=="")\'><ul><li ng-show="basic_form.source_type.$error.required">请选择咨询来源！</li><li ng-show="basic_form.c_type.$error.required">请选择咨询类型！</li><li ng-show="basic_form.status_type.$error.required">请选择处理状态！</li><li ng-show="basic_form.name.$error.required">请输入姓名！</li><li ng-show=\'order.mobile=="" && order.qq=="" && order.wechat=="" && order.validaContact=="1"\'>请输入联系方式,(手机、qq、微信)中至少一个！</li><li ng-show="basic_form.content.$error.required">请输入咨询内容！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">咨询来源：</label><div class="col-sm-10"><select name="sourceType" ng-model="sourceType" class="form-control" ng-options="m.msg for m in sources" required=""></select></div></div><div class="form-group"><label class="col-sm-2 control-label">咨询类型：</label><div class="col-sm-10"><select name="cType" ng-model="cType" class="form-control" ng-options="m.msg for m in ctypes" required=""></select></div></div><div class="form-group"><label class="col-sm-2 control-label">姓名：</label><div class="col-sm-10"><input type="text" name="name" ng-model="order.name" class="form-control" placeholder=""></div></div><div class="form-group"><label class="col-sm-2 control-label">联系方式：</label><div class="col-sm-10"><input type="text" name="mobile" ng-model="order.mobile" class="form-control" placeholder="请输入手机"></div></div><div class="form-group"><label class="col-sm-2 control-label"></label><div class="col-sm-10"><input type="text" name="qq" ng-model="order.qq" class="form-control" placeholder="请输入QQ"></div></div><div class="form-group"><label class="col-sm-2 control-label"></label><div class="col-sm-10"><input type="text" name="wechat" ng-model="order.wechat" class="form-control" placeholder="请输入微信"></div></div><div class="form-group"><label class="col-sm-2 control-label">了解渠道：</label><div class="col-sm-10"><select name="channelType" ng-model="channelType" class="form-control" ng-options="m.msg for m in channnels"><option value="">请选择渠道</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">企业名：</label><div class="col-sm-10"><input type="text" name="company_name" ng-model="order.company_name" class="form-control" placeholder="请输入企业名"></div></div><div class="form-group"><label class="col-sm-2 control-label">企业地区：</label><div class="col-sm-10"><input type="text" name="company_area" ng-model="order.company_area" class="form-control" placeholder="请输入企业地区"></div></div><div class="form-group"><label class="col-sm-2 control-label">企业地址：</label><div class="col-sm-10"><input type="text" name="company_address" ng-model="order.company_address" class="form-control" placeholder="请输入企业地址"></div></div><div class="form-group"><label class="col-sm-2 control-label">咨询内容：</label><div class="col-sm-10"><input type="text" name="content" maxlength="100" ng-model="order.content" class="form-control" placeholder="请输入咨询内容" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">处理结果：</label><div class="col-sm-10"><input type="text" name="solution" ng-model="order.solution" class="form-control" placeholder="请输入处理结果"></div></div><div class="form-group"><label class="col-sm-2 control-label">处理状态：</label><div class="col-sm-10"><select name="statusType" ng-model="statusType" class="form-control" ng-options="m.msg for m in statues" required=""></select></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="func.edit()">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="func.cancel()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/consult/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>咨询单列表</h5></div><div class="bs-callout"><a ng-click="func.filterByStatus(\'-1\');" ng-class="{\'btn-info\': status == \'-1\'}" class="btn">全部</a> <a ng-click="func.filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">处理中</a> <a ng-click="func.filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">已处理</a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">咨询类型</div><select class="form-control" ng-model="consultStatusType" ng-options="m.msg for m in ctypes"><option value="">全部</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="func.open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="func.endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="func.search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="func.reset()">重置</button></div><div class="form-group"><button class="btn btn-block btn-primary" ng-click="func.export()">导出咨询单</button></div><div class="form-group"><button class="btn btn-block btn-danger" ng-click="func.exportAll()">导出全部咨询单</button></div><div class="form-group"><button class="btn btn-block btn-success" ng-click="func.goto(\'home.consultCreate\')">新建咨询单</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5><input type="checkbox" ng-click="func.checkAll();" ng-model="check_all"></h5></td><td class="text-center" width="5%"><h5>咨询单号</h5></td><td class="text-center" width="10%"><h5>填写时间</h5></td><td class="text-center" width="10%"><h5>处理状态</h5></td><td class="text-center" width="5%"><h5>受理人</h5></td><td class="text-center" width="5%"><h5>咨询类型</h5></td><td class="text-center" width="5%"><h5>姓名</h5></td><td class="text-center" width="10%"><h5>联系方式</h5></td><td class="text-center" width="10%"><h5>咨询内容</h5></td><td class="text-center" width="10%"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="13" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5><input type="checkbox" ng-model="item.checked"></h5></td><td class="text-center"><h5>{{ item.id }}</h5></td><td class="text-center"><h5>{{ item.created_time }}</h5></td><td class="text-center"><h5><span ng-class="item.status==1?\'label label-warning\':\'label label-success\'">{{ item.status|filterStatus:this.statuses }}</span></h5></td><td class="text-center"><h5>{{ item.creator }}</h5></td><td class="text-center"><h5>{{ item.ctype|filterStatus:this.ctypes }}</h5></td><td class="text-center"><h5>{{ item.name }}</h5></td><td class="text-center"><h5><p ng-show=\'item.qq!=""\'>QQ：{{ item.qq }}</p><p ng-show=\'item.wechat!=""\'>微信：{{ item.wechat }}</p><p ng-show=\'item.mobile!=""\'>电话：{{ item.mobile }}</p></h5></td><td class="text-center"><h5>{{ item.content }}</h5></td><td class="text-center"><h5><a class="btn btn-primary btn_mb5 btn-sm" ng-href="consult/edit/{{item.id}}">编辑</a></h5><h5><a class="btn btn-danger btn-sm" ng-click="func.delete(item.id)">删除</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/customer/create.html",'<div class="container-fluid"><script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>添加客户信息</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.site_id.$error.required">请选择用户所属系统！</li><li ng-show="basic_form.mobile.$error.required">请输入手机号码！</li><li ng-show="basic_form.mobile.$error.pattern">手机号码格式不对！</li><li ng-show="basic_form.name.$error.required">请输入用户姓名！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form"><div class="form-group"><label class="col-sm-2 control-label">所属系统：</label> <label class="radio-inline"><input type="radio" name="site_id" ng-model="info.site_id" value="1" required="">大厨</label> <label class="radio-inline"><input type="radio" name="site_id" ng-model="info.site_id" value="2" required="">大果</label></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码"></div></div><div class="form-group"><label class="col-sm-2 control-label">姓名：</label><div class="col-sm-10"><input type="text" ng-model="info.name" class="form-control" placeholder="请输入姓名"></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select ng-model="addr.province" class="form-control" ng-options="m.name for m in provinces" ng-change="get_child(\'citys\', \'province\');get_market(\'province\')" required=""><option value="">选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">详细地址：</label><div class="col-sm-10"><input type="text" ng-model="info.address" class="form-control" placeholder="请输入详细地址"></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称"></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：</label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/customer/edit.html",'<div class="container-fluid"><script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText">{{items.actionText}}</button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><script type="text/ng-template" id="halfMonthSelect.html"><div class="col-sm-9"> <select name="last" ng-model="newScope.last" class="form-control" ng-options="m.name for m in newScope.list[0]" required> <option value="">请选择上半月日期</option> </select> </br> <select name="next" ng-model="newScope.next" class="form-control" ng-options="m.name for m in newScope.list[1]" required> <option value="">请选择下半月日期</option> </select> </div></script><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>编辑客户信息</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.site_id.$error.required">请选择用户所属系统！</li><li ng-show="basic_form.mobile.$error.required">请输入手机号码！</li><li ng-show="basic_form.mobile.$error.pattern">手机号码格式不对！</li><li ng-show="basic_form.name.$error.required">请输入用户姓名！</li><li ng-show="basic_form.province.$error.required">请选择省份！</li><li ng-show="basic_form.customerModel.$error.required">请选择客户类型！</li><li ng-show="basic_form.kaCustomerType.$error.required">请选择KA客户账号类型！</li><li ng-show="kaCustomerType.value==1 && basic_form.kaBillCycle.$error.required">请选择结账周期！</li><li ng-show="kaCustomerType.value==1 && basic_form.kaCheckDate.$error.required">请选择对账日期！</li><li ng-show="kaCustomerType.value==1 && basic_form.kaInvoiceDate.$error.required">请选择开票日期！</li><li ng-show="kaCustomerType.value==1 && basic_form.kaPayDate.$error.required">请选择付款日期！</li><li ng-show="kaCustomerType.value==2 && basic_form.kaParentMobile.$error.required">请输入关联母账号！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form"><div class="form-group"><label class="col-sm-3 control-label">客户类型：</label><div class="col-sm-9"><select name="customerModel" ng-model="customerModel" class="form-control" ng-options="m.name for m in customerLists" required=""></select></div></div><div><div class="form-group"><label class="col-sm-3 control-label">KA客户账号类型：</label><div class="col-sm-9"><select name="kaCustomerType" ng-model="kaCustomerType" class="form-control" ng-options="m.name for m in account_types" required=""><option value="">请选择KA客户账号类型</option></select></div></div><div ng-if="kaCustomerType.value==2 && info.parent_mobile==\'\'"><div class="form-group"><label class="col-sm-3 control-label">关联母账号信息：</label><div class="col-sm-9"><input type="text" name="kaParentMobile" ng-model="$parent.kaParentMobile" class="form-control" placeholder="请输入关联母账号" required=""></div></div></div><div ng-if="kaCustomerType.value==2 && info.parent_mobile!=\'\'"><div class="edit-title-bar">子母账号信息</div><div><div class="form-group"><label class="col-sm-3 control-label">关联母账号手机：</label><div class="col-sm-9"><input type="text" name="kaParentMobile" ng-model="kaParentMobile" class="form-control" placeholder="请输入关联母账号" required=""></div></div><div class="form-group"><label class="col-sm-3 control-label">关联母账号店铺名：</label><div class="col-sm-9"><input type="text" disabled="true" name="parent_shop_name" ng-model="info.parent_shop_name" class="form-control" required=""></div></div></div></div><div ng-if="kaCustomerType.value==1"><div class="edit-title-bar">子母账号信息</div><div><div class="form-group"><label class="col-sm-3 control-label">关联子账号数量： <span class="color-red"></span></label><div class="col-sm-9"><input type="text" disabled="true" name="child_count" ng-model="info.child_count" class="form-control" placeholder="" required=""></div></div></div></div></div><div style="" class="edit-title-bar">基本信息</div><div class="form-group"><label class="col-sm-3 control-label">餐饮类别：</label><div class="col-sm-9"><select name="shop" ng-model="shop" class="form-control" ng-options="m.name for m in shopTypes" required=""><option value="">请选择餐饮类别</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label" ng-if="shopChilds.length"></label><div class="col-sm-9" ng-show="shopChilds.length"><select ng-model="shopChild" class="form-control" ng-options="m.name for m in shopChilds"><option value="">请选择连锁类型</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">店铺规模：</label><div class="col-sm-9"><select class="form-control" name="dimensions" ng-model="info.dimensions" ng-options="m.name for m in dimensionList" required=""><option value="">请选择店铺规模</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">预估日均采购量（蔬菜/肉）：</label><div class="col-sm-9"><select class="form-control" name="dimensions" ng-model="greens_meat_estimated" ng-options="m.name for m in estimated" required=""><option value="">请选择预估日均采购量</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">预估日均采购量（米面粮油）：</label><div class="col-sm-9"><select class="form-control" name="dimensions" ng-model="rice_grain_estimated" ng-options="m.name for m in estimated" required=""><option value="">请选择预估日均采购量</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">手机号：</label><div class="col-sm-9"><input type="text" name="mobile" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码" required=""></div></div><div class="form-group"><label class="col-sm-3 control-label">姓名：</label><div class="col-sm-9"><input type="text" name="name" ng-model="info.name" class="form-control" placeholder="请输入姓名" required=""></div></div><div class="form-group"><label class="col-sm-3 control-label">地理位置：</label><div class="col-sm-9"><select name="province" ng-model="info.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required=""><option value="">请选择省份</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">配送线路：</label><div class="col-sm-9"><select name="line" ng-model="info.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">请选择配送线路</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">详细地址：</label><div class="col-sm-9"><input type="text" ng-model="info.address" class="form-control" placeholder="请输入详细地址"></div></div><div class="form-group"><label class="col-sm-3 control-label">方位：</label><div class="col-sm-9"><select name="direction" ng-model="info.direction" class="form-control" ng-options="m.label for m in directionList" required=""><option value="">请选择方位</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">店铺名称：</label><div class="col-sm-9"><input type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称"></div></div><div class="form-group"><label class="col-sm-3 control-label">备注(非必填)：</label><div class="col-sm-9"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div ng-if="kaCustomerType.value==1"><div class="edit-title-bar">支付信息</div><div><div class="form-group"><label class="col-sm-3 control-label">结账周期：</label><div class="col-sm-9"><select name="kaBillCycle" ng-model="$parent.kaBillCycle" class="form-control" ng-options="m.name for m in billing_cycles" required=""></select></div></div><div class="form-group"><label class="col-sm-3 control-label">对账日期{{$parent.kaBillCycle.name}}：</label><div ng-if=\'$parent.kaBillCycle.value!="half_month"\' class="col-sm-9"><select name="kaCheckDate" ng-model="$parent.$parent.kaCheckDate" class="form-control" ng-options="m.name for m in check_dates" required=""><option value="" ng-if="$parent.$parent.kaBillCycle.name!=\'无\'">{{"请选择对账日期"}}</option></select></div><div ng-if=\'$parent.kaBillCycle.value=="half_month"\' ng-include="" src="\'halfMonthSelect.html\'" ng-repeat="newScope in kaCheckDateHalfMonth"></div></div><div class="form-group"><label class="col-sm-3 control-label">开票日期：</label><div ng-if=\'$parent.kaBillCycle.value!="half_month"\' class="col-sm-9"><select name="kaInvoiceDate" ng-model="$parent.$parent.kaInvoiceDate" class="form-control" ng-options="m.name for m in check_dates" required=""><option value="" ng-if="$parent.$parent.kaBillCycle.name!=\'无\'">{{"请选择开票日期"}}</option></select></div><div ng-if=\'$parent.kaBillCycle.value=="half_month"\' ng-include="" src="\'halfMonthSelect.html\'" ng-repeat="newScope in kaInvoiceDateHalfMonth"></div></div><div class="form-group"><label class="col-sm-3 control-label">付款日期：</label><div ng-if=\'$parent.kaBillCycle.value!="half_month"\' class="col-sm-9"><select name="kaPayDate" ng-model="$parent.$parent.kaPayDate" class="form-control" ng-options="m.name for m in check_dates" required=""><option value="" ng-if="$parent.$parent.kaBillCycle.name!=\'无\'">{{"请选择付款日期"}}</option></select></div><div ng-if=\'$parent.kaBillCycle.value=="half_month"\' ng-include="" src="\'halfMonthSelect.html\'" ng-repeat="newScope in kaPayDateHalfMonth"></div></div><div class="form-group" ng-if=""><label class="col-sm-3 control-label">相关图片：</label> <span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"><i class="glyphicon glyphicon-plus"></i> <span class="button" ng-file-select="" ng-model="files">开始上传附件</span></span></div><div class="form-group" ng-if=""><label class="col-sm-3 control-label">已上传附件列表：</label><div class="col-sm-3 col-md-2" ng-repeat="files in imgUploads"><div class="thumbnail"><img width="100" ng-show="files.dataUrl != null" ng-src="{{files.dataUrl}}" class="thumbnail"><div class="caption text-center"><p><a href="#" class="btn btn-primary" role="button" ng-click="picCancel($index)">删除</a></p></div></div></div></div></div></div><div class="edit-title-bar" ng-if="info.is_active==0" style="background:#70D2C9;color:white;">审核通过 <input type="checkbox" ng-model="$parent.isCheckSuccess"></div><div class="form-group"><label class="col-sm-3 control-label"></label><div class="col-sm-0"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交修改</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></div></form></div></div></div></div>'),t.put("app/modules/customer/editLine.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>修改客户配送线路：</h4></div><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form"><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>{{data.name}}</h5></td><td class="text-center"><h5>客户电话</h5></td><td class="text-center"><h5>{{data.mobile}}</h5></td></tr><tr><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>{{data.shop_name}}&nbsp;</h5></td><td class="text-center"><h5>所属系统</h5></td><td class="text-center"><h5>{{data.site_id == 1 ? \'大厨网\' : \'大果网\'}}</h5></td></tr><tr><td class="text-center"><h5>送货日期</h5></td><td class="text-center form-group"><select class="input-lg w100" ng-model="data.line" ng-options="m.name for m in lines" required=""><option value="">请选择配送线路</option></select></td><td class="text-center"><h5>备注</h5></td><td class="text-left"><h5>{{data.remark}}&nbsp;</h5></td></tr><tr><td class="text-center"><h5>详细地址</h5></td><td class="text-left" colspan="3"><h5>{{data.province_str}} {{data.address}}&nbsp;</h5></td></tr></tbody></table></div><div class="col-xs-12 btn-group form-group"><button class="btn col-xs-3 btn-lg btn-danger pull-left" ng-click="editLine();">确认修改</button> <button class="btn col-xs-3 btn-lg btn-success" ng-click="back();">返回</button></div></form></div></div></div>'),t.put("app/modules/customer/list.html",'<div class="container-fluid"><script type="text/ng-template" id="line.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-left">{{items.bodyText}}</h2> <div class="form-group"> <select ng-model="line_change" class="form-control" name="line_change" ng-options="m.name for m in items.line_list"> <option value=""> 请选择线路 </option> </select> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(line_change);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>客户列表</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'normal\');" ng-class="{\'btn-info\': status == \'normal\'}" class="btn">正常 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'-1\');" ng-class="{\'btn-info\': status == \'-1\'}" class="btn">已禁用 <span class="badge">{{total[3]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><select ng-model="line" class="form-control" name="line" ng-options="m.name for m in line_list"><option value="">请选择线路</option></select></div><div class="form-group"><div class="input-group"><div class="input-group-addon">客户类型</div><select ng-model="customerType" class="form-control" name="searchKey" ng-options="m.name for m in customerTypes"><option value="">请选择客户类型</option></select></div><div class="form-group"><div class="input-group"><div class="input-group-addon">搜索类型</div><select ng-model="searchKey" class="form-control" name="searchKey" ng-options="m.name for m in keyList"></select></div></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="mt-10"><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><button class="btn btn-block btn-success" ng-click="batchUpdateLine();">批量修改线路</button></div><div class="form-group" ng-show="false"><a class="btn btn-primary btn-sm" href="/customer/create">添加客户</a></div></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5><input type="checkbox" ng-click="checkAll();" ng-model="check_all"></h5></td><td class="text-center"><h5>编号</h5></td><td class="text-center"><h5>客户类型</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>线路</h5></td><td class="text-center"><h5>已完成订单数</h5></td><td class="text-center"><h5>注册时间</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="8" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5><input type="checkbox" ng-model="item.checked"></h5></td><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.customer_type_name}} <a ng-show="item.is_active==0" class="btn btn-danger btn-sm btn_mb5" ng-click="resetPassword($index)">待审核</a></h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5><a ng-href="/user/dynamic/{{item.id}}">{{item.mobile}}</a></h5></td><td class="text-center"><h5>{{item.line_name}}</h5></td><td class="text-center"><h5>{{item.order_count}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5><a class="btn btn-primary btn_mb5 btn-sm" href="/customer/edit/{{item.id}}">编辑客户</a> <a class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus($index, -1)" ng-if="item.status != -1">禁用账号</a> <a class="btn btn-success btn-sm btn_mb5" ng-click="setStatus($index, 1)" ng-if="item.status == -1">启用账号</a> <a class="btn btn-info btn-sm btn_mb5" ng-click="resetPassword($index)">重置密码</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/customer/listLine.html",'<div class="container-fluid"><script type="text/ng-template" id="line.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>客户线路管理</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': line_status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'toAllot\');" ng-class="{\'btn-info\': line_status == \'toAllot\'}" class="btn">待分配线路 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'allot\');" ng-class="{\'btn-info\': line_status == \'allot\'}" class="btn">已分配线路 <span class="badge">{{total[2]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">搜索类型</div><select ng-model="searchKey" class="form-control" name="searchKey" ng-options="m.name for m in keyList"></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info form-control" ng-click="search();">筛选</button> <button class="btn btn-block btn-warning form-control" ng-click="reset()">重置</button></div><div class="mt-10"><div class="form-group"></div><div class="form-group" ng-show="false"><a class="btn btn-primary btn-sm" href="/customer/create">添加客户</a></div></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-3"><col class="col-xs-1"></colgroup><thead><tr><td class="text-center"><h5>编号</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>线路名称</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="8" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.line_name}}</h5></td><td class="text-center"><h5><a class="btn btn-primary btn_mb5 btn-sm" ui-sref="home.customerEditLine({id: item.id})">编辑客户线路</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/customer/listTransfer.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>请选择要移交的客户</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': show_status == \'all\'}" class="btn">全部客户 <span class="badge">{{total}}</span></a> <a ng-click="filterByStatus(\'toTransfer\');" ng-class="{\'btn-info\': show_status == \'toTransfer\'}" class="btn">待移交客户 <span class="badge">{{selCustomers.length}}</span></a><div class="block mt-10 ml-default" ng-show="show_status == \'all\'"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">销售角色</div><select ng-model="roleType" class="form-control" name="roleType" ng-options="m.name for m in bdRoleList" ng-change="changeSale();"><option value="">请选择销售角色</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">销售姓名</div><select ng-model="sale" class="form-control" name="sale" ng-options="m.name for m in saleList"><option value="">请选择销售</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">客户类型</div><select ng-model="customerType" class="form-control" name="customerType" ng-options="m.name for m in customerTypeList"><option value="">请选择客户类型</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">搜索类型</div><select ng-model="searchKey" class="form-control" name="searchKey" ng-options="m.name for m in keyList"><option value="">请选择搜索类型</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="mt-10"></div></form><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5><input type="checkbox" ng-click="checkAll();" ng-model="check_all"></h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>现属销售</h5></td><td class="text-center"><h5>线路</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="6" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5><input type="checkbox" ng-model="item.checked" ng-click="checkOne($index);"></h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5 ng-if="item.status != 12">{{item.bd_name}}</h5><h5 ng-if="item.status == 12">{{item.am_name}}</h5></td><td class="text-center"><h5>{{item.line_name}}</h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div><div class="block mt-10 ml-default" ng-show="show_status == \'toTransfer\'"><form class="form-inline text-right" role="form"><div class="form-group"><button class="btn-block btn btn-info" ng-click="removeAll();">全部清空</button></div><div class="form-group"><button class="btn btn-block btn-danger" ng-click="transferCustomer()">下一步</button></div></form><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"></colgroup><thead><tr><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>现属销售</h5></td><td class="text-center"><h5>线路</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="selCustomers.length===0"><tr><td colspan="6" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="selCustomers.length>0"><tr ng-repeat="item in selCustomers"><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5 ng-if="item.status != 12">{{item.bd_name}}</h5><h5 ng-if="item.status == 12">{{item.am_name}}</h5></td><td class="text-center"><h5>{{item.line_name}}</h5></td><td class="text-center"><h5><span class="glyphicon glyphicon-remove" aria-hidden="true" ng-click="remove($index);"></span></h5></td></tr></tbody></table></div></div></div></div></div></div>'),t.put("app/modules/customer/listTransferUser.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>请选择要移交的销售同事</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form" name="myForm"><div class="form-group"><div class="input-group"><div class="input-group-addon">销售角色</div><select ng-model="roleType" class="form-control" name="roleType" ng-options="m.name for m in bdRoleList"></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">搜索类型</div><select ng-model="searchKey" class="form-control" name="searchKey" ng-options="m.name for m in keyList"><option value="">请选择搜索类型</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="mt-10"></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-2"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5>请选择</h5></td><td class="text-center"><h5>姓名</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>客户数量</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="4" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody><tr ng-repeat="item in list"><td class="text-center"><h5><input type="radio" ng-model="saleUser" value="{{item.id}}" name="saleUser" ng-click="setSaleUser({{item.id}});"></h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.order_count}}</h5></td></tr></tbody></table></div></form><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div><div class="block mt-10 ml-default text-right"><button class="btn btn-success" ng-click="back();">上一步</button> <button class="btn btn-danger" ng-click="transfer();">开始移交</button></div></div></div></div></div>'),t.put("app/modules/customer/newTransfer.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>客户移交</h4></div><div class="bs-callout"><div class="bs-callout" style="border:none;background:#f3f3f3;"><h3>接收模块：请选择接收人</h3></div><a ng-click="filterByStatus(\'1\');" style="border:1px solid #ddd;padding:12px 58px;" ng-class="{\'btn-info\': show_status == \'1\'}" class="btn"><h5>公海</h5><span class="badge"></span></a> <a style="margin-left:30px;"></a> <a ng-click="filterByStatus(\'0\');" style="border:1px solid #ddd;padding:12px 58px;" ng-class="{\'btn-info\': show_status == \'0\'}" class="btn"><h5>私海</h5><span class="badge"></span></a><div class="block mt-10 ml-default" style="margin-top:20px;" ng-show="show_status == \'1\'"><form class="form-inline" role="form" name="basic_form_g"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select ng-model="modelParamG.city" ng-disabled="disabledG" class="form-control" required="" name="city" ng-options="m.name for m in cityModelG"><option value="">请选择城市</option></select></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="gong.search();">确定</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="gong.reset()">重置</button></div><div class="mt-10"></div></form></div><div class="block mt-10 ml-default" style="margin-top:20px;" ng-show="show_status == \'0\'"><form class="form-inline" role="form" name="basic_form_s"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select ng-model="modelParamS.city" required="" ng-disabled="disabledS" class="form-control" name="city" ng-options="m.name for m in cityModelS"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">销售姓名</div><input type="text" ng-model="modelS.inputModelS" ng-disabled="disabledS" required="" placeholder="请选择销售姓名" ng-click="keyFunS($event)" ng-blur="blurFunS($event)"> <span style="position:absolute;margin-left:-150px;margin-top:30px;" is-open="modelS.statusModel" class="dropdown" dropdown="" on-toggle="toggled2(open)"><ul class="dropdown-menu"><li ng-repeat="item in saleNameModelS" ng-click="clickItemS(item.name,item.id,saleNameModelS[$index])"><a href="">{{item.name}}</a></li></ul></span></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="si.search();">确定</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="si.reset()">重置</button></div><div class="mt-10"></div></form></div></div><div class="bs-callout" ng-show="show_list" style="margin-top:50px;"><div class="bs-callout" style="border:none;background:#f3f3f3;"><h3>移交模块：请选择移交客户</h3></div><div class="block mt-10 ml-default"><form class="form-inline" role="form" name="basic_form_l"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select ng-model="sale" class="form-control" disabled="disabled"><option value="">{{ modelParamL.city.name }}</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">线路</div><select ng-model="modelParamL.line" class="form-control" name="customerType" ng-options="m.name for m in lineModelL"><option value="">全部</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">客户类型</div><select ng-model="modelParamL.customerType" class="form-control" required="" name="customerType" ng-options="m.msg for m in customer_types"><option value="">请选择客户类型</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">下单记录</div><select ng-model="modelParamL.orderRecord" class="form-control" name="customerType" ng-options="m.msg for m in order_records"><option value="">全部</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">销售姓名</div><input type="text" ng-model="modelL.inputModelL" placeholder="请选择销售姓名" ng-click="keyFunL($event)"> <span style="position:absolute;margin-left:-150px;margin-top:30px;" is-open="modelL.statusModel" class="dropdown" dropdown="" on-toggle="toggled(open)"><ul class="dropdown-menu"><li ng-repeat="item in saleNameModelL" ng-click="clickItemL(item.name,item.id,saleNameModelL[$index])"><a href="">{{item.name}}</a></li></ul></span></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="modelParamL.searchValue" class="form-control" placeholder="请输入店铺名或手机号"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="com.search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="com.reset()">重置</button></div><div class="mt-10"></div></form><div style="border:none;width:100%;height:70px;"><div style="width:35%;height:70px;float:left;"><div><span style="font-size:1.0em;" class="btn">潜在客户：</span> <span style="font-size:1.0em;" class="">已选中客户 <span class="badge" ng-style="tipBackground2">{{modelParamL.selTotalCount_potient}}</span></span> / <span style="font-size:1.0em;" class="">接收人客容余量 <span class="badge">{{modelParamL._type_=="g"?"无限": modelS.selClickModel.leftover_potential_customer}}</span></span></div><div><span style="font-size:1.0em;" class="btn">注册客户：</span> <span style="font-size:1.0em;" class="">已选中客户 <span class="badge" ng-style="tipBackground1">{{modelParamL.selTotalCount_regist}}</span></span> / <span style="font-size:1.0em;" class="">接收人客容余量 <span class="badge">{{modelParamL._type_=="g"?"无限": modelS.selClickModel.leftover_customer}}</span></span></div></div><div style="width:65%;padding-top:15px;height:70px;"><button class="btn btn-success" ng-click="com.getCacheCheckList()">查看已选中客户</button> <button class="btn btn-info" ng-click="com.startTransform()">确认移交</button></div></div><div ng-if="!isClickShowCheck"><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" style="width:5%;"><h5><input type="checkbox" ng-click="com.checkAll(check_all);" ng-model="check_all"></h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>现属销售</h5></td><td class="text-center"><h5>线路</h5></td><td class="text-center"><h5>客户类型</h5></td><td class="text-center"><h5>店铺规模</h5></td><td class="text-center"><h5>餐饮类别</h5></td><td class="text-center" style="width:10%;"><h5>地址</h5></td><td class="text-center" style="width:10%;"><h5>下单记录</h5></td></tr></thead><tbody ng-if="listSearch.length===0"><tr><td colspan="11" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="listSearch.length> 0"><tr ng-repeat="item in listSearch"><td class="text-center"><h5><input type="checkbox" ng-model="item.checked" ng-click="com.checkOne(item.checked,item);"></h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.sale.role}}:{{item.sale.name}}</h5></td><td class="text-center"><h5>{{item.line_name}}</h5></td><td class="text-center"><h5>{{item.customer_type_name}}</h5></td><td class="text-center"><h5>{{item.dimension_name}}</h5></td><td class="text-center"><h5>{{item.shop_type_name}}</h5></td><td class="text-center"><h5>{{item.address}}</h5></td><td class="text-center"><h5>{{item.order_record }}</h5></td></tr></tbody></table></div><div ng-if="listSearch.length> 0"><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div><div ng-if="listSearch.length==0">暂无数据</div></div><div ng-if="isClickShowCheck"><form class="form-inline text-right" role="form"><div class="form-group"><button class="btn-block btn btn-info" ng-click="com.removeCheckAll();">全部清空</button></div><div class="form-group"><button class="btn btn-block btn-danger" ng-click="com.getBack()">继续选客户</button></div></form><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>现属销售</h5></td><td class="text-center"><h5>线路</h5></td><td class="text-center"><h5>餐饮类别</h5></td><td class="text-center"><h5>地址</h5></td><td class="text-center"><h5>下单记录</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="listSelectSearch.length===0"><tr><td colspan="8" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="listSelectSearch.length> 0"><tr ng-repeat="item in listSelectSearch"><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.sale.role}}:{{item.sale.name}}</h5></td><td class="text-center"><h5>{{item.line_name}}</h5></td><td class="text-center"><h5>{{item.shop_type_name}}</h5></td><td class="text-center"><h5>{{item.address}}</h5></td><td class="text-center"><h5>{{item.order_record }}</h5></td><td class="text-center"><button class="btn btn-info" ng-click="com.removeCheckOne(item);">删除</button></td></tr></tbody></table></div></div></div></div></div></div></div>'),t.put("app/modules/department/create.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>添加部门</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.dept_name.$error.required">请输入部门名称！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">上级部门：</label><div class="col-sm-10"><select ng-model="data.parent" class="form-control" ng-options="m.pre_name for m in departments"><option value="">选择上级部门</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">部门名称：</label><div class="col-sm-10"><input type="text" name="dept_name" ng-model="data.dept_name" class="form-control" placeholder="请输入部门名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">描述：</label><div class="col-sm-10"><textarea ng-model="data.description" class="form-control" rows="3"></textarea></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/department/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>修改部门</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.name.$error.required">请输入部门名称！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">上级部门：</label><div class="col-sm-10"><select ng-model="data.parent" class="form-control" ng-options="m.pre_name for m in list"><option value="">选择上级部门</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">部门名称：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入部门名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">描述：</label><div class="col-sm-10"><textarea ng-model="data.description" class="form-control" rows="3"></textarea></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/department/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>部门列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><a class="btn btn-primary btn-sm" href="/department/create">添加部门</a></div></form></div></div><div style="margin-top:10px;" class="table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-4"><col class="col-xs-3"><col class="col-xs-2"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5>编号</h5></td><td class="text-center"><h5>部门名称</h5></td><td class="text-center"><h5>描述</h5></td><td class="text-center"><h5>添加时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="8" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-left"><h5>{{item.pre_name}}</h5></td><td class="text-center"><h5>{{item.description}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5><a class="btn btn-info btn-sm" href="/department/edit/{{item.id}}">编辑</a> <a class="btn btn-danger btn-sm" ng-click="delete($index);">删除</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>'),t.put("app/modules/distribution/detail.html",'<div class="container-fluid"><script type="text/ng-template" id="set_status.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> <div class="form-group" ng-if="items.order.status == 6 || items.order.status == 5"> 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.sign_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.sign_msg);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>配送单编号：{{data.dist_number}}</h4><h5 style="margin-top:10px;">状态：{{data.is_printed == 1 ? \'已打印\' : \'未打印\'}}</h5></div><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>创建者</h5></td><td class="text-center"><h5>{{data.creator}}</h5></td><td class="text-center"><h5>创建时间</h5></td><td class="text-center"><h5>{{data.created_time}}</h5></td></tr><tr><td class="text-center"><h5>总单数</h5></td><td class="text-center"><h5>{{data.order_count}}</h5></td><td class="text-center"><h5>总金额</h5></td><td class="text-center"><h5>{{data.total_price}}</h5></td></tr><tr><td class="text-center"><h5>总行数</h5></td><td class="text-center"><h5>{{data.line_count}}</h5></td><td class="text-center"><h5>总件数</h5></td><td class="text-center"><h5>{{data.sku_count}}</h5></td></tr></tbody></table><table class="table table-bordered table-striped"><thead><colgroup><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><tr><td class="text-center" colspan="10"><h5>订单列表</h5></td></tr><tr><td>店铺名称</td><td>收件人</td><td>订单id</td><td>订单编号</td><td>货品</td><td>产品名称</td><td>规格</td><td>订货数量</td><td>单价</td><td>备注</td></tr></thead><tbody ng-repeat="order in orderList"><tr ng-repeat="detail in order.detail"><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.shop_name}}<p>{{order.deliver_addr}}</p></td><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.username}}</td><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.id}}</td><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.order_number}}</td><td>{{detail.product_id}}</td><td>{{detail.name}}</td><td>{{detail.spec[1].val}}</td><td>{{detail.quantity}}</td><td>{{detail.price}}</td><td></td></tr></tbody></table></div><div class="col-xs-12 btn-group form-group"><button class="btn col-xs-3 btn-lg btn-success" ng-click="back();">返回</button></div></div></div></div>'),t.put("app/modules/distribution/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>配送路线单列表</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'-1\');" ng-class="{\'btn-info\': status == \'-1\'}" class="btn">全部 <span class="badge">{{totals[-1]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">未发运 <span class="badge">{{totals[1]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">已发运 <span class="badge">{{totals[2]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div><div class="input-group"><div class="input-group-addon">订单类别</div><select class="form-control" ng-model="orderType" ng-options="m.msg for m in orderTypeList"><option value="">全部</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">订单id</div><input type="text" ng-model="orderId" class="form-control" placeholder="请输入订单id"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><br><br><div class="form-group"><div class="input-group"><div class="input-group-addon">创建起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">创建截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><a ng-href="/orderMap/index" class="btn btn-block btn-success">线路规划地图</a></div><div class="form-group"><a class="btn btn-block btn-danger" ng-click="print()">打印</a></div><div class="form-group"><a class="btn btn-block btn-success" ng-click="export()">导出</a></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5><input type="checkbox" ng-click="checkAll();" ng-model="check_all"></h5></td><td class="text-center"><h5>配送单号</h5></td><td class="text-center"><h5>创建者</h5></td><td class="text-center"><h5>创建时间</h5></td><td class="text-center"><h5>总订单数</h5></td><td class="text-center"><h5>总行数</h5></td><td class="text-center"><h5>总件数</h5></td><td class="text-center"><h5>总金额</h5></td><td class="text-center"><h5>配送单状态</h5></td><td class="text-center"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="10" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5><input type="checkbox" ng-model="item.checked"></h5></td><td class="text-center"><h5>{{item.dist_number}}</h5></td><td class="text-center"><h5>{{item.creator}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5>{{item.order_count}}</h5></td><td class="text-center"><h5>{{item.line_count}}</h5></td><td class="text-center"><h5>{{item.sku_count}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5></td><td class="text-center"><h5 class="label label-danger" ng-if="item.status == 1">未发运</h5><h5 class="label label-success" ng-if="item.status == 2">已发运</h5></td><td class="text-center"><h5><a ng-href="distribution/detail/{{item.id}}">查看</a></h5><h5><a href="http://api.hop.dachuwang.com/temp_export/export_dist_detail?dist_id={{item.id}}" target="_blank">导出</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/home/achieve.html",'<div class="container-fluid" ng-controller="HomeAchieveCtrl"><div ng-include="\'components/navbar/navbar.html\'"></div><div id="row block-title"><div ng-include="\'components/navbar/navsidebar.html\'"></div><div class="col-xs-offset-2 col-xs-10"><div class="row block block-col text-center" ng-if="data==\'\'"><h5>暂无记录</h5></div><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>今日新增供应商</h5></td><td class="text-center"><h5>{{data.today_new_seller}}</h5></td><td class="text-center"><h5>总供应商</h5></td><td class="text-center"><h5>{{data.total_seller}}</h5></td></tr><tr><td class="text-center"><h5>今日新增采购商</h5></td><td class="text-center"><h5>{{data.today_new_buyer}}</h5></td><td class="text-center"><h5>总采购商</h5></td><td class="text-center"><h5>{{data.total_buyer}}</h5></td></tr><tr><td class="text-center"><h5>今日订单数</h5></td><td class="text-center"><h5>{{data.today_new_order}}</h5></td><td class="text-center"><h5>总订单数</h5></td><td class="text-center"><h5>{{data.total_order}}</h5></td></tr><tr><td class="text-center"><h5>今日订单金额</h5></td><td class="text-center"><h5>{{data.today_deal_amount}}&nbsp;元</h5></td><td class="text-center"><h5>总订单金额</h5></td><td class="text-center"><h5>{{data.total_deal_amount}}&nbsp;元</h5></td></tr><tr><td class="text-center"><h5>今日新商品数</h5></td><td class="text-center"><h5>{{data.today_new_product}}</h5></td><td class="text-center"><h5>总商品数</h5></td><td class="text-center"><h5>{{data.total_product}}</h5></td></tr></tbody></table></div></div></div></div>'),t.put("app/modules/home/home.html",'<div class="container-fluid"><div ng-include="\'components/navbar/navbar.html\'"></div><div id="row block-title"><div ng-include="\'components/navbar/navsidebar.html\'"></div><div ui-view=""></div></div></div>'),t.put("app/modules/line/create.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>添加线路</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.province.$error.required">请选择省份！</li><li ng-show="basic_form.warehouse.$error.required">请选择仓库！</li><li ng-show="basic_form.name.$error.required">请输入线路名称！</li><li ng-show="basic_form.full_name.$error.required">请输入线路全名！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select name="province" ng-model="data.province" class="form-control" ng-options="m.name for m in provinces" ng-change="get_child(\'citys\', \'province\');" required=""><option value="">请选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">对应仓库：</label><div class="col-sm-10"><select name="warehouse" ng-model="data.warehouse" class="form-control" ng-options="m.name for m in warehouses" required=""><option value="">请选择仓库</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">线路名称：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入线路名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">线路全名：</label><div class="col-sm-10"><input type="text" name="full_name" ng-model="data.full_name" class="form-control" placeholder="请输入线路全名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">线路描述：</label><div class="col-sm-10"><input type="text" name="description" ng-model="data.description" class="form-control" placeholder="请输入线路描述"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/line/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>修改线路</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.province.$error.required">请选择省份！</li><li ng-show="basic_form.warehouse.$error.required">请选择仓库！</li><li ng-show="basic_form.name.$error.required">请输入线路名称！</li><li ng-show="basic_form.full_name.$error.required">请输入线路全名！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select name="province" ng-model="data.province" class="form-control" ng-options="m.name for m in provinces" ng-change="get_child(\'citys\', \'province\');" required=""><option value="">请选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">对应仓库：</label><div class="col-sm-10"><select name="warehouse" ng-model="data.warehouse" class="form-control" ng-options="m.name for m in warehouses" required=""><option value="">请选择仓库</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">线路名称：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入线路名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">线路全名：</label><div class="col-sm-10"><input type="text" name="full_name" ng-model="data.full_name" class="form-control" placeholder="请输入线路全名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">线路描述：</label><div class="col-sm-10"><input type="text" name="description" ng-model="data.description" class="form-control" placeholder="请输入线路描述"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/line/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>线路列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><a class="btn btn-primary btn-sm" href="/line/create">添加线路</a></div></form></div></div><div style="margin-top:10px;" class="table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-3"><col class="col-xs-4"><col class="col-xs-2"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5>编号</h5></td><td class="text-center"><h5>线路名称</h5></td><td class="text-center"><h5>仓库名称</h5></td><td class="text-center"><h5>客户数量</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="4" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.warehouse_name}}</h5></td><td class="text-center"><h5>{{item.line_count}}</h5></td><td class="text-center"><h5><a class="btn btn-info btn-sm" href="/line/edit/{{item.id}}">编辑</a> <a class="btn btn-danger btn-sm" ng-click="delete($index)">删除</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>'),t.put("app/modules/mapline/maplines.html","dsfsfsfsfsf"),t.put("app/modules/order/detail.html",'<div class="container-fluid"><script type="text/ng-template" id="set_status.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h3 class="text-left">{{items.bodyText}}</h3> <div class="form-group" ng-if="items.status == \'cancel\'"> <select ng-model="items.remark" class="form-control" name="remark" ng-options="m.msg for m in items.reasonList"> <option value=""> 请选择关闭理由 </option> </select> </div> <div class="form-group" ng-if="items.status == \'cancel\' && items.remark.code == 6"> 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.sign_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.sign_msg, items.remark);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><script type="text/ng-template" id="set_time.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-left">{{items.bodyText}}</h2> <div class="form-group"> <select ng-model="items.deliver_date" class="input-lg w100" name="items.deliver_date" ng-options="m.name for m in items.deliver_times" required> <option value="">请选择送货日期</option> </select> <select class="input-lg w100" ng-model="items.deliver_time" ng-options="m.msg for m in items.deliver_date.time" required> <option value="">请选择送货时间</option> </select> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.deliver_date,items.deliver_time);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><script type="text/ng-template" id="set_remark.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> <div class="form-group" > 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.remark_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.remark_msg);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><script type="text/ng-template" id="change_pay_type.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h4 class="text-left">{{items.bodyText}}</h4> <div class="form-group" > <label class="radio-inline" ng-repeat="type in items.order.pay_types" style="margin-top:10px;margin-bottom:10px;" > <input type="radio" class="pay_type" name="pay_edit" ng-model="items.order.pay_type" ng-value ="{{type}}" /> <span ng-if="type ==1">微信支付</span> <span ng-if="type ==0">货到付款</span> </label> <h4>操作原因</h4> <textarea cols="20" rows="6" class="form-control" ng-model="items.order.remark_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.order);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>内部编号：{{data.id}}</h4><h4>订单编号：{{data.order_number}}</h4><h5>订单状态：{{data.status_cn}}</h5><h5 style="margin-top:10px;">支付方式：<span ng-if="data.pay_type == 0">货到付款</span><span ng-if="data.pay_type == 1">微信支付</span><span ng-if="data.pay_type == 1 && data.pay_status == 0">-未支付</span><span ng-if="data.pay_type == 1 && data.pay_status == 1">-已支付</span></h5></div><div class="row text-center" ng-if="data==\'\'"><h5>暂无记录</h5></div><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>客户名称</h5></td><td class="text-center"><h5>{{data.username}}</h5></td><td class="text-center"><h5>电话</h5></td><td class="text-center"><h5>{{data.mobile}}</h5></td></tr><tr><td class="text-center"><h5>送货地点</h5></td><td class="text-center"><h5>{{data.deliver_addr}}</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>{{data.deliver_date}} {{data.deliver_time}}</h5></td></tr><tr><td class="text-center"><h5>下单时间</h5></td><td class="text-center"><h5>{{data.created_time}}&nbsp;</h5></td><td class="text-center"><h5>订单线路</h5></td><td class="text-center"><h5>{{data.line_name}}&nbsp;</h5></td></tr><tr><td class="text-center"><h5>订单金额</h5></td><td class="text-center"><h5>{{data.total_price}}&nbsp;元&nbsp;<span class="label label-danger" ng-if="data.minus_amount > 0">优惠{{data.minus_amount}}元</span><span class="label label-warning" ng-if="data.deliver_fee > 0">运费{{data.deliver_fee}}元</span><span class="label label-danger" ng-if="data.pay_reduce > 0">微信支付减免{{data.pay_reduce}}元</span></h5></td><td class="text-center"><h5>订单应付金额</h5></td><td class="text-center"><h5>{{data.final_price}}&nbsp;</h5></td></tr><tr><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>{{data.shop_name}}&nbsp;</h5></td><td class="text-center"><h5>负责销售</h5></td><td class="text-center"><h5>{{data.sale.role}}：{{data.sale.name}} {{data.sale.mobile}}</h5></td></tr><tr><td class="text-center"><h5>客户类型</h5></td><td class="text-center"><h5>{{data.customer_type}}</h5></td><td class="text-center"><h5>客户备注</h5></td><td class="text-left"><h5>{{data.remarks}}&nbsp;</h5></td></tr></tbody></table><table class="table table-bordered table-striped" ng-repeat="suborder in data.suborders"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center" colspan="5"><span class="pull-left label label-info">子订单内部编号：{{suborder.id}}</span><h5>订单内容</h5></td></tr><tr><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>结算单价</strong></h5></td><td class="text-center"><h5><strong>单价</strong></h5></td><td class="text-center"><h5><strong>数量</strong></h5></td><td class="text-center"><h5><strong>小计</strong></h5></td></tr><tr ng-repeat="item in suborder.products"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><h5>{{item.single_price}}元/{{item.close_unit}}</h5></td><td class="text-center"><h5>{{item.price}}元</h5></td><td class="text-center"><h5>{{item.quantity}}{{item.unit_id}}</h5></td><td class="text-center"><h5>{{item.sum_price}}元</h5></td></tr></tbody></table></div><div class="col-xs-12 btn-group form-group"><button style="background:black" class="btn col-xs-3 btn-lg btn-primary pull-left" ng-click="setRemark();">添加工作人员备注</button> <button class="btn col-xs-3 btn-lg btn-primary pull-left" ng-click="setStatus(\'confirm\');" ng-if="data.status == 2">审核通过</button> <button class="btn col-xs-3 btn-lg btn-warning pull-left" ng-if="deliver_flag" ng-click="setDeliverTime();">修改配送时间</button> <button class="btn col-xs-3 btn-lg btn-info pull-left" ng-if="data.pay_type == 1 && data.pay_status == 0" ng-click="change_pay_type(data.id);">修改支付方式</button> <button class="btn col-xs-3 btn-lg btn-danger pull-left" ng-click="setStatus(\'cancel\');" ng-if="data.status == 2 || data.status == 3">取消订单</button> <button class="btn col-xs-3 btn-lg btn-success pull-left" ng-click="back();">返回</button></div></div></div></div>'),t.put("app/modules/order/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>修改订单：</h4><h4>内部编号：{{data.id}}</h4><h4>订单编号：{{data.order_number}}</h4><h5 style="margin-top:10px;">状态：{{data.status_cn}}</h5></div><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form"><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>客户名称</h5></td><td class="text-center"><h5>{{data.realname}}</h5></td><td class="text-center"><h5>电话</h5></td><td class="text-center"><h5>{{data.mobile}}</h5></td></tr><tr><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>{{data.shop_name}}&nbsp;</h5></td><td class="text-center"><h5>送货地点</h5></td><td class="text-center"><h5>{{data.deliver_addr}}</h5></td></tr><tr><td class="text-center"><h5>下单时间</h5></td><td class="text-center"><h5>{{data.created_time}}&nbsp;</h5></td><td class="text-center"><h5>订单金额</h5></td><td class="text-center"><h5>{{data.total_price}}&nbsp;元</h5></td></tr><tr><td class="text-center"><h5>送货日期</h5></td><td class="text-center form-group"><select class="input-lg w100" ng-model="data.deliver_date" ng-options="m.name for m in dates" ng-change="dateChange();" required=""><option value="">请选择送货日期</option></select></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><select class="input-lg w100" ng-model="data.deliver_time" ng-options="m.msg for m in times" required=""><option value="">请选择送货时间</option></select></td></tr><tr><td class="text-center"><h5>订单备注</h5></td><td class="text-left" colspan="3"><h5>{{data.remarks}}&nbsp;</h5></td></tr></tbody></table><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center" colspan="4"><h5>订单内容</h5></td></tr><tr><td class="text-center"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>单价</strong></h5></td><td class="text-center"><h5><strong>数量</strong></h5></td><td class="text-center"><h5><strong>小计</strong></h5></td></tr><tr ng-repeat="item in data.detail"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><h5>{{item.price}}元</h5></td><td class="text-center"><h5>{{item.quantity}}</h5></td><td class="text-center"><h5>{{item.sum_price}}元</h5></td></tr></tbody></table></div><div class="col-xs-12 btn-group form-group"><button class="btn col-xs-3 btn-lg btn-danger pull-left" ng-click="edit();" ng-if="deliver_flag">确认修改</button> <button class="btn col-xs-3 btn-lg btn-success" ng-click="back();">返回</button></div></form></div></div></div>'),t.put("app/modules/order/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>订单列表</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'-1\');" ng-class="{\'btn-info\': status == \'-1\'}" class="btn">全部 <span class="badge">{{total[-1]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">待审核 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已完成 <span class="badge">{{total[1]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已关闭 <span class="badge">{{total[0]}}</span></a> <a ng-click="filterByStatus(\'7\');" ng-class="{\'btn-info\': status == \'7\'}" class="btn">已退货 <span class="badge">{{total[7]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group" style="margin-left:10px;"><button class="btn btn-block btn-danger" ng-click="confirmZip()">生成出库单</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5>内部编号</h5></td><td class="text-center" width="5%"><h5>子订单</h5></td><td class="text-center" width="12%"><h5>订单编号</h5></td><td class="text-center" width="8%"><h5>客户姓名</h5></td><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="15%"><h5>送货地址</h5></td><td class="text-center" width="10%"><h5>送货时间</h5></td><td class="text-center" width="5%"><h5>订单金额</h5></td><td class="text-center" width="5%"><h5>应付金额</h5></td><td class="text-center" width="5%"><h5>订单状态</h5></td><td class="text-center" width="10%"><h5>支付状态</h5></td><td class="text-center" width="5%"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="13" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5 ng-repeat="suborder in item.suborders"><a ng-href="order/subDetail/{{suborder.order_number}}">{{suborder.id}}</a></h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5><a ng-href="/user/dynamic/{{item.user_id}}">{{item.mobile}}</a></h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5><h5><span class="label label-warning" ng-if="item.deliver_fee > 0">运费{{item.deliver_fee}}元</span></h5><h5><span class="label label-warning" ng-if="item.pay_reduce > 0">支付减免{{item.pay_reduce}}元</span></h5></td><td class="text-center"><h5>{{item.final_price}}</h5></td><td class="text-center"><h5 class="label {{item.class}}">{{item.status_cn}}</h5></td><td class="text-center"><div ng-if="item.pay_type == 1 && item.pay_status == 0"><h5>微信支付</h5><h5 class="label label-warning">未支付</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == 1"><h5>微信支付</h5><h5 class="label label-success">支付成功</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == -1"><h5>微信支付</h5><h5 class="label label-danger">支付失败</h5></div><h5 class="label label-info" ng-if="item.pay_type == 0">货到付款</h5></td><td class="text-center"><h5><a ng-click="getpage()" ng-href="order/detail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/order/listAudit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>待审核订单列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5>内部编号</h5></td><td class="text-center" width="5%"><h5>子订单</h5></td><td class="text-center" width="12%"><h5>订单编号</h5></td><td class="text-center" width="8%"><h5>客户姓名</h5></td><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="15%"><h5>送货地址</h5></td><td class="text-center" width="10%"><h5>送货时间</h5></td><td class="text-center" width="5%"><h5>订单金额</h5></td><td class="text-center" width="5%"><h5>应付金额</h5></td><td class="text-center" width="5%"><h5>订单状态</h5></td><td class="text-center" width="10%"><h5>支付状态</h5></td><td class="text-center" width="5%"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="13" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5 ng-repeat="suborder in item.suborders"><a ng-href="order/subDetail/{{suborder.order_number}}">{{suborder.id}}</a></h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5><a ng-href="/user/dynamic/{{item.user_id}}">{{item.mobile}}</a></h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5><h5><span class="label label-warning" ng-if="item.deliver_fee > 0">运费{{item.deliver_fee}}元</span></h5><h5><span class="label label-warning" ng-if="item.pay_reduce > 0">支付减免{{item.pay_reduce}}元</span></h5></td><td class="text-center"><h5>{{item.final_price}}</h5></td><td class="text-center"><h5 class="label label-success">{{item.status_cn}}</h5></td><td class="text-center"><div ng-if="item.pay_type == 1 && item.pay_status == 0"><h5>微信支付</h5><h5 class="label label-warning">未支付</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == 1"><h5>微信支付</h5><h5 class="label label-success">支付成功</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == -1"><h5>微信支付</h5><h5 class="label label-danger">支付失败</h5></div><h5 class="label label-info" ng-if="item.pay_type == 0">货到付款</h5></td><td class="text-center"><h5><a ng-href="order/detail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/order/subDetail.html",'<div class="container-fluid"><script type="text/ng-template" id="set_status.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h3 class="text-left">{{items.bodyText}}</h3> <div class="form-group" ng-if="items.status == 0"> <select ng-model="items.remark" class="form-control" name="remark" ng-options="m.msg for m in items.reasonList"> <option value=""> 请选择关闭理由 </option> </select> </div> <div class="form-group" ng-if="(items.order.status == 6 || items.order.status == 5) || (items.status == 0 && items.remark.code == 6)"> 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.sign_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.sign_msg, items.remark);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><script type="text/ng-template" id="set_remark.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> <div class="form-group" > 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.remark_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.remark_msg);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><script type="text/ng-template" id="set_time.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-left">{{items.bodyText}}</h2> <div class="form-group"> <select ng-model="items.deliver_date" class="input-lg w100" name="items.deliver_date" ng-options="m.name for m in items.deliver_times" required> <option value="">请选择送货日期</option> </select> <select class="input-lg w100" ng-model="items.deliver_time" ng-options="m.msg for m in items.deliver_date.time" required> <option value="">请选择送货时间</option> </select> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.deliver_date,items.deliver_time);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>母订单：<a ng-href="order/detail/{{data.main_order_number}}">{{data.order_id}}</a></h4><h4>内部编号：{{data.id}}</h4><h4>订单编号：{{data.order_number}}</h4><h5 style="margin-top:10px;">状态：{{data.status_cn}}</h5></div><div class="row text-center" ng-if="data==\'\'"><h5>暂无记录</h5></div><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>客户名称</h5></td><td class="text-center"><h5>{{data.realname}}</h5></td><td class="text-center"><h5>电话</h5></td><td class="text-center"><h5>{{data.mobile}}</h5></td></tr><tr><td class="text-center"><h5>送货地点</h5></td><td class="text-center"><h5>{{data.deliver_addr}}</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>{{data.deliver_date}} {{data.deliver_time}}</h5></td></tr><tr><td class="text-center"><h5>下单时间</h5></td><td class="text-center"><h5>{{data.created_time}}&nbsp;</h5></td><td class="text-center"><h5>订单线路</h5></td><td class="text-center"><h5>{{data.line}}&nbsp;</h5></td></tr><tr><td class="text-center"><h5>订单金额</h5></td><td class="text-center"><h5>{{data.total_price}}&nbsp;元&nbsp;<span class="label label-danger" ng-if="data.minus_amount > 0">优惠{{data.minus_amount}}元</span><span class="label label-warning" ng-if="data.deliver_fee > 0">运费{{data.deliver_fee}}元</span><span class="label label-danger" ng-if="data.pay_reduce > 0">微信支付减免{{data.pay_reduce}}元</span></h5></td><td class="text-center"><h5>订单应付金额</h5></td><td class="text-center"><h5>{{data.final_price}}&nbsp;</h5></td></tr><tr><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>{{data.shop_name}}&nbsp;</h5></td><td class="text-center"><h5>负责销售</h5></td><td class="text-center"><h5>{{data.sale.role}}：{{data.sale.name}} {{data.sale.mobile}}</h5></td></tr><tr><td class="text-center"><h5>客户类型</h5></td><td class="text-center"><h5>{{data.customer_type_name}}</h5></td><td class="text-center"><h5>客户备注</h5></td><td class="text-left"><h5>{{data.remarks}}&nbsp;</h5></td></tr></tbody></table><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody ng-if="data.status != 6"><tr><td class="text-center" colspan="5"><h5>订单内容</h5></td></tr><tr><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>结算单价</strong></h5></td><td class="text-center"><h5><strong>单价</strong></h5></td><td class="text-center"><h5><strong>数量</strong></h5></td><td class="text-center"><h5><strong>小计</strong></h5></td></tr><tr ng-repeat="item in data.detail"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><h5>{{item.single_price}}元/{{item.close_unit}}</h5></td><td class="text-center"><h5>{{item.price}}元</h5></td><td class="text-center"><h5>{{item.quantity}}{{item.unit_id}}</h5></td><td class="text-center"><h5>{{item.sum_price}}元</h5></td></tr></tbody></table><table class="table table-bordered table-striped"><tbody ng-if="data.status == 6"><tr><td class="text-center" colspan="4"><h5>订单内容</h5></td></tr><tr><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>实收单价</strong></h5></td><td class="text-center"><h5><strong>实收数量</strong></h5></td><td class="text-center"><h5><strong>实收小计</strong></h5></td></tr><tr ng-repeat="item in data.detail" ng-if="data.status == 6"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="item.price" readonly="readonly"> <span class="input-group-addon">元</span></div></td><td class="text-center"><div class="input-group input-group-sm"><span class="input-group-addon"><em class="glyphicon glyphicon-minus text-primary" ng-click="minus(item)"></em></span> <input type="text" class="form-control text-center" ng-model="item.quantity" ng-focus="clearNum(item)" ng-blur="setNum(item, true)" ng-change="setNum(item)"> <span class="input-group-addon"><em class="glyphicon glyphicon-plus text-primary" ng-click="plus(item)"></em></span></div></td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="item.sum_price" readonly="readonly"> <span class="input-group-addon">元</span></div></td></tr><tr><td></td><td></td><td class="text-center">实收金额总计:</td><td class="text-center"><div class="input-group"><span class="input-group-addon">￥</span> <input type="text" class="form-control text-center" ng-model="deal_price.key" readonly="readonly"> <span class="input-group-addon">元</span></div></td></tr></tbody></table><table class="table table-bordered table-striped"><tbody ng-if="data.status == 6 || data.status== 1"><tr class="success"><td class="text-center" colspan="4"><h5>订单内容</h5></td></tr><tr class="success"><td class="text-center col-xs-5"><h5><strong>商品名称</strong></h5></td><td class="text-center"><h5><strong>实收单价</strong></h5></td><td class="text-center"><h5><strong>实收数量</strong></h5></td><td class="text-center"><h5><strong>实收小计</strong></h5></td></tr><tr ng-repeat="item in data.detail" class="success"><td class="text-center"><h5>{{item.name}}</h5><span class="text-warning"><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></td><td class="text-center"><h5>{{item.actual_price}}元</h5></td><td class="text-center"><h5>{{item.actual_quantity}}</h5></td><td class="text-center"><h5>{{item.actual_sum_price}}元</h5></td></tr><tr class="success"><td></td><td></td><td class="text-center">实收金额总计:</td><td class="text-center">{{data.deal_price}}</td></tr></tbody></table></div><div class="col-xs-12 btn-group form-group"><button style="background:black" class="btn col-xs-3 btn-lg btn-primary pull-left" ng-click="setRemark(data.id, 18);">添加工作人员备注</button> <button class="btn col-xs-3 btn-lg btn-info pull-left" ng-click="setStatus(\'delivering\');" ng-if="(data.status == 3 || data.status == 13 || data.status == 14) && !is_operate">已发货</button> <button class="btn col-xs-3 btn-lg btn-warning pull-left" ng-click="setStatus(\'signed\');" ng-if="(data.status == 5 || data.status == 8) && !is_operate">已签收</button> <button class="btn col-xs-3 btn-lg btn-danger pull-left" ng-click="setStatus(\'delivering\');" ng-if="data.status == 1 && !is_operate">修改签收信息</button> <button class="btn col-xs-3 btn-lg btn-danger pull-left" ng-click="setStatus(\'rejected\');" ng-if="data.status == 5 && !is_operate">已退货</button> <button class="btn col-xs-3 btn-lg btn-danger pull-left" ng-click="setStatus(\'success\');" ng-if="data.status == 6 && !is_operate">已回款</button> <button class="btn col-xs-3 btn-lg btn-warning pull-left" ng-if="deliver_flag" ng-click="setDeliverTime();">修改配送时间</button> <button class="btn col-xs-3 btn-lg btn-success pull-left" ng-click="back();">返回</button></div><table class="table table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-6"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center" colspan="3"><h5>订单动态</h5></td></tr><tr><td class="text-center"><h5><strong>处理时间</strong></h5></td><td class="text-center"><h5><strong>处理信息</strong></h5></td><td class="text-center"><h5><strong>操作人</strong></h5></td></tr><tr ng-repeat="item in data.log_list"><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5>{{item.log_info}}<span ng-if="item.remark">备注：{{item.remark}}</span></h5></td><td class="text-center"><h5>{{item.operator_type_cn}}[{{item.operator}}]</h5></td></tr></tbody></table></div></div></div>'),t.put("app/modules/order/sublist.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>子订单列表</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'-1\');" ng-class="{\'btn-info\': status == \'-1\'}" class="btn">全部 <span class="badge">{{total[-1]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">待审核 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'3\');" ng-class="{\'btn-info\': status == \'3\'}" class="btn">待生产 <span class="badge">{{total[3]}}</span></a> <a ng-click="filterByStatus(\'11\');" ng-class="{\'btn-info\': status == \'11\'}" class="btn">波次中 <span class="badge">{{total[11]}}</span></a> <a ng-click="filterByStatus(\'12\');" ng-class="{\'btn-info\': status == \'12\'}" class="btn">待分拣 <span class="badge">{{total[12]}}</span></a> <a ng-click="filterByStatus(\'13\');" ng-class="{\'btn-info\': status == \'13\'}" class="btn">已复核 <span class="badge">{{total[13]}}</span></a> <a ng-click="filterByStatus(\'14\');" ng-class="{\'btn-info\': status == \'14\'}" class="btn">已分拨 <span class="badge">{{total[14]}}</span></a> <a ng-click="filterByStatus(\'5\');" ng-class="{\'btn-info\': status == \'5\'}" class="btn">已出库 <span class="badge">{{total[5]}}</span></a> <a ng-click="filterByStatus(\'8\');" ng-class="{\'btn-info\': status == \'8\'}" class="btn">已装车 <span class="badge">{{total[8]}}</span></a> <a ng-click="filterByStatus(\'6\');" ng-class="{\'btn-info\': status == \'6\'}" class="btn">已签收 <span class="badge">{{total[6]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已完成 <span class="badge">{{total[1]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已关闭 <span class="badge">{{total[0]}}</span></a> <a ng-click="filterByStatus(\'7\');" ng-class="{\'btn-info\': status == \'7\'}" class="btn">已退货 <span class="badge">{{total[7]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">订单类别</div><select class="form-control" ng-model="orderType" ng-options="m.msg for m in orderTypeList"><option value="">请选择订单类别</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group" style="margin-left:10px;"><button class="btn btn-block btn-danger" ng-click="confirmZip()">生成出库单</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5>内部编号</h5></td><td class="text-center" width="5%"><h5>母订单</h5></td><td class="text-center" width="12%"><h5>订单编号</h5></td><td class="text-center" width="8%"><h5>客户姓名</h5></td><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="15%"><h5>送货地址</h5></td><td class="text-center" width="10%"><h5>送货时间</h5></td><td class="text-center" width="5%"><h5>订单金额</h5></td><td class="text-center" width="5%"><h5>应付金额</h5></td><td class="text-center" width="5%"><h5>订单状态</h5></td><td class="text-center" width="10%"><h5>支付状态</h5></td><td class="text-center" width="5%"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="12" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5><a ng-href="order/detail/{{item.main_order_number}}">{{item.order_id}}</a></h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5><a ng-href="/user/dynamic/{{item.user_id}}">{{item.mobile}}</a></h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5><h5><span class="label label-warning" ng-if="item.deliver_fee > 0">运费{{item.deliver_fee}}元</span></h5><h5><span class="label label-warning" ng-if="item.pay_reduce > 0">支付减免{{item.pay_reduce}}元</span></h5></td><td class="text-center"><h5>{{item.final_price}}</h5></td><td class="text-center"><h5 class="label {{item.class}}">{{item.status_cn}}</h5></td><td class="text-center"><div ng-if="item.pay_type == 1 && item.pay_status == 0"><h5>微信支付</h5><h5 class="label label-warning">未支付</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == 1"><h5>微信支付</h5><h5 class="label label-success">支付成功</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == -1"><h5>微信支付</h5><h5 class="label label-danger">支付失败</h5></div><h5 class="label label-info" ng-if="item.pay_type == 0">货到付款</h5></td><td class="text-center"><h5><a ng-click="getpage()" ng-href="order/subDetail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/order/sublistDeliver.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>待生产子订单列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><div class="row"><div class="col-xs-2"><div class="input-group"><div class="input-group-addon">订单类别</div><select class="form-control" ng-model="orderType" ng-options="m.msg for m in orderTypeList"><option value="">请选择订单类别</option></select></div></div><div class="col-xs-2"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-model="city" ng-options="m.name for m in cityList"><option value="">请选择城市</option></select></div></div><div class="col-xs-2"><div class="input-group"><div class="input-group-addon">送货日期</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" min-mode="day" class="form-control" ng-model="dateValue" id="dateValue" placeholder="点击获取时间"></div></div><div class="col-xs-2"><div class="input-group"><div class="input-group-addon">时段</div><select class="form-control" ng-model="time" ng-options="m.val for m in timeList"><option value="">请选择</option></select></div></div><div class="col-xs-2"><a class="btn btn-block btn-primary" target="_blank" ng-click="downloadAll()">导出订单汇总表</a></div><div class="col-xs-2"><a class="btn btn-block btn-primary" target="_blank" ng-click="downloadDetail()">导出本次出库单</a></div></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5>内部编号</h5></td><td class="text-center" width="5%"><h5>母订单</h5></td><td class="text-center" width="12%"><h5>订单编号</h5></td><td class="text-center" width="8%"><h5>客户姓名</h5></td><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="15%"><h5>送货地址</h5></td><td class="text-center" width="10%"><h5>送货时间</h5></td><td class="text-center" width="5%"><h5>订单金额</h5></td><td class="text-center" width="5%"><h5>订单状态</h5></td><td class="text-center" width="5%"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="11" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5><a ng-href="order/detail/{{item.main_order_number}}">{{item.order_id}}</a></h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5><h5><span class="label label-warning" ng-if="item.deliver_fee > 0">运费{{item.deliver_fee}}元</span></h5><h5><span class="label label-warning" ng-if="item.pay_reduce > 0">支付减免{{item.pay_reduce}}元</span></h5></td><td class="text-center"><h5 class="label label-success">{{item.status_cn}}</h5></td><td class="text-center"><h5><a ng-click="getpage()" ng-href="order/subDetail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/order/sublistPayment.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>待回款子订单列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5>内部编号</h5></td><td class="text-center" width="5%"><h5>母订单</h5></td><td class="text-center" width="12%"><h5>订单编号</h5></td><td class="text-center" width="8%"><h5>客户姓名</h5></td><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="15%"><h5>送货地址</h5></td><td class="text-center" width="10%"><h5>送货时间</h5></td><td class="text-center" width="5%"><h5>订单金额</h5></td><td class="text-center" width="5%"><h5>订单状态</h5></td><td class="text-center" width="5%"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="11" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5><a ng-href="order/detail/{{item.main_order_number}}">{{item.order_id}}</a></h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5><h5><span class="label label-warning" ng-if="item.deliver_fee > 0">运费{{item.deliver_fee}}元</span></h5><h5><span class="label label-warning" ng-if="item.pay_reduce > 0">支付减免{{item.pay_reduce}}元</span></h5></td><td class="text-center"><h5 class="label label-success">{{item.status_cn}}</h5></td><td class="text-center"><h5><a ng-href="order/subDetail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/order/sublistSign.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>待签收子订单列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td class="text-center"><h5>内部编号</h5></td><td class="text-center"><h5>订单编号</h5></td><td class="text-center"><h5>客户姓名</h5></td><td class="text-center"><h5>客户电话</h5></td><td class="text-center"><h5>店铺名称</h5></td><td class="text-center"><h5>送货地址</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>订单金额</h5></td><td class="text-center"><h5>订单状态</h5></td><td class="text-center"><h5>订单内容</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="9" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5></td><td class="text-center"><h5 class="label label-success">{{item.status_cn}}</h5></td><td class="text-center"><h5><a ng-href="order/subDetail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div></div>'),t.put("app/modules/orderMap/index.html",'<div class="col-xs-offset-2 container-fluid"><div class="col-md-8 amp-info"><div class="row amap-wrap"><div class="btn-group m-10 col-md-12"><a class="btn btn-default" ng-class="{true:\'btn btn-primary\', false:\'btn btn-default\'}[viewShow==\'list\']" ng-click="viewFn(\'list\')">列表</a> <a class="btn btn-default" ng-class="{true:\'btn btn-primary\', false:\'btn btn-default\'}[viewShow==\'map\']" ng-click="viewFn(\'map\')">地图</a></div><div class="col-md-12"><div class="clearfix"><div class="btn-group" role="group" aria-label="..."><button type="button" class="btn btn-default">共{{orderdata.orderlen}}个订单</button> <button type="button" class="btn btn-success">已分配{{orderdata.successlen}}单</button> <button type="button" class="btn btn-info">未分配{{orderdata.orderlen - orderdata.successlen}}单</button></div><div class="bg-danger mt-10" style="padding:10px" ng-if="geolist.length > 0">此用户没有坐标地址：<span class="mr-10" ng-repeat="m in geolist">{{m}}</span></div></div><div class="form-inline mt-10"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select class="form-control" ng-change="switchCity()" ng-model="city" ng-options="m.name for m in cityList" required=""><option value="">请选择城市</option></select></div><div class="input-group"><div class="input-group-addon">订单类别</div><select class="form-control" ng-model="orderType" ng-options="m.msg for m in orderTypeList"><option value="">请选择订单类别</option></select></div><div class="input-group"><select class="form-control" style="max-width:400px;" ng-model="router" ng-options="router.name for router in lineListCur"><option value="">请选择路线</option></select></div><div class="input-group"><div class="input-group-addon">日期</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" min-mode="day" class="form-control" ng-model="dateValue" placeholder="点击获取时间" required=""></div><div class="input-group"><div class="input-group-addon">时段</div><select class="form-control" ng-model="time" ng-options="m.val for m in timeList" required=""><option value="">请选择</option></select></div><div class="input-group"><button type="button" ng-click="mapfilter()" class="btn btn-success">筛选</button></div></div></div></div><div class="col-xs-12" ng-show="viewShow == \'map\'"><div id="mapContainer" class="mt-10" map="" style="width:100% ;height:700px;"></div></div><div id="list" class="" ng-show="viewShow == \'list\'"><div class="col-xs-12 ml-default"><div class="form-inline"><div class="mt-10 pr-0"><div class="input-group pr-0 pglobal-search col-xs-5"><input type="text" class="form-control full-right" ng-model="orderdata.filter.id" placeholder="请输入分拣单号"> <label for="" class="input-group-addon">分拣单号号搜索</label></div><div class="input-group global-search col-xs-5 mr-10"><input type="text" class="form-control full-right" ng-model="orderdata.filter.order_number" placeholder="请输入订单编号"> <label for="" class="input-group-addon">订单编号搜索</label></div></div></div></div><div class="mt-10 col-xs-12 table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1" ng-if="!init.release"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-1"></colgroup><thead><tr><td class="text-center" ng-if="!init.release"><div class="checkbox"><label><input type="checkbox" ng-change="selectAll()" ng-model="isAll"></label></div></td><td class="text-center"><h5>订单id</h5></td><td class="text-center"><h5>订单线路</h5></td><td class="text-center"><h5>送货地址</h5></td><td class="text-center"><h5>送货时间</h5></td><td class="text-center"><h5>货品名称</h5></td><td class="text-center"><h5>规格</h5></td><td class="text-center"><h5>数量</h5></td></tr></thead><tbody ng-if="orderdata.data.length===0"><tr><td colspan="9" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-repeat="item in orderdata.data|filter:orderdata.filter"><tr ng-repeat="detail in item.detail"><td ng-if="$index == 0" rowspan="{{item.detail.length}}" class="text-center"><div class="checkbox"><label><input ng-disabled="item.ngDisabled" ng-click="checked(item)" type="checkbox" ng-model="item.isChecked"></label></div></td><td ng-if="$index == 0" rowspan="{{item.detail.length}}" class="text-center"><h5>{{item.id}}</h5></td><td ng-if="$index == 0" rowspan="{{item.detail.length}}" class="text-center"><h5>{{item.line}}</h5></td><td ng-if="$index == 0" rowspan="{{item.detail.length}}" class="text-center"><h5>{{item.deliver_addr}}</h5></td><td ng-if="$index == 0" rowspan="{{item.detail.length}}" class="text-center"><h5>{{item.deliver_date}} {{item.deliver_time}}</h5></td><td><small>{{detail.name}}</small></td><td><small><span ng-repeat="spec in detail.spec" ng-show="spec.name != \'描述\'">{{spec.name}}：{{spec.val}}<span></span></span></small></td><td><h5>{{detail.quantity}}{{detail.unit_id}}</h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div><div class="col-md-4 maplist" style="overflow:auto;"><div class="row"><div class="clearfix"><h3><button type="button" class="btn btn-success pull-right" ng-click="listOk()">加入待配送列表</button> 已选订单</h3></div><div class="gray-title"><span>已选{{orderList.length}}单</span> <span>{{sum}}行</span> <span>{{quantity}}件</span> <span>{{customerSum}}个客户</span></div></div><dl class="maporderdl" as-sortable="sortableOptions" data-ng-model="orderList"><dt class="maporderdt"><div class="row"><div class="col-md-2"></div><div class="col-md-9"><div class="row" ng-if="orderList.length == 0">您还没有选择任何订单</div><div class="row" ng-if="orderList.length > 0"><div class="col-md-3">订单id</div><div class="col-md-3">客户id</div><div class="col-md-3">线路</div><div class="col-md-3">店名</div></div></div></div></dt><dd ng-repeat="order in orderList" data-as-sortable-item=""><div class="row orderlistrow" data-as-sortable-item-handle=""><button type="button" class="close" aria-label="Close" ng-click="removelist(order.id,order.model,order.sum,order.quantity)"><span aria-hidden="true">&times;</span></button><div class="col-md-2 map-number">{{$index +1}}</div><div class="col-md-9" ng-click="orderdetail(order.detail)"><div class="row"><div class="clearfix"><div class="col-md-3">{{order.id}}</div><div class="col-md-3">{{order.userId}}</div><div class="col-md-6">{{order.line}}</div></div><p>{{order.address}} {{order.store}}</p></div></div></div></dd></dl><div class="bg-success count-bg m-10">一共{{orderdata.success.length}}个配送单</div><div class="list-group" ng-if="orderdata.success.length > 0"><table class="table table-striped table-condensed"><thead><tr><th>序号</th><th>线路</th><th>客户数</th><th>单数</th><th>行数</th><th>件数</th><th></th></tr></thead><tbody><tr ng-repeat="success in orderdata.success"><th>{{$index + 1}}</th><td>{{success.line}}</td><td>{{success.customersum}}</td><td>{{success.len}}</td><td>{{success.sum}}</td><td>{{success.quantity}}</td><td><button type="button" class="close" ng-click="removeorder($index,success.model,success.date,success.id , success.len)" aria-label="Close"><span aria-hidden="true">&times;</span></button></td></tr></tbody></table><button ng-click="maporderOk(orderdata.success)" type="button" class="btn btn-success pull-right">生成配送单</button></div></div></div><div></div><script type="text/ng-template" id="dist.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}} <select ng-model="deliver_time" class="form-control" name="deliver_time"> <option value="">请选择配送时间</option> <option value="1">上午</option> <option value="2">下午</option> </select> </h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(deliver_time);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/pick/detail.html",'<div class="container-fluid"><script type="text/ng-template" id="set_status.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> <div class="form-group" ng-if="items.order.status == 6 || items.order.status == 5"> 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.sign_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.sign_msg);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>任务编号：{{info.id}}</h4><h5>波次编号：{{info.wave_id}}</h5><h5>所属系统：{{info.site_src}}</h5><h5>配送线路：{{info.line_name}}</h5><h5>任务状态：{{info.status_name}}</h5></div><table class="table table-bordered table-striped"><colgroup><col class="col-xs-2"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-1"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>sku号</h5></td><td class="text-center"><h5>名称</h5></td><td class="text-center"><h5>规格</h5></td><td class="text-center"><h5>总数量</h5></td><td class="text-center"><h5>单位</h5></td></tr><tr ng-repeat="item in skuList"><td class="text-center"><h5>{{item.sku_number}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5 ng-repeat="spec in item.spec">{{spec.name}}: {{spec.val}}</h5></td><td class="text-center"><h5>{{item.quantity}}</h5></td><td class="text-center"><h5>{{item.unit_name}}</h5></td></tr></tbody></table><div class="col-xs-12 btn-group form-group"><button class="btn col-xs-12 btn-lg btn-primary" ng-click="finishTask()" ng-if="info.status == 1">分拣完成</button></div></div></div></div>'),t.put("app/modules/pick/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>分拣任务列表</h5></div><div class="bs-callout"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[-1]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">未开始 <span class="badge">{{total[1]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">已完成 <span class="badge">{{total[2]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">订单类型</div><select class="form-control" ng-model="order_type" ng-options="m.msg for m in order_types"><option value="">请选择订单类型</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">所属城市</div><select ng-model="city" class="form-control" ng-options="m.name for m in cities"><option value="">选择所属城市</option></select></div></div><div class="input-group"><span class="input-group-addon">分拣单号</span> <input type="text" class="form-control" ng-model="init.pickNo"></div><div class="input-group"><span class="input-group-addon">波次号</span> <input type="text" class="form-control" ng-model="init.waveId"></div><div class="input-group"><span class="input-group-addon">任务号</span> <input type="text" class="form-control" ng-model="init.pickTaskId"></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><a class="btn btn-block btn-danger" ng-click="print()">打印</a></div></form></div></div><div style="margin-top:10px;" class="table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5><input type="checkbox" ng-click="checkAll();" ng-model="check_all"></h5></td><td class="text-center"><h5>分拣单号</h5></td><td class="text-center"><h5>任务号</h5></td><td class="text-center"><h5>波次号</h5></td><td class="text-center"><h5>所属城市</h5></td><td class="text-center"><h5>订单类别</h5></td><td class="text-center"><h5>任务状态</h5></td><td class="text-center"><h5>sku总数</h5></td><td class="text-center"><h5>线路</h5></td><td class="text-center"><h5>开始时间</h5></td><td class="text-center"><h5>结束时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="11" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5><input type="checkbox" ng-model="item.checked"></h5></td><td class="text-center"><h5>{{item.pick_number}}</h5></td><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.wave_id}}</h5></td><td class="text-center"><h5>{{item.city_name}}</h5></td><td class="text-center"><h5>{{item.order_type_name}}</h5></td><td class="text-center"><h5>{{item.status_name}}</h5></td><td class="text-center"><h5>{{item.sku_count}}</h5></td><td class="text-center"><h5>{{item.line_name}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ui-sref="home.pickTaskDetail({task_id:item.id})" class="btn btn-info btn-sm btn_mb5">详情</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>'),t.put("app/modules/printpage/printPickTask.html",'<div class="container-fluid"><style>\n    @page{\n      size:A4 portrait;\n    }\n  </style><div class="printpage direction" ng-repeat="items in list"><div class="orderinfo"><div class="row"><div class="col-xs-4"><p>分拣单号:{{items.pick_number}}</p><p class="">线路（片区）:{{items.line_name}}</p><p>订单数：{{items.orders.length}}</p></div><div class="col-xs-4"><p>分拣单</p><img src="{{items.barcode}}"></div><div class="col-xs-4"><p>仓库：{{items.warehouse_name}}</p><p>波次号：{{items.wave_id}}</p><p>配送时间：{{items.deliver_date}}</p></div></div><div class="order_print_table"><table class="table table-condensed table-bordered table-striped"><colgroup><col class="col-xs-1"><col class="col-xs-3"><col class="col-xs-5"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td>货品号</td><td>产品名称</td><td>规格</td><td>结算单价</td><td>订货数量</td><td>重量</td></tr></thead><tbody><tr ng-repeat="detail in items.sku_list"><td>{{detail.sku_number}}</td><td>{{detail.name}}</td><td><small ng-repeat="spec in detail.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></td><td>{{detail.single_price}}/{{detail.close_unit}}</td><td>{{detail.quantity}}{{detail.unit_id}}</td><td></td></tr><tr><td>汇总</td><td colspan="3"></td><td>{{items.sku_total_count}}</td><td></td></tr></tbody></table></div><div class="all_count"><a href="javascript:;" onclick="window.print()" class="hidden-print btn-lg btn-success">打印</a></div></div></div></div>'),t.put("app/modules/printpage/printpage.html",'<div class="container-fluid"><a href="javascript:;" ng-click="printmap()" class="hidden-print btn btn-danger">{{text}}</a><div class="printpage" ng-repeat="items in list"><div class="orderinfo"><div class="row"><div class="col-xs-4"><p>配送线路单号:{{items.dist_number}} &nbsp;&nbsp;&nbsp;&nbsp;司机提货码：{{items.id}}</p><p class="">线路（片区）:{{items.line_name}}</p><p>客户数：{{items.user_count}} &nbsp;&nbsp;&nbsp;&nbsp; 订单数：{{items.orders.length}} &nbsp;&nbsp;&nbsp;&nbsp; 总件数：{{items.sku_count}}</p><p>仓库：{{items.warehouse_name}}</p><p>发车时间：{{items.deliver_date}} {{items.deliver_time == 1 ? \'上午\' : \'下午\'}}</p></div><div class="col-xs-4"><p>配送线路单</p><img ng-src="{{items.barcode}}"></div><div class="col-xs-4"><p>司机提货码：{{items.id}}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;安卓手机 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 苹果手机</p><img src="http://qr.liantu.com/api.php?w=100&m=0&text=http://www.dachuwang.com/siji_download.html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="http://qr.liantu.com/api.php?w=100&m=0&text=http://tms.dachuwang.com"></div></div><div class="order_print_table"><p>订单明细</p><table class="table table-condensed table-bordered table-striped"><thead><tr><td width="5%">订单id</td><td width="8%">线路</td><td width="10%">店铺名称</td><td width="15%">送货地址</td><td width="7%">联系电话</td><td width="8%">客户备注</td><td width="5%">货品号</td><td width="10%">产品名称</td><td width="17%">规格</td><td width="5%">单价</td><td width="5%">订货数量</td><td width="5%">重量</td></tr></thead><tbody ng-repeat="order in items.orders" ng-init="pindex=$index+1"><tr ng-repeat="detail in order.detail"><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.id}}</td><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.line_name}}</td><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.shop_name}}</td><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.deliver_addr}}</td><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.mobile}}</td><td ng-if="$index == 0" rowspan="{{order.detail.length}}">{{order.remarks}}</td><td>{{detail.sku_number}}</td><td>{{detail.name}}</td><td><small><span ng-repeat="spec in detail.spec" ng-show="spec.name != \'描述\'">{{spec.name}}：{{spec.val}}<span></span></span></small></td><td>{{detail.single_price}}/{{detail.close_unit}}</td><td>{{detail.quantity}}{{detail.unit_id}}</td><td></td></tr></tbody><tr><td>汇总</td><td colspan="5"></td><td></td><td></td><td></td><td></td><td>{{items.sku_count}}</td><td></td></tr></table></div><p>货品汇总</p><div class="row sth_block"><div class="col-xs-6"><table class="table table-condensed table-bordered table-striped"><thead><tr><td>货品号</td><td>产品名称</td><td>订货数量</td></tr></thead><tbody><tr class="page_break_after" ng-repeat="detail in items.sku_list"><td>{{detail.sku_number}}</td><td>{{detail.name}}</td><td>{{detail.quantity}}{{detail.unit_id}}</td></tr><tr><td>汇总</td><td colspan="1"></td><td>{{items.sku_count}}</td></tr></tbody></table></div><div class="col-xs-6 sign"><p class="">仓库操作人员签字：</p><p class="">司机操作人员签字：</p><p class="">站点操作人员签字：</p></div></div><div class="clearfix all_count"><a href="javascript:;" onclick="window.print()" class="hidden-print btn btn-success">打印全部</a></div></div><div class="mapimg" ng-class="{\'hidden-print\':!togglemap}" ng-show="togglemap" id="mapContainer"><img ng-src="{{items.map_url}}"></div></div></div>'),t.put("app/modules/privilege/create.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>添加权限</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.name.$error.required">请输入权限名称！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">上级权限：</label><div class="col-sm-10"><select ng-model="data.parent" class="form-control" ng-options="m.pre_name for m in list"><option value="">选择上级权限</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">权限名称：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入权限名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">模块名称：</label><div class="col-sm-10"><input type="text" ng-model="data.module" class="form-control" placeholder="请输入模块名称"></div></div><div class="form-group"><label class="col-sm-2 control-label">资源名称：</label><div class="col-sm-10"><input type="text" ng-model="data.resource" class="form-control" placeholder="请输入资源名称"></div></div><div class="form-group"><label class="col-sm-2 control-label">操作名称：</label><div class="col-sm-10"><input type="text" ng-model="data.operation" class="form-control" placeholder="请输入操作名称"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/privilege/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>编辑权限</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.name.$error.required">请输入权限名称！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">上级权限：</label><div class="col-sm-10"><select ng-model="data.parent" class="form-control" ng-options="m.pre_name for m in list"><option value="">选择上级权限</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">权限名称：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入权限名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">模块名称：</label><div class="col-sm-10"><input type="text" ng-model="data.module" class="form-control" placeholder="请输入模块名称"></div></div><div class="form-group"><label class="col-sm-2 control-label">资源名称：</label><div class="col-sm-10"><input type="text" ng-model="data.resource" class="form-control" placeholder="请输入资源名称"></div></div><div class="form-group"><label class="col-sm-2 control-label">操作名称：</label><div class="col-sm-10"><input type="text" ng-model="data.operation" class="form-control" placeholder="请输入操作名称"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/privilege/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>权限列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><a class="btn btn-primary btn-sm" href="/privilege/create">添加权限</a></div></form></div></div><div style="margin-top:10px;" class="table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5>编号</h5></td><td class="text-center"><h5>权限名称</h5></td><td class="text-center"><h5>模块名称</h5></td><td class="text-center"><h5>资源名称</h5></td><td class="text-center"><h5>操作名称</h5></td><td class="text-center"><h5>权限级别</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="8" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-left"><h5>{{item.pre_name}}</h5></td><td class="text-center"><h5>{{item.module}}</h5></td><td class="text-center"><h5>{{item.resource}}</h5></td><td class="text-center"><h5>{{item.operation}}</h5></td><td class="text-center"><h5>{{item.level}}</h5></td><td class="text-center"><h5><a class="btn btn-info btn-sm" href="/privilege/edit/{{item.id}}">编辑</a> <a class="btn btn-danger btn-sm" ng-click="delete($index)">删除</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>'),t.put("app/modules/role/create.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>添加角色</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.name.$error.required">请输入角色名称！</li><li ng-show="basic_form.dataset.$error.required">请选择数据集权限！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">角色名称：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入角色名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">数据集权限：</label> <label class="radio-inline"><input type="radio" name="dataset" ng-model="data.dataset" value="1" required=""> 个人</label> <label class="radio-inline"><input type="radio" name="dataset" ng-model="data.dataset" value="2" required=""> 部门</label> <label class="radio-inline"><input type="radio" name="dataset" ng-model="data.dataset" value="3" required=""> 全部</label></div><div class="form-group"><label class="col-sm-2 control-label">操作权限：</label><div class="col-sm-10"><div ng-repeat="item in list"><label><input type="checkbox" ng-model="item.checked" ng-change="toggle($index);"> {{item.pre_name}}</label></div></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/role/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>修改角色</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.name.$error.required">请输入角色名称！</li><li ng-show="basic_form.dataset.$error.required">请选择数据集权限！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" name="basic_form" id="basic_form"><div class="form-group"><label class="col-sm-2 control-label">角色名称：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入角色名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">数据集权限：</label> <label class="radio-inline"><input type="radio" name="dataset" ng-model="data.dataset" value="1" required=""> 个人</label> <label class="radio-inline"><input type="radio" name="dataset" ng-model="data.dataset" value="2" required=""> 部门</label> <label class="radio-inline"><input type="radio" name="dataset" ng-model="data.dataset" value="3" required=""> 全部</label></div><div class="form-group"><label class="col-sm-2 control-label">操作权限：</label><div class="col-sm-10"><div ng-repeat="item in list"><label><input type="checkbox" ng-model="item.checked" ng-change="toggle($index);"> {{item.pre_name}}</label></div></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/role/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>角色列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><a class="btn btn-primary btn-sm" href="/role/create">添加角色</a></div></form></div></div><div style="margin-top:10px;" class="table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-5"><col class="col-xs-6"></colgroup><thead><tr><td class="text-center"><h5>编号</h5></td><td class="text-center"><h5>角色名称</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="3" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5><a class="btn btn-info btn-sm" href="/role/edit/{{item.id}}">编辑</a> <a class="btn btn-danger btn-sm" ng-click="delete($index)">删除</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>'),t.put("app/modules/user/create.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>添加用户</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.dept.$error.required">请选择部门！</li><li ng-show="basic_form.role.$error.required">请选择用户角色！</li><li ng-show="basic_form.mobile.$error.required">请输入手机号码！</li><li ng-show="basic_form.mobile.$error.pattern">手机号码格式不对！</li><li ng-show="basic_form.name.$error.required">请输入用户姓名！</li><li ng-show="basic_form.province.$error.required">请选择所在地！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form"><div class="form-group"><label class="col-sm-2 control-label">所属部门：</label><div class="col-sm-10"><select ng-model="data.dept" class="form-control" name="dept" ng-options="m.pre_name for m in dept_list" required=""><option value="">请选择用户所属部门</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">用户角色：</label><div class="col-sm-10"><select ng-model="data.role" class="form-control" name="role" ng-change="change()" ng-options="m.name for m in role_list" required=""><option value="">请选择用户角色类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input type="text" ng-model="data.mobile" name="mobile" class="form-control" placeholder="请输入手机号码" required="" ng-pattern="/^[1-9]{1}[0-9]{10}$/"></div></div><div class="form-group"><label class="col-sm-2 control-label">姓名：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所在地：</label><div class="col-sm-10"><select ng-model="data.province" class="form-control" name="province" ng-options="m.name for m in province_list" ng-change="get_market(\'province\');" required=""><option value="">选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">详细地址：</label><div class="col-sm-10"><input type="text" ng-model="data.address" class="form-control" placeholder="请输入详细地址"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/user/dynamic.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>客户动态</h5></div><tabs><pane title="基本信息"><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><tbody><tr><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="30%"><h5>{{info.shop_name}}</h5></td><td class="text-center" width="10%"><h5>所属系统</h5></td><td class="text-center" width="30%"><h5>{{info.site_name}}</h5></td><td class="text-center" rowspan="3"><image-box url="{{ info.image[0].url }}"><image-modal show="0" url="{{ info.image[0].url}},{{info.image[1].url }}"></image-modal></image-box></td></tr><tr><td class="text-center" width="10%"><h5>客户名称</h5></td><td class="text-center" width="30%"><h5>{{info.name}}</h5></td><td class="text-center" width="10%"><h5>店铺规模</h5></td><td class="text-center" width="30%"><h5>{{info.dimensions_name}}</h5></td></tr><tr><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="30%"><h5>{{info.mobile}}</h5></td><td class="text-center" width="10%"><h5>所属城市</h5></td><td class="text-center" width="30%"><h5>{{info.city_name}}</h5></td></tr><tr><td class="text-center" width="10%"><h5>注册时间</h5></td><td class="text-center" width="30%"><h5>{{info.created_time}}</h5></td><td class="text-center" width="10%"><h5>详细地址</h5></td><td class="text-center" width="30%"><h5>{{info.address}}</h5></td><td class="text-center" rowspan="3"><image-box url="{{info.image[1].url}}"><image-modal show="1" url="{{ info.image[0].url}},{{info.image[1].url }}"></image-modal></image-box></td></tr><tr><td class="text-center" width="10%"><h5>餐饮类别</h5></td><td class="text-center" width="30%"><h5>{{info.shop_type_name}}</h5></td><td class="text-center" width="10%"><h5>配送路线</h5></td><td class="text-center" width="30%"><h5>{{info.line_name}}</h5></td></tr><tr><td class="text-center" width="10%"><h5>所属销售</h5></td><td class="text-center" width="30%"><h5><p ng-if="info.bd_name">BD:{{info.bd_name}}</p><p ng-if="info.bd_mobile">电话:{{info.bd_mobile}}</p></h5></td><td class="text-center" width="10%"><h5>备注信息</h5></td><td class="text-center" width="30%"><h5>{{info.remark}}</h5></td></tr></tbody></table></div></pane><pane title="数据分析"><div style="margin:50px 0 50px 0;"><h3>正在开发.......</h3></div></pane></tabs><tabs><pane title="历史订单"><div class="bs-callout" style="margin-top:10px;border-left-width:none;"><a ng-click="func.filterByStatus(\'-1\');" ng-class="{\'btn-info\': model_order.status == \'-1\'}" class="btn">全部 <span class="badge">{{totalArr[-1]}}</span></a> <a ng-click="func.filterByStatus(\'2\');" ng-class="{\'btn-info\': model_order.status == \'2\'}" class="btn">待审核 <span class="badge">{{totalArr[2]}}</span></a> <a ng-click="func.filterByStatus(\'3\');" ng-class="{\'btn-info\': model_order.status == \'3\'}" class="btn">待生产 <span class="badge">{{totalArr[3]}}</span></a> <a ng-click="func.filterByStatus(\'11\');" ng-class="{\'btn-info\': model_order.status == \'11\'}" class="btn">波次中 <span class="badge">{{totalArr[11]}}</span></a> <a ng-click="func.filterByStatus(\'12\');" ng-class="{\'btn-info\': model_order.status == \'12\'}" class="btn">待分拣 <span class="badge">{{totalArr[12]}}</span></a> <a ng-click="func.filterByStatus(\'13\');" ng-class="{\'btn-info\': model_order.status == \'13\'}" class="btn">已复核 <span class="badge">{{totalArr[13]}}</span></a> <a ng-click="func.filterByStatus(\'14\');" ng-class="{\'btn-info\': model_order.status == \'14\'}" class="btn">已分拨 <span class="badge">{{totalArr[14]}}</span></a> <a ng-click="func.filterByStatus(\'5\');" ng-class="{\'btn-info\': model_order.status == \'5\'}" class="btn">已出库 <span class="badge">{{totalArr[5]}}</span></a> <a ng-click="func.filterByStatus(\'6\');" ng-class="{\'btn-info\': model_order.status == \'6\'}" class="btn">已签收 <span class="badge">{{totalArr[6]}}</span></a> <a ng-click="func.filterByStatus(\'1\');" ng-class="{\'btn-info\': model_order.status == \'1\'}" class="btn">已完成 <span class="badge">{{totalArr[1]}}</span></a> <a ng-click="func.filterByStatus(\'0\');" ng-class="{\'btn-info\': model_order.status == \'0\'}" class="btn">已关闭 <span class="badge">{{totalArr[0]}}</span></a> <a ng-click="func.filterByStatus(\'7\');" ng-class="{\'btn-info\': model_order.status == \'7\'}" class="btn">已退货 <span class="badge">{{totalArr[7]}}</span></a><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="model_order.searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货起始时间</div><input type="text" is-open="model_order.opened" datepicker-popup="yyyy-MM-dd" ng-click="func.open($event)" datepicker-options="model_order.dateOptions" class="form-control" ng-model="model_order.startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">送货截止时间</div><input type="text" is-open="model_order.endOpened" ng-model="model_order.endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="model_order.endDateOptions" ng-click="func.endOpen($event)" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="func.search()">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="func.reset(1)">重置</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5>内部编号</h5></td><td class="text-center" width="12%"><h5>订单编号</h5></td><td class="text-center" width="8%"><h5>客户姓名</h5></td><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="15%"><h5>送货地址</h5></td><td class="text-center" width="10%"><h5>送货时间</h5></td><td class="text-center" width="5%"><h5>订单金额</h5></td><td class="text-center" width="5%"><h5>订单状态</h5></td><td class="text-center" width="10%"><h5>支付状态</h5></td><td class="text-center" width="5%"><h5>订单内容</h5></td></tr></thead><tbody ng-if="orderHistoryList.length===0"><tr><td colspan="12" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="orderHistoryList.length>0"><tr ng-repeat="item in orderHistoryList"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.realname}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.deliver_addr}}</h5></td><td class="text-center"><h5>{{item.deliver_date}}</h5><h5>{{item.deliver_time}}</h5></td><td class="text-center"><h5>{{item.total_price}}</h5><h5><span class="label label-danger" ng-if="item.minus_amount > 0">优惠{{item.minus_amount}}元</span></h5><h5><span class="label label-warning" ng-if="item.deliver_fee > 0">运费{{item.deliver_fee}}元</span></h5></td><td class="text-center"><h5 class="label {{item.class}}">{{item.status_cn}}</h5></td><td class="text-center"><div ng-if="item.pay_type == 1 && item.pay_status == 0"><h5>微信支付</h5><h5 class="label label-warning">未支付</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == 1"><h5>微信支付</h5><h5 class="label label-success">支付成功</h5></div><div ng-if="item.pay_type == 1 && item.pay_status == -1"><h5>微信支付</h5><h5 class="label label-danger">支付失败</h5></div><h5 class="label label-info" ng-if="item.pay_type == 0">货到付款</h5></td><td class="text-center"><h5><a ng-click="getpage()" ng-href="order/detail/{{item.order_number}}">查看</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></pane><pane title="历史投诉单"><div class="bs-callout" style="margin-top:10px;border-left-width:none;"><a ng-click="func.filterByStatus_complaint(\'-1\');" ng-class="{\'btn-info\': model_complaint.status == \'-1\'}" class="btn">全部</a> <a ng-click="func.filterByStatus_complaint(\'1\');" ng-class="{\'btn-info\': model_complaint.status == \'1\'}" class="btn">处理中</a> <a ng-click="func.filterByStatus_complaint(\'2\');" ng-class="{\'btn-info\': model_complaint.status == \'2\'}" class="btn">已处理</a><div class="block mt-10 ml-default"><form class="form-inline" role="form2"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="model_complaint.searchValue" class="form-control" placeholder="请输入搜索关键词"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">起始时间</div><input type="text" is-open="model_complaint.opened" datepicker-popup="yyyy-MM-dd" ng-click="func.open_complaint($event)" datepicker-options="model_complaint.dateOptions" class="form-control" ng-model="model_complaint.startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">截止时间</div><input type="text" ng-model="model_complaint.endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="model_complaint.endDateOptions" ng-click="func.endOpen_complaint($event)" is-open="model_complaint.endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="func.search_complaint()">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="func.reset(2)">重置</button></div></form></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><thead><tr><td class="text-center" width="5%"><h5>投诉单号</h5></td><td class="text-center" width="10%"><h5>填写时间</h5></td><td class="text-center" width="5%"><h5>处理状态</h5></td><td class="text-center" width="10%"><h5>投诉单类型</h5></td><td class="text-center" width="5%"><h5>所属系统</h5></td><td class="text-center" width="5%"><h5>地区</h5></td><td class="text-center" width="5%"><h5>所属销售</h5></td><td class="text-center" width="10%"><h5>订单号</h5></td><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="5%"><h5>客户姓名</h5></td><td class="text-center" width="5%"><h5>客户电话</h5></td><td class="text-center" width="15%"><h5>投诉单内容</h5></td><td class="text-center" width="5%"><h5>操作</h5></td></tr></thead><tbody ng-if="orderComplaintList.length===0"><tr><td colspan="14" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="orderComplaintList.length>0"><tr ng-repeat="item in orderComplaintList"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5><span class="label label-warning" ng-if="item.status == 1">处理中</span></h5><h5><span class="label label-success" ng-if="item.status == 2">已处理</span></h5></td><td class="text-center"><h5>{{item.ctype_name}}</h5></td><td class="text-center"><h5>{{item.site_name}}</h5></td><td class="text-center"><h5>{{item.city_name}}</h5></td><td class="text-center"><h5>{{item.invite_name}}</h5></td><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5 ng-repeat="content in item.contents">{{content.name}}</h5></td><td class="text-center"><h5><a class="btn btn-primary btn_mb5 btn-sm" ng-href="complaint/edit/{{item.id}}">编辑</a></h5><h5><a class="btn btn-danger btn-sm" ng-click="func.delete(item.id)">删除</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="_paginationConf"></dachu-pagination></nav></div></pane></tabs></div></div></div>'),t.put("app/modules/user/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>编辑用户</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.dept.$error.required">请选择部门！</li><li ng-show="basic_form.role.$error.required">请选择用户角色！</li><li ng-show="basic_form.mobile.$error.required">请输入手机号码！</li><li ng-show="basic_form.mobile.$error.pattern">手机号码格式不对！</li><li ng-show="basic_form.name.$error.required">请输入用户姓名！</li><li ng-show="basic_form.province.$error.required">请选择所在地！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form"><div class="form-group"><label class="col-sm-2 control-label">所属部门：</label><div class="col-sm-10"><select ng-model="data.dept" class="form-control" name="dept" ng-options="m.pre_name for m in dept_list" required=""><option value="">请选择用户所属部门</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">用户角色：</label><div class="col-sm-10"><select ng-model="data.role" class="form-control" name="role" ng-change="change()" ng-options="m.name for m in role_list" required=""><option value="">请选择用户角色类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input type="text" ng-model="data.mobile" name="mobile" class="form-control" placeholder="请输入手机号码" required="" ng-pattern="/^[1-9]{1}[0-9]{10}$/"></div></div><div class="form-group"><label class="col-sm-2 control-label">姓名：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所在地：</label><div class="col-sm-10"><select ng-model="data.province" class="form-control" name="province" ng-options="m.name for m in province_list" ng-change="get_market(\'province\');" required=""><option value="">选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">详细地址：</label><div class="col-sm-10"><input type="text" ng-model="data.address" class="form-control" placeholder="请输入详细地址"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/user/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>用户列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><select ng-model="role" class="form-control" name="role" ng-options="m.name for m in role_list"><option value="">请选择角色类型</option></select></div><div class="form-group"><div class="input-group"><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"><div class="input-group-addon">起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><button class="btn btn-block btn-primary" ng-click="exportData()">导出数据</button></div><div class="form-group"><a class="btn btn-primary btn-sm" href="/user/create">添加用户</a></div></form></div></div><div style="margin-top:10px;" class="table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-3"></colgroup><thead><tr><td class="text-center"><h5>编号</h5></td><td class="text-center"><h5>姓名</h5></td><td class="text-center"><h5>角色</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>注册时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="8" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.role}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5><a class="btn btn-info btn-sm btn_mb5" href="/user/edit/{{item.id}}">编辑用户</a> <a class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus($index, 0)" ng-if="item.status == 1">禁用账号</a> <a class="btn btn-success btn-sm btn_mb5" ng-click="setStatus($index, 1)" ng-if="item.status == 0">启用账号</a> <a class="btn btn-info btn-sm btn_mb5" ng-click="resetPassword($index)">重置密码</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>'),t.put("app/modules/user/login.html",'<div class="container-fluid"><div ng-include="\'components/navbar/navbar.html\'" ng-init="isLogin=\'false\'"></div><div class="row login_b show-grid"><div class="col-md-12 col-xs-12"><div class="clogin col-md-4 col-md-offset-4"><h3 class="clogin_h3" ng-controller="TopCtrl">{{title}}</h3><p ng-show="error" class="{{error.cls}}">{{error.msg}}</p><form class="row block block-col form-horizontal" name="loginForm" role="form" novalidate="" ng-submit="login()"><div class="form-group c_loginb col-xs-12"><div class="col-sm-12"><input type="tel" required="" class="input-lg form-control" ng-model="user.mobile" ng-pattern="/^1[3|5|6|7|8|9]\\d{9}$/" ng-minlength="11" ng-maxlength="11" name="mobile" id="tel" placeholder="请输入手机号"><div class="col-xs-12 block-col label label-danger" ng-show="(loginForm.submitted || loginForm.mobile.$dirty) && loginForm.mobile.$invalid"><small ng-show="loginForm.mobile.$error.minlength">请输入正确的手机号</small> <small ng-show="!loginForm.mobile.$error.minlength && loginForm.mobile.$error.pattern">手机号格式不正确</small> <small ng-show="loginForm.mobile.$error.required">手机号必填</small></div></div></div><div class="form-group c_loginb col-xs-12"><div class="col-sm-12"><input type="password" required="" class="input-lg form-control" ng-minlength="6" ng-model="user.password" name="password" id="password" placeholder="请输入密码"><div class="col-xs-12 block-col label label-danger" ng-show="loginForm.submitted && loginForm.password.$invalid"><small ng-show="loginForm.password.$error.minlength">密码至少6位</small> <small ng-show="loginForm.password.$error.required">密码必填</small></div></div></div><div class="form-group col-xs-12"><div class="col-sm-12"><button type="submit" class="btn btn-success btn-block">登录</button></div></div></form></div></div></div></div>'),t.put("app/modules/wave/detail.html",'<div class="container-fluid"><script type="text/ng-template" id="set_status.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> <div class="form-group" ng-if="items.order.status == 6 || items.order.status == 5"> 请填写备注信息 <textarea cols="20" rows="6" class="form-control" ng-model="items.sign_msg"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(items.sign_msg);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h4>波次编号：{{info.id}}</h4><h5>波次类型：{{info.wave_type}}</h5><h5>所属系统：{{info.site_src}}</h5><h5>波次状态：{{info.task_created}}</h5><h5>订单数：{{info.order_count}}</h5></div><div class="row text-center" ng-if="info==\'\'"><h5>暂无记录</h5></div><div><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>订单号</h5></td><td class="text-center"><h5>波次号</h5></td><td class="text-center"><h5>线路</h5></td><td class="text-center"><h5>总件数</h5></td><td class="text-center"><h5>客户名称</h5></td><td class="text-center"><h5>订单状态</h5></td><td class="text-center"><h5>送货时间</h5></td></tr><tr ng-repeat="item in relatedOrders"><td class="text-center"><h5>{{item.order_number}}</h5></td><td class="text-center"><h5>{{item.wave_id}}</h5></td><td class="text-center"><h5>{{item.line}}</h5></td><td class="text-center"><h5>{{item.detail.length}}</h5></td><td class="text-center"><h5>{{item.shop_name}}</h5><h5>{{item.address}}</h5><h5>{{item.realname}}</h5><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.status_cn}}</h5></td><td class="text-center"><h5>{{item.deliver_date}} {{item.deliver_time}}</h5></td></tr></tbody></table></div></div></div></div>'),t.put("app/modules/wave/list.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>波次浏览</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><select ng-model="city" class="form-control" ng-options="m.name for m in cities" required=""><option value="">选择所属城市</option></select><div class="input-group"><div class="input-group-addon">订单类别</div><select class="form-control" ng-model="orderType" ng-options="m.msg for m in orderTypeList"><option value="">请选择订单类别</option></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">配送日期</div><input type="text" is-open="opened" max-date="maxDate" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取配送日期" required=""></div></div><div class="form-group"><select ng-model="deliverT" class="form-control" name="role" ng-options="m.name for m in deliverTime" required=""><option value="">选择配送时间</option></select></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="createWave();">创建波次</button></div></form></div></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><select ng-model="listCity" class="form-control" ng-options="m.name for m in cities"><option value="">选择所属城市</option></select><select ng-model="init.wave" class="form-control" ng-options="m.name for m in waveType"><option value="">请选择波次类型</option></select></div><div class="form-group"><div class="input-group"><input type="text" ng-model="init.searchValue" class="form-control" placeholder="波次号"></div></div><div class="checkbox"><label><input type="checkbox" ng-model="init.released"> 已开始分拣</label></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group" ng-if="!init.release"><button class="btn btn-block btn-danger" ng-click="rollWave()">删除波次</button></div></form></div></div><div style="margin-top:10px;" class="table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1" ng-if="!init.release"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-3"></colgroup><thead><tr><td class="text-center" ng-if="!init.release"><div class="checkbox"><label><input type="checkbox" ng-change="selectAll()" ng-model="isAll"></label></div></td><td class="text-center"><h5>波次号</h5></td><td class="text-center"><h5>所属城市</h5></td><td class="text-center"><h5>订单类型</h5></td><td class="text-center"><h5>波次类型</h5></td><td class="text-center"><h5>总单数</h5></td><td class="text-center"><h5>总行数</h5></td><td class="text-center"><h5>波次状态</h5></td><td class="text-center"><h5>开始时间</h5></td><td class="text-center"><h5>结束时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center" ng-if="!init.release"><div class="checkbox"><label><input type="checkbox" ng-model="item.isChecked"></label></div></td><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.city_name}}</h5></td><td class="text-center"><h5>{{item.order_type_name}}</h5></td><td class="text-center"><h5>{{item.wave_type}}</h5></td><td class="text-center"><h5>{{item.order_count}}</h5></td><td class="text-center"><h5>{{item.line_count}}</h5></td><td class="text-center"><h5>{{item.task_created}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><button ng-click="setReleased(item)" ng-if="item.pick_task_created == 0" class="btn btn-info">开始分拣</button> <a ui-sref="home.waveDetail({wave_id:item.id})" class="btn btn-default">详情</a></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>')
}]);