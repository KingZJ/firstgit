"use strict";angular.module("dachuwang",["ngCookies","ngTouch","ngSanitize","ui.router","bootstrapLightbox","ui.bootstrap"]).run(["$rootScope","$state","$templateCache",function(t,e,a){t.$on("$stateChangeStart",function(){t.showLoading=!0}),t.$on("$stateChangeSuccess",function(){t.showLoading=!1,t.$emit("pageChanged",e.current.data)}),t.$on("cateId",function(e,a){t.$broadcast("list_data",a)}),a.put("lightbox.html","<div class=modal-body ng-swipe-left=Lightbox.nextImage() ng-swipe-right=Lightbox.prevImage()><div class='close_m_btn' ng-click='Lightbox.closeModal()'><span class='glyphicon glyphicon-remove'></span></div><div class=lightbox-image-container><span class='glyphicon glyphicon-menu-left' ng-show='lightBox_len > 1'  ng-click=Lightbox.nextImage()></span><span class='glyphicon glyphicon-menu-right'   ng-show='lightBox_len > 1' ng-click=Lightbox.prevImage()></span><div class=lightbox-image-caption><span>{{Lightbox.imageCaption}}</span></div><img lightbox-src={{Lightbox.imageUrl}} class='' alt=\"\"></div></div></div>")}]),angular.module("dachuwang").controller("UserEditCtrl",["$scope","req","$cookieStore","daChuDialog",function(t,e,a,s){if(void 0==a.get("token"))return e.redirect("/user/login"),!1;t.discard=function(){e.redirect("/user/center")},t.addr={province:"",city:"",county:"",market:""},t.reg={provinceId:"",name:"",cityId:"",countyId:"",marketId:"",detailAddress:""},t.normalUser=30==t.reg.type||20==t.reg.type?1:0,e.getdata("user/getinfo","POST",function(e){t.reg.detailAddress=e.info.detail_address,t.reg.name=e.info.name,t.markets=e.markets,t.provinces=e.provinces,t.citys=e.citys,t.countys=e.countys,angular.forEach(t.markets,function(a){a.id==e.info.market_id&&(t.addr.market=a)}),angular.forEach(t.provinces,function(a){a.id==e.info.province_id&&(t.addr.province=a)}),angular.forEach(t.citys,function(a){a.id==e.info.city_id&&(t.addr.city=a)}),null!=e.info.county_id&&angular.forEach(t.countys,function(a){a.id==e.info.county_id&&(t.addr.county=a)})}),localStorage.getItem("provinces")?t.provinces=JSON.parse(localStorage.getItem("provinces")):e.getdata("location/","GET",function(e){t.provinces=e.provinces,localStorage.setItem("provinces",JSON.stringify(e.provinces))}),t.get_child=function(a,s){e.getdata("location/children","POST",function(e){t[a]=e.children},{id:t.addr[s].id})};var i=0;t.get_market=function(a){(a="province")?t.addr.province.id<=4?(i=1,e.getdata("market/get_market","POST",function(e){t.markets=e},{type:"province",id:t.addr.province.id})):i=0:i||e.getdata("market/get_market","POST",function(e){t.markets=e},{type:"city",id:t.addr.city.id})},t.save=function(){t.reg.marketId=t.addr.market.id,t.reg.provinceId=t.addr.province.id,t.reg.cityId=t.addr.city.id,t.reg.countyId=t.addr.county.id,e.getdata("/user/update_myself","POST",function(t){t.status?(s.tips({bodyText:"更新个人资料成功！"}),e.redirect("/user/center")):s.tips({bodyText:"更新个人资料失败。"})},t.reg)}}]),angular.module("dachuwang").controller("UserRegisterCtrl",["$scope","req","$cacheFactory","$timeout","$location","daChuDialog","$cookieStore","daChuLocal","daChuTimer",function(t,e,a,s,i,n,o,r,l){t.dialog=n.tips,t.addr={province:"",city:"",county:"",market:"",userType:""},t.reg={mobile:"",password:"",name:"",provinceId:"",cityId:"",countyId:"",marketId:"",detailAddress:"",type:"",vcode:"",inviteid:o.get("username")},r.get("regUserType")&&l.compare(r.get("regUserTypeTime"))?t.types=r.get("regUserType"):e.getdata("user/user_type","POST",function(e){t.types=e.user_type,r.set("regUserType",e.user_type),r.set("regUserTypeTime",l.getNow())}),e.getdata("user/register_options","GET",function(e){t.cities=e.list.cities,t.market=e.list.market}),t.getMarket=function(){t.markets=void 0!=t.addr.city?t.market[t.addr.city.id]:[]},t.sms=function(){if(""==t.reg.mobile)return t.dialog({bodyText:"请输入手机号后再选择发送验证短信!"}),!1;t.clock=60;var a=function(e){t.smsinfo="点此重发验证码",t.smsdis="",clearInterval(e)},s=function(){t.clock>=1?(t.clock--,t.smsinfo=t.clock+"秒后可以重发",t.smsdis="disabled"):a(i)},i=setInterval(function(){t.$apply(s)},1e3);e.getdata("user/smscode","POST",function(e){0===e.status?t.dialog({bodyText:"已经成功发送短信,请您注意查收。"}):(a(i),t.dialog({bodyText:"发送短信失败,请您检查手机号是否可用。"}))},t.reg)},t.register=function(){return t.regForm.$invalid?(t.regForm.submitted=!0,!1):(t.reg.provinceId=t.addr.province.id,t.reg.cityId=t.addr.city.id,t.reg.countyId=t.addr.county.id,t.reg.marketId=t.addr.market.id,t.reg.type=t.addr.userType.type,t.reg.codeInviteId=o.get("inviteId"),t.reg.codeInviteStoreNumber=o.get("inviteStoreNumber"),void e.getdata("user/register","POST",function(a){var s="恭喜您注册成功";0===a.status?(20==t.reg.type?o.put("type",20):s="恭喜您注册成功，请等待大厨网审核。有任何疑问请联系400-8199-491。",t.dialog({bodyText:s,actionText:"确定",ok:function(){e.redirect(20==t.reg.type?"/user/center":"/")},closeText:"首页",close:function(){e.redirect("/")}})):t.dialog({bodyText:a.message})},t.reg))}}]),angular.module("dachuwang").controller("UserPasswordController",["$scope","req","$cacheFactory","$timeout","$location","daChuDialog","$cookieStore",function(t,e,a,s,i,n,o){t.reg={password:"",newPassword:"",newRePassword:""},t.dialog=n.tips,t.changePassword=function(){return t.show_error=!0,t.passwordForm.$invalid?void 0:t.reg.newPassword!=t.reg.newRePassword?void t.dialog({bodyText:"两次输入密码不一致。"}):void e.getdata("customer/change_password","POST",function(a){0===a.status?(t.dialog({bodyText:a.msg}),e.getdata("customer/logout","POST",function(){o.remove("token"),e.redirect("/user/login")})):t.dialog({bodyText:a.msg})},t.reg)}}]),angular.module("dachuwang").controller("oftenCtrl",["$rootScope","$state","$location","$window","$scope","$stateParams","productService","categoryService","cartlist","Lightbox","posService",function(t,e,a,s,i,n,o,r,l,c){var d=i.DC={};i.canLoad=!0,i.ifnone_products=!1,i.show_loading=!0,d.page=1,i.backUpNum={},i.getProduct=function(t,e,a){i.show_loading=!0;var s=o.getProducts(t,e,a);d.page++,s.then(function(t){i.canLoad&&(i.show_loading=!1,i.data=t,i.products?angular.forEach(t.list,function(t){i.products.push(t)}):i.products=t.list,angular.forEach(i.products,function(t){t.quantity=1,l.items[0]&&angular.forEach(l.items[0].list,function(e){t.id==e.id&&(t.quantity=e.quantity)})}),i.products.length>=t.total&&(i.canLoad=!1))},function(){i.products=[]},function(){})},i.list_tips="",i.minus=function(t){1!=t.quantity&&t.quantity--},i.plus=function(t){return-1!=t.storage&&t.storage<=t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):0!=t.buy_limit&&t.buy_limit==t.quantity?void alert("每人只能购买"+t.buy_limit+t.unit):void(t.quantity>=9999||t.quantity++)},i.getProduct(n.searchVal,1,"customer/always_buy_products"),t.$on("list_data",function(t,e){i.getProduct(e,1)}),i.cartlist=l,i.isdisabled=!0,i.toggleItems=function(t,e){return-1!=t.storage&&t.storage<t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):void(l.ids.indexOf(t.id)>=0?(l.changeItem(t,-1,0),t.quantity=e):l.changeItem(t,1,e))},i.clearNum=function(t){i.backUpNum[t.id]=t.quantity,t.quantity=""},i.setNum=function(t,e){return 0!=t.buy_limit&&t.quantity>t.buy_limit&&(t.quantity=parseInt(t.buy_limit)),e=e?e:!1,e&&""===t.quantity&&i.backUpNum[t.id]?(t.quantity=i.backUpNum[t.id],void(i.backUpNum[t.id]="")):void(null!=t.quantity&&t.quantity<=0?t.quantity=1:(null!=t.quantity||e)&&(t.quantity<=1?t.quantity=1:/^\d+$/.test(t.quantity)||(t.quantity=1)))},i.lightBox=function(e){angular.forEach(e,function(t){t.url=t.pic_url}),t.lightBox_len=e.length,c.openModal(e,0)}}]),angular.module("dachuwang").controller("UserLoginController",["$scope","$state","userAuthService","rpc","$cookieStore","daChuLocal","daChuDialog","deliver","cartlist",function(t,e,a,s,i,n,o,r,l){return t.fee_deliver="",t.fee_fee="",a.isLogined()?(s.redirect("/user/center"),!1):(t.user={mobile:"",password:""},t.message={text:"",status:""},t.error={},t.init_diy=function(){t.error.message="",t.isL=!1},t.focus=function(){t.init_diy(),t.isgreens=1},t.focuss=function(){t.init_diy(),t.isgreen=1},t.login=function(){return t.show_error=!0,t.loginForm.$invalid?(t.loginForm.submitted=!0,t.isL=!1,!1):(t.isL=!0,void s.load("customer/login","POST",t.user).then(function(t){n.set("token",t.token),n.remove("packaged_cate"),n.set("customer_type",t.customer_type),localStorage.setItem("delivercook",JSON.stringify(t.deliver_fee_rule)),r.fees=t.deliver_fee_rule.fee,r.number=t.deliver_fee_rule.free_amount;var e=1,a=n.get("customer_type")?n.get("customer_type"):e;l.clearItemsByCusType(a),s.redirect(s.refer&&"/"!=s.refer?s.refer:"user/center")},function(e){t.error={cls:"alert alert-danger",message:e}}))},void(t.showTips=function(){o.tips({bodyText:"您可以通过大厨网官方客服电话：400-8199-491、官方QQ：975550226、大厨网>    官方微信号提出申请，稍后我们会有专员前往考察，通过后，会邀请您注册成为大厨网用户，即可轻松下单，享受新鲜食材快速送达！",telText:"立即拨打",tel:"400-8199-491"})}))}]),angular.module("dachuwang").controller("infoCtrl",["$rootScope","$scope","req","$cookieStore","daChuDialog","$filter","userAuthService","daChuLocal","coupon","userService","cartlist",function(t,e,a,s,i,n,o,r,l,c){t.showLoading=!0,o.checkLogin(),e.dialog=i.tips,e.logout=function(){e.dialog({bodyText:"确定要退出吗？",ok:function(){c.login_out()},actionText:"确定",closeText:"取消"})};var d=function(a){t.showLoading=!1,e.uinfo=a.info,e.order=a.order,e.valid_coupon_nums=a.valid_coupon_nums};a.getdata("customer/baseinfo","POST",d)}]),angular.module("dachuwang").controller("couponController",["$rootScope","$scope","req","$cookieStore","daChuDialog","$filter","userAuthService","daChuLocal","coupon","userService",function(t,e,a,s,i,n,o,r,l,c){t.showLoading=!0;var d=function(e){l.query(function(a){a.lists&&1==e&&(l.valid_load=!0),a.lists&&0==e&&(l.no_valid_load=!0),t.showLoading=!1,0==a.status&&(l.list=a.lists,angular.forEach(l.list,function(t){(1==t.status||2==t.status)&&l.ucenterList.active_data.push(t),(3==t.status||4==t.status)&&l.ucenterList.inactive_data.push(t)}))},{status:e})};o.checkLogin(),e.dialog=i.tips,e.active=function(){e.current=!1,l.valid_load||d(1)},e.no_active=function(){e.current=!0,l.no_valid_load||d(0)},l.ucenterList.active_data.length||(e.active(),l.no_valid_load||d(0),t.showLoading=!1,e.coupon=l),e.coupon=l,t.showLoading=!1,e.logout=function(){e.dialog({bodyText:"确定要退出吗？",ok:function(){c.login_out()},actionText:"确定",closeText:"取消"})}}]),angular.module("dachuwang").controller("chooseController",["$scope","$rootScope","req","$cookieStore","daChuDialog","$filter","userAuthService","daChuLocal","coupon",function(t,e,a,s,i,n,o,r,l){var c=r.get("coupon_active");t.coupon=c,e.showLoading=!1,t.choose_sum=function(t){l.choose_sum=t.detail.minus_amount,l.coupon_id=t.id,a.redirect("/confirm")},o.checkLogin(),t.dialog=i.tips,t.active=function(){t.current=!1},t.no_active=function(){t.current=!0},t.logout=function(){t.dialog({bodyText:"确定要退出吗？",ok:function(){userService.login_out()},actionText:"确定",closeText:"取消"})}}]),angular.module("dachuwang").controller("UserCenterCtrl",["$rootScope","$scope","req","$cookieStore","daChuDialog","$filter","userAuthService","daChuLocal","coupon","userService","cartlist",function(t,e,a,s,i,n,o,r,l,c){t.showLoading=!0,o.checkLogin(),e.dialog=i.tips,e.logout=function(){e.dialog({bodyText:"确定要退出吗？",ok:function(){c.login_out()},actionText:"确定",closeText:"取消"})};var d=function(a){t.showLoading=!1,e.uinfo=a.info,e.order=a.order,e.valid_coupon_nums=a.valid_coupon_nums};a.getdata("customer/baseinfo","POST",d)}]),angular.module("dachuwang").controller("subjectController",["$window","$scope","$stateParams","productService","categoryService","cartlist","Lightbox","rpc",function(t,e,a,s,i,n,o,r){e.ifnone_products=!1,e.show_loading=!0,e.backUpNum={},e.getProduct=function(){var t=r.load("subject/info","POST",{id:a.subjectId});t.then(function(t){e.show_loading=!1,e.info=t.info,e.products=t.info.products,angular.forEach(e.products,function(t){t.quantity=1,n.items[0]&&angular.forEach(n.items[0].list,function(e){t.id==e.id&&(t.quantity=e.quantity)})})},function(){},function(){})},e.list_tips="",e.minus=function(t){1!=t.quantity&&t.quantity--},e.plus=function(t){return-1!=t.storage&&t.storage<=t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):0!=t.buy_limit&&t.buy_limit==t.quantity?void alert("每人只能购买"+t.buy_limit+t.unit):void(t.quantity>=9999||t.quantity++)},e.getProduct(11,1),e.cartlist=n,e.isdisabled=!0,e.toggleItems=function(t,e){return-1!=t.storage&&t.storage<t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):void(n.ids.indexOf(t.id)>=0?(n.changeItem(t,-1,0),t.quantity=e):n.changeItem(t,1,e))},e.clearNum=function(t){e.backUpNum[t.id]=t.quantity,t.quantity=""},e.setNum=function(t,a){return 0!=t.buy_limit&&t.quantity>t.buy_limit&&(t.quantity=parseInt(t.buy_limit)),a=a?a:!1,a&&""===t.quantity&&e.backUpNum[t.id]?(t.quantity=e.backUpNum[t.id],void(e.backUpNum[t.id]="")):void(null!=t.quantity&&t.quantity<=0?t.quantity=1:(null!=t.quantity||a)&&(t.quantity<=1?t.quantity=1:/^\d+$/.test(t.quantity)||(t.quantity=1)))},e.lightBox=function(t){angular.forEach(t,function(t){t.url=t.pic_url}),o.openModal(t,0)}}]),angular.module("dachuwang").controller("orderListController",["$rootScope","$scope","req","$cookieStore","$modal","$window","pagination","userAuthService","$stateParams","daChuConfig",function(t,e,a,s,i,n,o,r,l){r.checkLogin(),e.dialog=function(t,e){var a={headerText:"提示信息",bodyText:"设置成功",closeText:"关闭"},s={templateUrl:"myModalContent.html"};angular.extend(s,e),angular.extend(a,t);var n=i.open({templateUrl:s.templateUrl,controller:"ModalInstanceCtrl",resolve:{items:function(){return a}}});n.result.then(function(){},function(){})},e.orderlist=[],e.showType=l.status||2,e.tabs=[{status:2,name:"待确认"},{status:100,name:"待收货"},{status:1,name:"已完成"},{status:0,name:"已关闭"}],e.isProcessing=!0;var c="",d=function(t){0===t.status&&(e.orderlist=t.orderlist,e.isProcessing=!1,e.user_type=t.type,e.total=t.total,c=t.pay_url),e.pagination=o,o.init(function(t){a.getdata("order/lists","POST",function(a){angular.forEach(a.orderlist,function(t){e.orderlist.push(t)}),t&&t(!a.orderlist.length)},{page:o.page,status:e.showType})})},u=function(){a.getdata("order/lists","POST",d,{status:e.showType})};u(),e.setStatus=function(t){l=t,e.showType=t,e.orderlist=[],e.isProcessing=!0,a.getdata("order/lists","POST",d,{status:e.showType})},e.setStatus(e.showType);var p=function(t){e.dialog(0===t.status?{bodyText:"取消订单成功",close:function(){u()}}:{bodyText:"取消失败"})};e.cancel=function(t,a){return 0!=a?void e.dialog({bodyText:"本单已减免"+a+"元,取消订单将视为自动放弃优惠,确认取消订单吗？",action:"confirm",ok:function(){e.orderCancel(t)},actionText:"确认",closeText:"取消"}):void e.dialog({bodyText:"确认取消订单吗？",action:"confirm",ok:function(){e.orderCancel(t)},actionText:"确认",closeText:"取消"})},e.orderCancel=function(t){a.getdata("order/cancel","POST",p,{order_id:t})},e.pay=function(e){t.showLoading=!0,n.location.href=c+"?order_number="+e}}]),angular.module("dachuwang").controller("orderController",["$scope","cartlist",function(t,e){t.text="this is order page",t.products=e.items[0].list,t.minus=function(a){1==a.quantity?t.remove(a):e.changeItem(a,-1)},t.plus=function(t){e.changeItem(t,1)},t.remove=function(a){t.dialog({bodyText:"确定要删除吗?",actionText:"确定",ok:function(){e.changeItem(a,-1,0)}})},t.backUpNum={},t.clearNum=function(e){t.backUpNum[e.id]=e.quantity,e.quantity=""},t.setNum=function(a,s){s=s?s:!1,s&&""===a.quantity&&t.backUpNum[a.id]&&(a.quantity=t.backUpNum[a.id],t.backUpNum[a.id]=""),null!=a.quantity&&a.quantity<=0?a.quantity=0:(null!=a.quantity||s)&&(a.quantity<=0?t.remove(a):/^\d+$/.test(a.quantity)?e.changeItem(a,1,a.quantity):a.quantity=1)}}]),angular.module("dachuwang").controller("listController",["$scope","$cookieStore","cartlist","req","daChuDialog",function(t,e,a,s,i){t.cartlist=a,t.dialog=i.tips;var n=function(t){t.status&&(a.clearInfo(),s.redirect("/order/list"))};t.init={startHour:0,dt:0,content:""},t.dates=[];var o=new Date,r={name:"今天",val:"today"},l={name:"明天",val:"tomorrow"};t.dates.push(r),t.dates.push(l),t.init.dt=t.dates[0],t.hours=[];for(var c=0;24>c;c++){var d={name:c+"点",val:c};t.hours.push(d)}var o=new Date,u=o.getHours();t.init.startHour=t.hours[u],t.hourChange=function(){return!1},t.confirm=function(){var i=e.get("type");if(!i)return s.redirect("/user/login","cart/detail"),!1;var o=[];angular.forEach(a.users,function(e){angular.forEach(a.items[e].list,function(e){e.quantity<=0?t.remove(e,!0):o.push({id:e.id,quantity:e.quantity})})}),s.getdata("order/add","POST",n,{total_price:a.sum,products:o,mindate:t.init.dt,content:t.init.content,minhour:t.init.startHour})},t.minus=function(e){1==e.quantity?t.remove(e):a.changeItem(e,-1)},t.plus=function(t){a.changeItem(t,1)},t.remove=function(e){t.dialog({bodyText:"确定要删除吗?",actionText:"确定",ok:function(){a.changeItem(e,-1,0)}})},t.backUpNum={},t.clearNum=function(e){t.backUpNum[e.id]=e.quantity,e.quantity=""},t.setNum=function(e,s){s=s?s:!1,s&&""===e.quantity&&t.backUpNum[e.id]&&(e.quantity=t.backUpNum[e.id],t.backUpNum[e.id]=""),null!=e.quantity&&e.quantity<=0?e.quantity=0:(null!=e.quantity||s)&&(e.quantity<=0?t.remove(e):/^\d+$/.test(e.quantity)?a.changeItem(e,1,e.quantity):e.quantity=1)}}]),angular.module("dachuwang").controller("searchController",["$rootScope","$timeout","$state","$location","$window","$scope","$stateParams","productService","categoryService","cartlist","Lightbox","posService","daChuLocal",function(t,e,a,s,i,n,o,r,l,c,d,u,p){var g=n.DC={};g.event=!0,g.search_name=o.searchVal,g.back=function(t){history.back(),g.event=!1,t.stopPropagation()},g.reset=function(){g.search_name=""},g.search=function(t,a){e(function(){t.$valid&&t.$dirty&&g.event&&(n.getProduct(g.search_name,1,"product/search"),a.stopPropagation())},250)},g.page=1,n.ifnone_products=!1,n.canLoad=!0,n.backUpNum={},n.getProduct=function(t,e,a){var s=p.get("search_name");if(s&&s!=t&&(n.canLoad=!0,g.page=1,n.products=null),p.set("search_name",t),n.show_loading=!0,n.canLoad){var i=r.getProducts(t,e,a);g.page++,i.then(function(t){n.show_loading=!1,n.data=t,n.products?angular.forEach(t.list,function(t){n.products.push(t)}):n.products=t.list,angular.forEach(n.products,function(t){t.quantity=1,c.items[0]&&angular.forEach(c.items[0].list,function(e){t.id==e.id&&(t.quantity=e.quantity)})}),n.products.length>=t.total&&(n.canLoad=!1)},function(t){n.products=[],alert(t)},function(){})}},n.list_tips="",n.minus=function(t){1!=t.quantity&&t.quantity--},n.plus=function(t){return-1!=t.storage&&t.storage<=t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):0!=t.buy_limit&&t.buy_limit==t.quantity?void alert("每人只能购买"+t.buy_limit+t.unit):void(t.quantity>=9999||t.quantity++)},o.searchVal&&n.getProduct(o.searchVal,1,"product/search"),t.$on("list_data",function(t,e){n.getProduct(e,1)}),n.cartlist=c,n.isdisabled=!0,n.toggleItems=function(t,e){return-1!=t.storage&&t.storage<t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):void(c.ids.indexOf(t.id)>=0?(c.changeItem(t,-1,0),t.quantity=e):c.changeItem(t,1,e))},n.clearNum=function(t){n.backUpNum[t.id]=t.quantity,t.quantity=""},n.setNum=function(t,e){return 0!=t.buy_limit&&t.quantity>t.buy_limit&&(t.quantity=parseInt(t.buy_limit)),e=e?e:!1,e&&""===t.quantity&&n.backUpNum[t.id]?(t.quantity=n.backUpNum[t.id],void(n.backUpNum[t.id]="")):void(null!=t.quantity&&t.quantity<=0?t.quantity=1:(null!=t.quantity||e)&&(t.quantity<=1?t.quantity=1:/^\d+$/.test(t.quantity)||(t.quantity=1)))},n.lightBox=function(e){angular.forEach(e,function(t){t.url=t.pic_url}),t.lightBox_len=e.length,d.openModal(e,0)}}]),angular.module("dachuwang").controller("padController",["$rootScope","$location","$window","$scope","$stateParams","productService","categoryService","cartlist","Lightbox",function(t,e,a,s,i,n,o,r,l){s.DC={};s.ifnone_products=!1,s.show_loading=!0,s.backUpNum={},s.getProduct=function(t,e){s.products=null,s.show_loading=!0;var a=n.getProducts(t,e);a.then(function(t){s.show_loading=!1,s.products=t,angular.forEach(s.products,function(t){t.quantity=1,r.items[0]&&angular.forEach(r.items[0].list,function(e){t.id==e.id&&(t.quantity=e.quantity)})}),s.ifnone_products=t.length>0?!1:!0},function(){},function(){})},s.list_tips="",s.minus=function(t){1!=t.quantity&&t.quantity--},s.plus=function(t){return-1!=t.storage&&t.storage<=t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):0!=t.buy_limit&&t.buy_limit==t.quantity?void alert("每人只能购买"+t.buy_limit+t.unit):void(t.quantity>=9999||t.quantity++)},i.cateId?s.getProduct(i.cateId,1):s.getProduct(t.init_cateId,1),t.$on("list_data",function(t,e){s.getProduct(e,1)}),s.cartlist=r,s.isdisabled=!0,s.toggleItems=function(t,e){return-1!=t.storage&&t.storage<t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):void(r.ids.indexOf(t.id)>=0?(r.changeItem(t,-1,0),t.quantity=e):r.changeItem(t,1,e))},s.clearNum=function(t){s.backUpNum[t.id]=t.quantity,t.quantity=""},s.setNum=function(t,e){return 0!=t.buy_limit&&t.quantity>t.buy_limit&&(t.quantity=parseInt(t.buy_limit)),e=e?e:!1,e&&""===t.quantity&&s.backUpNum[t.id]?(t.quantity=s.backUpNum[t.id],void(s.backUpNum[t.id]="")):void(null!=t.quantity&&t.quantity<=0?t.quantity=1:(null!=t.quantity||e)&&(t.quantity<=1?t.quantity=1:/^\d+$/.test(t.quantity)||(t.quantity=1)))},s.lightBox=function(e){angular.forEach(e,function(t){t.url=t.pic_url}),t.lightBox_len=e.length,l.openModal(e,0)}}]),angular.module("dachuwang").controller("cateController",["$scope","$rootScope","$state","$stateParams","$http","$window","locationService","notifyService","categoryService","cateObj","daChuLocal","advService","req","Lightbox","posService","userAuthService",function(t,e,a,s,i,n,o,r,l,c,d,u,p,g,m,h){e.init_cateId=c.length&&c[0].cate_child.length?c[0].cate_child[0].id:12,t.$state=a,t.localInfo=m.info(),t.isLogined=h.isLogined();var v=t.DC={};v.state=e.init_cateId,v.active_list=function(t){v.data=t;var a=v.data.length?v.data[0].id:null;v.state=a,e.$emit("cateId",a)},v.product=function(t){e.$emit("cateId",t)},v.search=function(){a.go("page.search",{searchVal:v.search_name},{inherit:!0})},g.modalInstance&&g.closeModal(),d.get("token")||p.getdata("customer/logout","POST",function(){d.remove("packaged_cate"),d.remove("coupon_active")}),t.category=c,s.cateId?(v.state=s.cateId,angular.forEach(t.category,function(e,a){angular.forEach(t.category[a].cate_child,function(i){i.id==s.cateId&&(v.data=t.category[a].cate_child,v.cate_id=e.cate_parent_id)})})):(v.data=t.category[0].cate_child,v.cate_id=t.category[0].cate_parent_id),t.showAdv=!1,u.getAds(1).then(function(e){t.slides=[],0===parseInt(e.status)&&(angular.forEach(e.list,function(e){e.link_url||(e.link_url="page.home");var a={sref:e.link_url,url:e.pic_url};t.slides.push(a)}),t.slides.length&&(t.showAdv=!0))},function(){t.slides=[]})}]),angular.module("dachuwang").controller("homeController",["$scope","$state","$rootScope","$http","$window","locationService","notifyService","categoryService","cateObj","daChuLocal","advService","req","Lightbox","posService","userAuthService",function(t,e,a,s,i,n,o,r,l,c,d,u,p,g,m){t.$state=e,t.localInfo=g.info(),t.isLogined=m.isLogined();var h=t.DC={};h.active_list=function(t){h.data=t},h.product=function(t){a.$emit("cateId",t)},h.search=function(){e.go("page.search",{searchVal:h.search_name},{inherit:!0})},h.cateArr=c.get("cateArr"),h.cateArr&&h.cateArr.recommends&&h.cateArr.recommends.length&&(h.recommends=h.cateArr.recommends),p.modalInstance&&p.closeModal(),c.get("token")||u.getdata("customer/logout","POST",function(){c.remove("packaged_cate"),c.remove("coupon_active")}),t.category=l,h.data=t.category.length?t.category[0].cate_child:null,t.showAdv=!1,d.getAds(1).then(function(e){t.slides=[],0===parseInt(e.status)&&(angular.forEach(e.list,function(e){e.link_url||(e.link_url="page.home");var a={sref:e.link_url,url:e.pic_url};t.slides.push(a)}),t.slides.length&&(t.showAdv=!0))},function(){t.slides=[]})}]),angular.module("dachuwang").controller("confirmController",["$rootScope","$scope","$filter","$cookieStore","$window","cartlist","deliver","req","rpc","daChuDialog","userAuthService","daChuConfig","coupon","daChuLocal",function(t,e,a,s,i,n,o,r,l,c,d,u,p,g){d.checkLogin(),e.coupon=p,e.pay={weixin:!1,delivery:!1},e.showPayType=!1,t.showLoading=!0,t.showLoading=!0;var m=n.getDetail(),h="",v={};e.init_pay_reduce=0;var f=!1,b=!1;l.load("order/confirm_options","POST",{cartlist:n.getDetail()}).then(function(a){e.minus_info=0==a.minus_info.length?!1:a.minus_info,e.uinfo=a.user_info,e.dates=a.date_dropdown,e.times=a.time_dropdown,e.rules=a.promotion_list,e.minus_amount=a.minus_amount,e.total_price=a.total_price,e.free_amount=a.free_amount,e.fee=a.fee,e.serviceFee=a.service_fee,p.active_data=a.coupons,a.coupons&&!a.coupons.length&&(p.choose_sum=p.coupon_id=null),g.set("coupon_active",a.coupons),e.sum_price=p.choose_sum?parseFloat(a.sum)-parseFloat(p.choose_sum):parseFloat(a.sum),p.choose_sum&&(e.minus_amount+=p.choose_sum),e.deliver_notice=a.deliver_notice,t.showLoading=!1,e.pay_events_title=a.pay_events_title,v=a.pay_events,h=a.pay_url,x(),y(u.payby.weixin,!0)},function(e){t.showLoading=!1,alert(e)}),e.payby=function(t){0==t?(e.pay.delivery=!0,e.pay.weixin=!1):1==t&&(e.pay.weixin=!0,e.pay.delivery=!1),y(t,!1)},e.pay_reduce=0;var y=function(t,a){if(2!=e.uinfo.customer_type)if(e.pay_event={},0==t&&0==b)e.minus_amount-=e.pay_reduce,e.sum_price+=e.pay_reduce,b=!0,f=!1;else if(1==t&&f===!1&&v&&w.length(v)>0){for(var s in v)if(e.uinfo.province_id==s&&v[s].online){e.pay_event=v[s];break}if(0!=parseInt(e.pay_event.reduce)&&e.pay_event.reduce<e.sum_price)!a&&(e.minus_amount+=e.pay_event.reduce),!a&&(e.sum_price-=e.pay_event.reduce),!a&&(e.pay_reduce=e.pay_event.reduce),a&&(e.init_pay_reduce=e.pay_event.reduce),!a&&(f=!0),!a&&(b=!1);else if(w.length(e.pay_event.total_reduce)>0){var i=[],n=[];for(var o in e.pay_event.total_reduce)i.push(parseInt(o)),n.push(parseInt(e.pay_event.total_reduce[o]));i.sort(_),n.sort(_);var r=w.length(i);if(r>0)for(var l=0;r>l;l++)if(e.sum_price>=i[l]&&e.sum_price>i[l]){!a&&(e.minus_amount+=n[l]),!a&&(e.sum_price-=n[l]),!a&&(e.pay_reduce=n[l]),a&&(e.init_pay_reduce=n[l]),!a&&(f=!0),!a&&(b=!1);break}}}},_=function(t,e){return t==e?0:e>t?1:-1},x=function(){r.getdata("payment/open_cities","POST",function(t){if(0==t.status){for(var a in t.data)if(a==e.uinfo.province_id&&(0==t.data[a].length||k(e.uinfo.mobile,t.data[a]))){e.showPayType=!0;break}1!=e.showPayType&&(e.pay.delivery=!0)}})},w={length:function(t){var e=typeof t;if("string"==e)return t.length;if("object"==e){var a=0;for(var s in t)a++;return a}return!1}},k=function(t,e){for(var a=e.length,s=0;a>s;s++)if(e[s]==t)return!0;return!1};e.cartlist=n,e.remarks="",e.dialog=c.tips;var q=function(a){if(t.showLoading=!1,0==a.status){n.change=0,i.alert(a.msg),n.clearInfo(),p.coupon_id&&(angular.forEach(p.ucenterList.active_data,function(t,e){t.id==p.coupon_id&&(p.ucenterList.active_data.splice(e,1),p.ucenterList.inactive_data.push(t))}),p.choose_sum=p.coupon_id=null);var s=a.number.split(","),o=s.length;if(o>1)return void r.redirect("/order/list/");1==e.pay.delivery?r.redirect("/order/list/"):1==e.pay.weixin&&(t.showLoading=!0,window.location.href=h+"?order_number="+a.number)}else{if(a.products){e.products=a.products;var l=0;return angular.forEach(n.users,function(t){angular.forEach(n.items[t].list,function(t){angular.forEach(e.products,function(e){t.id==e.id&&(t.last_price=t.price,t.price=e.price_in_db,t.status=e.status)}),l+=t.quantity*t.price})}),n.change=1,n.sum=l,n.setInfo(n),void r.redirect("/cart")}i.alert(a.msg)}};e.dateChange=function(){angular.forEach(e.dates,function(t){e.deliver_date&&t.name==e.deliver_date.name&&(e.times=t.time,e.deliver_time=void 0)})},e.confirm=function(){if(e.fee>0&&!e.is_ok)return void c.tips({bodyText:"亲，一次下单总金额不足"+e.free_amount+"元，将收取运费"+e.fee+"元。您可以用其他商品凑单哦!",ok:function(){e.is_ok=!0},close:function(){r.redirect("/home")},closeText:"继续购物",actionText:"仍然提交"});if(d.checkLogin(),0==e.pay.weixin&&0==e.pay.delivery&&1==e.showPayType)return void alert("请选择支付方式");if(!e.deliver_date)return void alert("请选择送货日期");if(!e.deliver_time)return void alert("请选择送货时间");var a="您选择的配送时间是"+e.deliver_date.name+" "+e.deliver_time.msg+",大厨网将准时进行配送，是否确认？";if(e.rules.length>0){var s=e.deliver_date.val;angular.forEach(e.rules,function(t){t.latest_deliver_timestamp<s&&(a="配送时间不符活动要求，不再享受满减优惠，是否确认？")})}var n=i.confirm(a),o=[];if(angular.forEach(e.rules,function(t){t.latest_deliver_timestamp>=s&&o.push(t)}),!n)return!1;var l=u.payby.delivery;1==e.pay.weixin&&(l=u.payby.weixin);var g={rules:o,products:m,deliver_date:e.deliver_date.val,deliver_time:e.deliver_time.code,remarks:e.remarks,pay_type:l,coupon_id:p.coupon_id};t.showLoading=!0,r.getdata("order/create","POST",q,g)}}]),angular.module("dachuwang").controller("CityController",["$scope","$state","$cookieStore","daChuLocal","rpc","daChuTimer","posService","userAuthService",function(t,e,a,s,i,n,o,r){var l=function(){var e=s.get("localCity")||{};"undefined"!=typeof e.list&&n.compare(e.currentTime)?t.cities=e.list:i.load("/location/city","GET").then(function(e){t.cities=e.list;var a={currentTime:n.getNow(),list:e.list};s.set("localCity",a)})};l(),t.citySelect=function(a){var i=t.cities.indexOf(a);r.isLogined()?(s.remove("packaged_cate"),alert("您的地理位置不能修改")):(s.remove("cateArr"),o.setInfo(t.cities[i].id,t.cities[i].name),s.remove("packaged_cate")),e.go("page.home")}}]),angular.module("dachuwang").controller("cartController",["$scope","$rootScope","$filter","$cookieStore","$window","cartlist","daChuDialog","req","posService","rpc",function(t,e,a,s,i,n,o,r,l,c){t.cartlist=n;var d=l.info(),u=d.id;n.count>0&&(t.products=t.cartlist.items[0].list),t.dialog=o.tips;t.init={startHour:0,dt:0,content:""},t.dates=[];var p=new Date,g={name:"今天",val:"today"},m={name:"明天",val:"tomorrow"};t.dates.push(g),t.dates.push(m),t.init.dt=t.dates[0],t.hours=[];for(var h=0;24>h;h++){var v={name:h+"点",val:h};t.hours.push(v)}var p=new Date,f=p.getHours();t.init.startHour=t.hours[f],t.hourChange=function(){return!1},n.limit_tips=[],t.createOrder=function(){c.load("order/today_bought_products","POST",{cartlist:n.getDetail()}).then(function(e){if(0!=e.status)return!1;if(e.check_cart_info&&0!=e.check_cart_info.length&&o.tips({bodyText:e.check_cart_info.msg,ok:function(){},close:function(){r.redirect("/cart")},closeText:"取消",actionText:"确定"}),angular.forEach(t.products,function(t){t.buy_limit&&t.buy_limit>0&&angular.forEach(e.list,function(e){var a=t.quantity+e.quantity>t.buy_limit?!0:!1;(t.id==e.product_id&&t.buy_limit<=e.quantity||t.id==e.product_id&&a)&&n.limit_tips.push({name:t.title,buy_limit:t.buy_limit,unit:t.unit})})}),t.tipsCon="",n.limit_tips&&n.limit_tips.length)return angular.forEach(n.limit_tips,function(e){t.tipsCon+=e.name+"仅限购买"+e.buy_limit+e.unit+","}),o.tips({bodyText:t.tipsCon+"请重新下单"}),n.limit_tips=[],void(t.tipsCon="");var e=[],a=1,s=0;angular.forEach(n.users,function(t){angular.forEach(n.items[t].list,function(t){0==t.status&&(a=0),parseInt(t.location_id)!=parseInt(u)&&(s=1)})}),0==a?alert("订单中存在已下架的商品，请删除后重新生成订单！"):1==s?alert("订单中存在不同售卖区域的产品，请删除后重新生产订单"):r.redirect("/confirm")})},t.minus=function(e){1==e.quantity?t.remove(e):n.changeItem(e,-1)},t.plus=function(t){return-1!=t.storage&&t.storage<=t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):0!=t.buy_limit&&t.buy_limit==t.quantity?void alert("每人只能购买"+t.buy_limit+t.unit):void n.changeItem(t,1)},t.remove=function(t){var e=i.confirm("确认要删除？");e===!0&&n.changeItem(t,-1,0)},t.backUpNum={},t.clearNum=function(e){t.backUpNum[e.id]=e.quantity,e.quantity=""},t.setNum=function(e,a){-1!=e.storage&&e.storage<e.quantity&&(e.quantity=parseInt(e.storage)),0!=e.buy_limit&&e.quantity>e.buy_limit&&(e.quantity=parseInt(e.buy_limit)),a=a?a:!1,a&&""===e.quantity&&t.backUpNum[e.id]&&(e.quantity=t.backUpNum[e.id],t.backUpNum[e.id]=""),null!=e.quantity&&e.quantity<=0?e.quantity=0:(null!=e.quantity||a)&&(e.quantity<=0?t.remove(e):/^\d+$/.test(e.quantity)?n.changeItem(e,1,e.quantity):(e.quantity=1,n.changeItem(e,0)))}}]),angular.module("dachuwang").controller("advsController",["$scope","$stateParams","advService",function(t,e,a){a.detail(e.advId).then(function(e){t.item=e.info},function(){})
}]),angular.module("dachuwang").controller("activityController",["$window","$scope","$stateParams","productService","categoryService","cartlist","Lightbox",function(t,e,a,s,i,n,o){e.ifnone_products=!1,e.show_loading=!0,e.backUpNum={},e.getProduct=function(t,a){var i=s.getProducts(t,a);i.then(function(t){e.show_loading=!1,e.products=t,angular.forEach(e.products,function(t){t.quantity=1,n.items[0]&&angular.forEach(n.items[0].list,function(e){t.id==e.id&&(t.quantity=e.quantity)})}),e.ifnone_products=t.length>0?!1:!0},function(){},function(){})},e.list_tips="",e.minus=function(t){1!=t.quantity&&t.quantity--},e.plus=function(t){return-1!=t.storage&&t.storage<=t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):0!=t.buy_limit&&t.buy_limit==t.quantity?void alert("每人只能购买"+t.buy_limit+t.unit):void(t.quantity>=9999||t.quantity++)},e.getProduct(11,1),e.cartlist=n,e.isdisabled=!0,e.toggleItems=function(t,e){return-1!=t.storage&&t.storage<t.quantity?(alert("抱歉库存不足"),void(t.quantity=parseInt(t.storage))):void(n.ids.indexOf(t.id)>=0?(n.changeItem(t,-1,0),t.quantity=e):n.changeItem(t,1,e))},e.clearNum=function(t){e.backUpNum[t.id]=t.quantity,t.quantity=""},e.setNum=function(t,a){return 0!=t.buy_limit&&t.quantity>t.buy_limit&&(t.quantity=parseInt(t.buy_limit)),a=a?a:!1,a&&""===t.quantity&&e.backUpNum[t.id]?(t.quantity=e.backUpNum[t.id],void(e.backUpNum[t.id]="")):void(null!=t.quantity&&t.quantity<=0?t.quantity=1:(null!=t.quantity||a)&&(t.quantity<=1?t.quantity=1:/^\d+$/.test(t.quantity)||(t.quantity=1)))},e.lightBox=function(t){angular.forEach(t,function(t){t.url=t.pic_url}),o.openModal(t,0)}}]),angular.module("dachuwang").controller("pageController",["$scope",function(){}]),angular.module("dachuwang").controller("ModalInstanceCtrl",["$scope","$modalInstance","items",function(t,e,a){t.items=a,t.selected={item:t.items[0]},t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),angular.module("dachuwang").controller("headerController",["$scope","$state","posService","userAuthService",function(t,e,a,s){t.$state=e,t.localInfo=a.info(),t.isLogined=s.isLogined()}]),angular.module("dachuwang").controller("footerController",["$scope","daChuLocal","cartlist","$state",function(t,e,a,s){var i=[{name:"首页",glyphicon:"sprite-home",href:"page.home"},{name:"分类",glyphicon:"sprite-cate",href:"page.category"},{name:"购物车",glyphicon:"sprite-shop",href:"page.cart",showBadge:!0},{name:"个人中心",glyphicon:"sprite-user",href:"page.userCenter"}];t.tabList=i,t.cartlist=a,t.$state=s}]),angular.module("dachuwang").factory("userAuthService",["rpc","$cookieStore","daChuLocal","userService",function(t,e,a,s){var i=function(){var e=a.get("token");e||s.checkCookie()||t.redirect("user/login")},n=function(){var t=a.get("token");return s.checkCookie()||t?!0:!1};return{checkLogin:i,isLogined:n}}]),angular.module("dachuwang").factory("userService",["$http","$q","req","appConfigure","daChuLocal","rpc",function(t,e,a,s,i,n){var o=(s.url,3e4),r=function(){var t=new Date,a=i.get("baseInfo");if(a&&!isNaN(a.pro_time)&&a.pro_time+o>t.getTime())return e.when(a.data);var s=n.load("/customer/baseinfo");return s},l=function(){for(var t=document.cookie.split(";"),e=null,a=0;a<t.length;a++){var s=t[a].split("=")[0].replace(/^\s+|\s+$/,"");if("remember"==s){e=!0;break}e=!1}return e?!0:!1},c=function(){a.getdata("customer/logout","POST",function(){i.remove("token"),i.remove("currentLocation"),i.remove("packaged_cate"),i.remove("coupon_active"),i.remove("customer_type"),a.redirect("/user/login")})};return{baseInfo:r,login_out:c,checkCookie:l}}]),angular.module("dachuwang").factory("daChuTimer",function(){var t={getNow:function(){return parseInt((new Date).getTime()/1e3)},cacheTime:30};return{getNow:t.getNow,setCacheTime:function(e){t.cacheTime=parseInt(e)},compare:function(e){var a=this.getNow();return parseInt(e)+t.cacheTime>a?!0:!1}}}),angular.module("dachuwang").factory("rpc",["$http","$q","$location","$cookieStore","appConfigure","daChuLocal",function(t,e,a,s,i,n){return{load:function(a,s,o){var r=this,l=e.defer();return void 0==s&&(s="POST"),t({url:i.url+"/"+a+"?r="+Math.random(),method:s,cache:!1,withCredentials:!0,data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(t){t&&-100===t.status?(n.remove("token"),l.reject("您还未登录，请先登录。"),r.redirect("/user/login",r.refer)):t&&0===t.status?l.resolve(t):l.reject(t&&0!==t.status?t.msg:"请求失败，请检查网络。")}).error(function(t){l.reject(t)}),l.promise},init:a,refer:"/",redirect:function(t,e){return void 0!=e?this.refer=e:""==t&&a.path(this.refer),a.path(t),!1}}}]),angular.module("dachuwang").factory("req",["$http","$location","$cookieStore","appConfigure","daChuLocal",function(t,e,a,s,i){return{getdata:function(e,a,n,o){void 0==a&&(a="POST");var r=this;t({url:s.url+"/"+e+"?r="+Math.random(),method:a,cache:!1,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:o}).success(function(t){t&&-100===t.status&&(i.remove("token"),r.redirect("/user/login",r.refer)),n(t)})},init:e,refer:"/",redirect:function(t,a){return void 0!=a?this.refer=a:""==t&&e.path(this.refer),e.path(t),!1}}}]),angular.module("dachuwang").factory("productService",["$http","$q","categoryService","rpc","posService",function(t,e,a,s,i){var n=function(t,a,n){var o=e.defer();if(isNaN(a)||0>=a)return e.derfer().reject("Error page param");var r=t,l=i.info(),c=l.id;return n?s.load(n,"POST",{searchVal:r,currentPage:a,locationId:c}).then(function(t){o.resolve(t)}):s.load("product/lists","POST",{upid:r,locationId:c}).then(function(t){o.resolve(t.list)}),o.promise};return{getProducts:n}}]),angular.module("dachuwang").factory("posService",["daChuLocal",function(t){var e=t.get("currentLocation"),a=e?e.id:804,s=e?e.name:"北京",i={id:a,name:s};return{setInfo:function(e,a){i.id=e,i.name=a,t.set("currentLocation",i)},info:function(){return i}}}]),angular.module("dachuwang").factory("pagination",function(){var t={page:1,isProcessing:!1,processingText:"努力加载中...",isDone:!1,more:"点击加载更多",callback:null};return t.nextPage=function(){t.isProcessing||t.isDone||(t.more="正在加载更多...",t.isProcessing=!0,t.page++,t.callback&&t.callback(function(e){e?(t.isDone=!0,t.more="没有更多了"):t.more="点击加载更多",t.isProcessing=!1}))},t.init=function(e){t.page=1,t.isProcessing=!1,t.isDone=!1,t.more="点击加载更多",t.callback=e},t}),angular.module("dachuwang").factory("notifyService",["$http",function(){var t=function(){return[{title:"您的订单201502280123已经在配送路上",content:"这里是详情"},{title:"您的订单201502280188已经在配送路上",href:"这里是详情"}]};return{getAll:t}}]),angular.module("dachuwang").factory("locationService",function(){var t=function(){return"北京"};return{getCurrent:t}}),angular.module("dachuwang").factory("daChuLocal",function(){var t={get:function(t){var e=localStorage.getItem(t);return e?JSON.parse(e):null},set:function(t,e){localStorage.setItem(t,JSON.stringify(e))},remove:function(t){localStorage.removeItem(t)}};return t}),angular.module("dachuwang").factory("dialog",["$modal",function(t){var e=function(e,a){var s={headerText:"提示信息",bodyText:"设置成功",closeText:"关闭"},i={templateUrl:"myModalContent.html"};angular.extend(i,a),angular.extend(s,e);t.open({templateUrl:i.templateUrl,controller:"ModalInstanceCtrl",resolve:{items:function(){return s}}})};return{tips:e}}]).controller("ModalInstanceCtrl",["$scope","$modalInstance","req","items",function(t,e,a,s){t.items=s,t.selected={item:t.items[0]},t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")},t.payOtherWay=function(){e.dismiss("cancel"),a.redirect("/pay")},t.payAgain=function(){e.dismiss("cancel"),a.redirect("/pay")}}]),angular.module("dachuwang").factory("deliver",["daChuLocal","rpc",function(){var t={fees:{},number:{},obj:JSON.parse(localStorage.getItem("delivercook"))};return t}]),angular.module("dachuwang").factory("daChuDialog",["$modal",function(t){var e=function(e,a){var s={headerText:"提示信息",bodyText:"设置成功",closeText:"关闭"},i={templateUrl:"myModalContent.html"};angular.extend(i,a),angular.extend(s,e);t.open({templateUrl:i.templateUrl,controller:"ModalInstanceCtrl",resolve:{items:function(){return s}}})};return{tips:e}}]),angular.module("dachuwang").factory("coupon",["$rootScope","$modal","req",function(t,e,a){var s={active_data:[],no_active_data:[],ucenterList:{active_data:[],inactive_data:[]}};return s.query=function(t,e){a.getdata("coupon/lists","POST",t,e)},s}]),angular.module("dachuwang").factory("daChuConfig",["$location",function(){var t=0,e=1,a={weixin:e,delivery:t},s={payby:a};return s}]),angular.module("dachuwang").factory("categoryService",["$http","$q","$cookieStore","daChuLocal","rpc","posService",function(t,e,a,s,i,n){var o=3e4,r=function(){var t=new Date,a=s.get("packaged_cate");if(a&&!isNaN(a.pro_time)&&a.pro_time+o>t.getTime())return e.when(a.cate);var r=e.defer(),l=s.get("currentLocation"),c=l?l.id:804;return i.load("category/lists","POST",{locationId:c}).then(function(e){var a=[];"undefined"!=typeof e.list.user_info.location_id&&n.setInfo(e.list.user_info.location_id,e.list.user_info.name),s.set("cateArr",e),s.set("advSwitch",e.adv_switch_index),angular.forEach(e.list.top,function(t){var s=[];angular.forEach(e.list.second[t.id],function(t){s.push({name:t.name,id:t.id})}),a.push({cate_parent:t.name,cate_parent_id:t.id,cate_child:s})}),s.set("packaged_cate",{pro_time:t.getTime(),cate:a}),r.resolve(a)}),r.promise},l=function(t){var a=e.defer(),i={topName:"",list:[]},n=s.get("cateArr");if(n&&n.list.top.length>0){var o=!1;angular.forEach(n.list.second,function(e){angular.forEach(e,function(e){return e.id===t?(i.topName=e.name,void(o=!0)):void 0}),o===!0}),o===!1&&a.reject("error parent category id"),a.resolve(i)}else a.reject("you must load home page first");return a.promise};return{getAll:r,getSubCategory:l}}]),angular.module("dachuwang").factory("cartlist",["$filter",function(t){function e(){var t=JSON.parse(localStorage.getItem("cartInfo"));return t||(t={count:0,sum:0,items:{},ids:[],users:[],change:0},localStorage.setItem("cartInfo",JSON.stringify(t))),t}function a(t){var e={items:angular.isObject(t.items)?t.items:{},ids:angular.isArray(t.ids)?t.ids:[],users:angular.isArray(t.users)?t.users:[],count:parseInt(t.count)>0?parseInt(t.count):0,sum:parseFloat(t.sum)>0?parseFloat(t.sum):0,change:parseInt(t.change)>0?parseInt(t.change):0};return e.sum=c(e.sum,2),localStorage.setItem("cartInfo",JSON.stringify(e))}function s(){l.count=0,l.sum=0,l.items={},l.ids=[],l.users=[],l.change=0,a(l)}function i(){var t=[];return angular.forEach(l.users,function(e){angular.forEach(l.items[e].list,function(e){e.quantity>0&&t.push({title:e.title,id:e.id,location_id:e.location_id,price:e.price,quantity:e.quantity,category_id:e.category_id,sku_number:e.sku_number})})}),t}function n(t,e,a,s){if(e&&e.id){t.list=t.list||[],t.ids=t.ids||[],t.count=t.count||0,t.sum=t.sum||0;var i=t.ids.indexOf(e.id);i>=0?(s&&s>0?t.list[i].quantity=s:0>=s?t.list[i].quantity=0:a>0?t.list[i].quantity++:0>a&&t.list[i].quantity--,t.list[i].quantity<=0?(t.list.splice(i,1),t.ids.splice(i,1)):t.list[i].quantity>9999&&(t.list[i].quantity=9999)):(e.quantity=s&&s>0?s>9999?9999:s:1,t.ids.push(e.id),t.list.push(e));var n=0,o=0;return angular.forEach(t.list,function(t){n+=t.quantity,o+=t.quantity*t.price}),t.count=n,t.sum=o,t.sum=c(t.sum,2),t}}function o(t,e,s){if(t&&t.id){var i=l.users.indexOf(t.user_id);0>i&&(l.users.push(t.user_id),l.items[t.user_id]={}),l.items[t.user_id]=n(l.items[t.user_id],t,e,s);var o=0,r=0,c=0,d=[],u=[],p={};angular.forEach(l.users,function(t){angular.forEach(l.items[t].list,function(t){o+=t.quantity,c+=t.quantity*t.price,d.push(t.id),0==t.status&&(r=1)}),l.items[t].count>0&&(u.push(t),p[t]=l.items[t])}),l.count=o,l.sum=c,l.ids=d,l.users=u,l.items=p,l.change=r,a(l)}}function r(t){var e=[];if(l.items[0]){for(var a=u.length(l.items[0].list),s=0;a>s;s++)l.items[0].list[s].customer_type!=t&&e.push(l.items[0].list[s].id);for(var i in e)for(var n=0;a>n;n++)d(l.items[0].list[n].id,e)&&(o(l.items[0].list[n],-1,0),n=0,a-=1)}}var l=e(),c=t("money"),d=function(t,e){for(var a=e.length,s=0;a>s;s++)if(e[s]==t)return!0;return!1},u={length:function(t){var e=typeof t;if("string"==e)return t.length;if("object"==e){var a=0;for(var s in t)a++;return a}return!1}};return l.changeItem=o,l.getInfo=e,l.getDetail=i,l.setInfo=a,l.clearInfo=s,l.clearItemsByCusType=r,l}]),angular.module("dachuwang").factory("advService",["$q","rpc","daChuLocal",function(t,e,a){var s=function(){var s=t.defer(),i=a.get("currentLocation"),n=i?i.id:804;return e.load("ads/lists","POST",{pos_id:1,locationId:n}).then(function(t){s.resolve(t)},function(){s.resolve(!1)}),s.promise},i=function(a){var s=t.defer();return e.load("ads/info","POST",{id:a}).then(function(t){s.resolve(t)},function(){defered.resolve(!1)}),s.promise};return{getAds:s,detail:i}}]),angular.module("dachuwang").filter("money",function(){return function(t,e){return t=parseFloat(t)||0,e=0/0!=parseInt(e)?parseInt(e):1,t.toFixed(e)}}),angular.module("dachuwang").directive("updateTitle",["$rootScope","$timeout",function(t,e){return{link:function(a,s){var i=function(t,a){var i="大厨网";a.data&&a.data.pageTitle&&(i=a.data.pageTitle),e(function(){s.text(i)},0,!1)};t.$on("$stateChangeSuccess",i)}}}]),angular.module("dachuwang").directive("updateBackstack",["$rootScope","req",function(t){return{link:function(e,a){var s=function(t,e){var s="page";e.backPath&&(s=e.backPath),a.attr("ui-sref",s)};t.$on("$stateChangeSuccess",s)}}}]),angular.module("dachuwang").directive("setClass",["cartlist",function(t){return{link:function(e,a,s){var i=function(){angular.isObject(s.setClass)||(s.setClass=JSON.parse(s.setClass)),s.setClass&&-1!=s.setClass.storage&&s.setClass.quantity>s.setClass.storage||(a.hasClass("btn-lightGreen")?(a.removeClass("btn-lightGreen").addClass("btn-default"),a.children(".text").html("移出购物车")):a.hasClass("btn-default")&&(a.removeClass("btn-default").addClass("btn-lightGreen"),a.children(".text").html("加入购物车")))};if(a.bind("click",function(){i()}),a.children(".text").html("加入购物车"),t.ids){var n=s.id;angular.forEach(t.ids,function(t){t==n&&i()})}}}}]),angular.module("dachuwang").directive("scrollClass",["$document","$window","cartlist",function(t,e){angular.element(e),angular.element(t);return{restrict:"A",link:function(t,e,a){var s=parseInt(a.threshold)||0,i=e[0];e.on("scroll",function(){t.$eval(a.canLoad)&&i.scrollTop+i.offsetHeight>=i.scrollHeight-s&&t.$apply(a.scrollClass)})}}}]),angular.module("dachuwang").directive("reback",["$state",function(t){return{link:function(e,a){a.bind("click",function(){var e=t.current.data;e.backState?t.go(e.backState):history.go(-1)})}}}]),angular.module("dachuwang").directive("lazySrc",["$document","$window","cartlist",function(t,e){var a=angular.element(e),s=angular.element(t),i=function(){var t=0,e={};return{push:function(a){e[t++]=a,setTimeout(function(){o(a)})},del:function(t){e[t]&&delete e[t]},size:function(){return Object.keys(e).length},get:function(){return e}}}(),n=function(t){var e=t[0].getBoundingClientRect(),i=!0;if(e.height>0&&e.width>0){var n=e.top>0&&e.top+e.height/3<Math.max(s.documentElement.clientHeight,a.innerHeight||0),o=e.left>0&&e.left+e.width/3<Math.max(s.documentElement.clientHeight,a.innerHeight||0);i=n&&o}return i},o=function(t,e,s){return e>=0&&s?n(s.elem)?s.load(e):!1:void(0==i.size()?(a.off("scroll",o),a.off("resize",o)):angular.forEach(i.get(),function(t,e){n(t.elem)&&t.load(e)}))},r=function(){isLazyding===!1&&(isLazyding=!0,a.on("scroll",o),a.on("resize",o))};return{restrict:"A",scope:{},link:function(t,e,a){e[0].style.cssText&&e.data("cssText",e[0].style.cssText),e.css({"min-width":"1px ","min-height":"1px"}),i.push({elem:e,load:function(s){return e.data("cssText")&&(e[0].style.cssText=e.data("cssText")),e.removeClass("ng-lazyload"),e.attr("src",a.lazySrc),s>=0&&i.del(s),t.$destroy(),!0}}),r()}}}]),angular.module("dachuwang").directive("activeClass",["$document","$window","$timeout","cartlist",function(t,e,a){{var s=angular.element(e);angular.element(t)}return{restrict:"A",link:function(t,e,i){var n=function(t){var a=e.parent().find("."+t);a&&a.removeClass(t),e.addClass(t)};if("autoFocus"==i.activeClass&&(a(function(){e.focus()},200),e.on("keydown",function(e){13==e.keyCode&&t.getProduct(t.DC.search_name,1,"product/search")})),"mask"==i.activeClass&&(e.on("touchstart",function(){e.addClass("fadeOut")}),e.hasClass("fadeOut")||a(function(){e.addClass("fadeOut")},5e3)),"slide_list"==i.activeClass)e.on("click",function(){n("greenB_textF")});else if("nav_list"==i.activeClass)e.on("click",function(){n("br_b_2")});else if("autoHeight"==i.activeClass){var o=s[0].innerHeight,r=o-53+"px";e.css({height:r,overflowY:"scroll",overflowX:"hidden"})}else if("autoList"==i.activeClass){var o=s[0].innerHeight,r=o-137+"px";e.css({height:r,overflowY:"scroll",overflowX:"hidden"})}else if("autoCart"==i.activeClass){var o=s[0].innerHeight,r=o-95+"px";e.css({height:r,overflowY:"scroll",overflowX:"hidden"})}}}}]),angular.module("dachuwang").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,a){var s="app/modules/",i="components/",n={home:0,cart:2,order:1,user:3};t.state("page",{url:"/",data:{pageTitle:"大厨网",tabIndex:n.home,showBack:!1,showHeader:!1},views:{"":{templateUrl:i+"page/page.html",controller:"pageController"},"@page":{templateUrl:s+"home/home.html",controller:"homeController",resolve:{categoryService:"categoryService",cateObj:["categoryService",function(t){return t.getAll()}]}}}}).state("page.home",{url:"home",templateUrl:s+"home/home.html",controller:"homeController",data:{pageTitle:"大厨网",tabIndex:n.home,showBack:!1,showHeader:!1},resolve:{categoryService:"categoryService",cateObj:["categoryService",function(t){return t.getAll()}]}}).state("loginpage",{url:"/user/login",data:{pageTitle:"登录",showBack:!0,showHeader:!0},templateUrl:s+"user/login.html",controller:"UserLoginController"}).state("page.password",{url:"user/password",data:{pageTitle:"修改密码",showBack:!0,showHeader:!0},templateUrl:s+"user/password.html",controller:"UserPasswordController"}).state("page.citySelect",{url:"city",data:{pageTitle:"更换城市",showBack:!0,showHeader:!0},templateUrl:s+"city/list.html",controller:"CityController"}).state("page.orderList",{url:"order/list/{status:[0-9]{0,8}}",data:{pageTitle:"我的订单",tabIndex:n.user,showBack:!0,backState:"page.userCenter",showHeader:!0},templateUrl:function(){return s+"order/orderList.html"},controller:"orderListController"}).state("page.list",{url:"category/{cateId:[0-9]{1,8}}/",data:{pageTitle:"商品列表",tabIndex:n.order,showBack:!0,showHeader:!1},views:{"":{templateUrl:s+"list/category.html",controller:"cateController",resolve:{categoryService:"categoryService",cateObj:["categoryService",function(t){return t.getAll()}]}},"list@page.list":{templateUrl:s+"list/list.html",controller:"padController"}}}).state("page.category",{url:"category/{cateId:[.\\n]*}/",data:{pageTitle:"商品列表",tabIndex:n.order,showBack:!0,showHeader:!1},views:{"":{templateUrl:s+"list/category.html",controller:"cateController",resolve:{categoryService:"categoryService",cateObj:["categoryService",function(t){return t.getAll()}]}},"list@page.category":{templateUrl:s+"list/list.html",controller:"padController"}}}).state("page.search",{url:"search/{searchVal:[.\\n]*}/",data:{pageTitle:"商品列表",tabIndex:n.home,showBack:!0,showHeader:!1},templateUrl:function(){return s+"list/search.html"},controller:"searchController"}).state("page.cart",{url:"cart",templateUrl:s+"cart/cart.html",controller:"cartController",data:{pageTitle:"购物车",tabIndex:n.cart,showBack:!0,showHeader:!0,backState:"page.home"}}).state("page.userCenter",{url:"user/center",templateUrl:s+"user/center.html",controller:"UserCenterCtrl",data:{pageTitle:"个人中心",tabIndex:n.user,showBack:!0,showHeader:!0,backState:"page.home"}}).state("page.info",{url:"user/info",templateUrl:s+"user/info.html",controller:"infoCtrl",data:{pageTitle:"个人信息",tabIndex:n.user,showBack:!0,showHeader:!0,backState:"page.userCenter"}}).state("page.often",{url:"user/often",templateUrl:s+"user/often.html",controller:"oftenCtrl",data:{pageTitle:"经常购买",tabIndex:n.user,showBack:!0,showHeader:!0,backState:"page.userCenter"}}).state("page.coupon",{url:"user/coupon",templateUrl:s+"user/coupon.html",controller:"couponController",data:{pageTitle:"优惠劵",tabIndex:n.user,showBack:!0,showHeader:!0,backState:"page.userCenter"}}).state("page.chooseCoupon",{url:"user/chooseCoupon",templateUrl:s+"user/chooseCoupon.html",controller:"chooseController",data:{pageTitle:"选择优惠劵",tabIndex:n.cart,showBack:!0,showHeader:!0,backState:"page.confirm"}}).state("page.confirm",{url:"confirm",templateUrl:s+"confirm/confirm.html",controller:"confirmController",data:{pageTitle:"确认订单",tabIndex:n.cart,showBack:!0,showHeader:!0,backState:"page.cart"}}).state("page.subject",{url:"subject/{subjectId:[0-9]{1,}}",templateUrl:s+"subjects/activity.html",controller:"subjectController",data:{pageTitle:"专题详情",tabIndex:n.home,showBack:!0,showHeader:!0,backState:"page.home"}}).state("page.advs",{url:"advs/{advId:[0-9]{1,}}",templateUrl:s+"advs/detail.html",controller:"advsController",data:{pageTitle:"活动详情",tabIndex:n.home,showBack:!0,showHeader:!0,backState:"page.home"}}),e.otherwise("/home"),a.html5Mode(!0)}]),angular.module("dachuwang").provider("appConfigure",{$get:["$location",function(t){var e=t.$$host;return e.indexOf("dachuwang")<0&&(e="chu.dachuwang.net"),{url:"http://api."+e}}]}),angular.module("dachuwang").run(["$templateCache",function(t){t.put("components/footer/footer.html",'<nav class="nav fix-bottom action-nav f6_bg" ng-controller="footerController"><div class="container" active_calss="body_height"><ul class="nav action-nav actionbar-tabs f6_bg"><li class="col-xs-3" ng-repeat="tab in tabList" ng-class="{active : $index === $state.current.data.tabIndex}"><a ui-sref="{{tab.href}}"><h4 class="m-0 text-center hei-24"><span class="footsprite {{tab.glyphicon}} scale5 flex inline"></span></h4>{{tab.name}}<span ng-if="tab.showBadge && cartlist.ids.length > 0" class="badge badge-alert badge-cart" ng-bind="cartlist.ids.length"></span></a></li></ul></div></nav>'),t.put("components/header/header.html",'<header class="head" ng-controller="headerController" ng-show="$state.current.data.showHeader"><div class="container-fluid"><div class="row head-top"><div class="col-xs-4 backup text-left"><a reback="" ng-show="$state.current.data.showBack"><span class="glyphicon glyphicon-menu-left pull-left back_btn"></span><span class="pull-left">返回</span></a> <em ng-show="!$state.current.data.showBack"><span class="glyphicon glyphicon-map-marker"></span> <a ng-if="!isLogined" ui-sref="page.citySelect">{{localInfo.name}} <span class="glyphicon glyphicon-chevron-down"></span></a> <a ng-if="isLogined">{{localInfo.name}}</a></em></div><div class="col-xs-4 listname" ng-bind="$state.current.data.pageTitle"></div><div class="col-xs-4 call"><a href="tel:400-8199-491" class="pull-right">客服</a> <span class="glyphicon glyphicon-earphone pull-right tel_btn"></span></div></div></div></header><script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script>'),t.put("components/page/page.html",'<div ng-include="\'components/header/header.html\'"></div><div ui-view=""></div><div ng-include="\'components/footer/footer.html\'"></div>'),t.put("app/modules/advs/activity.html",'<div class="warp-page p-0 container-fluid"><div class="thumbnail mb-0" ng-if="products"><a class="diy_block"><img ng-src="http://img.dachuwang.com/misc/13874856d43831c24fcc62fcc9305da9.jpg" alt="{{slide.caption}}" class="b-0 img-thumbnail"></a></div><div ng-show="show_loading === true"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div ng-if="ifnone_products === true" class="row block block-col"><div class="col-xs-12 pt-10 pb-10 text-center" role="alert"><h4>抱歉！此分类下暂无商品</h4></div></div><div class="p-lr-15"><div class="row" ng-repeat="product in products"><ul class="seconedlist-ul clearfix"><li><div class="col-xs-12"><h4 class="green">{{product.title}}</h4></div><div class="col-xs-12" ng-if="product.adv_words"><h6 class="text-danger">{{product.adv_words}}</h6></div><div class="col-xs-4 pb-10 img_show text-center" ng-if="product.pictures[0].pic_url"><img ng-click="lightBox(product.big_imgs)" class="img-rounded zoom8" ng-src="{{product.pictures[0].pic_url}}"></div><div class="pull-left pb-10 info" ng-class="{\'col-xs-8\':product.pictures[0].pic_url,\'col-xs-12\':!product.pictures[0].pic_url}"><h6 ng-repeat="spec in product.spec" ng-show="spec.val">{{spec.name}}：<span>{{spec.val}}</span></h6><h6>价格： <span ng-if="product.is_round == 1">约</span> <span class="text-danger">&yen;{{product.price}}</span> <span style="text-decoration:line-through" ng-show="false">&nbsp;&yen;{{product.market_price}}</span> <span ng-if="product.unit">/{{product.unit}}</span> <span class="text-danger" ng-if="product.buy_limit != 0">&nbsp; (限购{{product.buy_limit}}{{product.unit}})</span></h6><h6 class="text-default" ng-if="product.unit != product.close_unit_name && product.close_unit_name">单价：{{product.single_price}}/{{product.close_unit_name}}</h6><h6 class="text-danger" ng-if="product.close_unit_name != product.unit && product.close_unit_name">按{{product.unit}}售卖, 按{{product.close_unit_name}}结算</h6></div><div class="col-xs-12 pb-10 row_br" ng-if="product.storage == 0 && 0"><span class="text-warning">已卖完咯，请等待下一次促销</span></div><div class="col-xs-12 pd-0 pb-10 row_br" ng-if="product.storage != 0"><div class="col-xs-5 pr-0 pull-left"><div class="text-danger pt-pb-6" ng-show="cartlist.ids.indexOf(product.id) >= 0">已加入{{product.quantity}}{{product.unit}}</div><div class="diy_cartP input-group input-group-sm" ng-show="cartlist.ids.indexOf(product.id) < 0"><span class="input-group-addon order-btn-minus"><em class="glyphicon glyphicon-minus disa text-primary" ng-click="minus(product)"></em></span> <input type="number" min="1" class="prval form-control text-center" ng-model="product.quantity" ng-focus="clearNum(product)" ng-blur="setNum(product, true)" ng-change="setNum(product)"> <span class="input-group-addon order-btn-plus"><em class="glyphicon glyphicon-plus text-primary reset_btn" ng-disabled="is_limit" ng-click="plus(product)"></em></span></div></div><div class="col-xs-3 pl-0 pr-0 pt-pb-6" ng-if="product.storage >0">&nbsp; 剩余{{product.storage}}{{product.unit}}</div><div class="col-xs-4 pl-0 pull-right text-right mb-10" ng-show="product.storage == 0"><button class="is_shop white-c btn btn-defualt w100" ng-disabled="true"><span class="text">&nbsp;已售罄&nbsp;</span></button></div><div class="col-xs-4 pl-0 pull-right text-right mb-10"><button class="is_shop btn btn-warning w100" id="{{product.id}}" ng-click="toggleItems(product, product.quantity)" set-class="{{product}}"><span class="text">加入购物车</span></button></div></div></li></ul></div></div><div class="thumbnail mb-0" ng-if="products"><a class="diy_block"><img ng-src="http://img.dachuwang.com/misc/13874856d43831c24fcc62fcc9305da9.jpg" alt="{{slide.caption}}" class="b-0 img-thumbnail"></a></div></div>'),t.put("app/modules/advs/advs.html",'<div class="warp-page"><div><img ng-src="assets/images/category/topB.jpg" alt="减钱风暴来袭" class="img-thumbnail pd-0"></div><div class="container pd-0"><div class="col-xs-12"><h5 class="diy_green diy_label pr col-xs-4">活动时间</h5><div class="col-xs-12 pd-0"><label class="glyphicon glyphicon-time green col-xs-1 pd-0"></label><div class="col-xs-11 pd-0"><span class="green">2015.04.17-2015.04.21（23：00前）</span><br>（参与活动的下单时间为<span class="green">5</span>天）</div></div></div><div class="col-xs-12"><h5 class="diy_green diy_label pr col-xs-4">活动规则</h5><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-1 pd-0 mb-10">1.</label><div class="col-xs-11 pd-0">活动时间内连续3天下单，每天所下订单中 至少有1单金额≥199元（特殊商品：鸡蛋 中不包含鸡蛋筐的押金）</div></div><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-1 pd-0">2.</label><div class="col-xs-11 pd-0">连续下单天数越多，对应减免金额越高： （用户只能选择1种减免额度，不能同时享 受3种减免额度）</div></div><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-1 pd-0">3.</label><div class="col-xs-9 pd-0"><table class="col-xs-7 table diy_table mb-0 table-bordered"><tr><td>连续下单天数</td><td>减免金额</td></tr><tr><td>3天</td><td>20元</td></tr><tr><td>4天</td><td>50元</td></tr><tr><td>5天</td><td>100元</td></tr></table></div></div><div class="col-xs-12 pd-0"><label class="green col-xs-1 pd-0"></label><div class="col-xs-11 pd-0">参与减免活动获得奖励的用户，大厨网将于<span class="green">4月24日</span>以<span class="green>" 短信形式<="" span="">给您发放对应金额的减免券号。 <span class="green">使用须知：</span>有效期为<span class="green">2015年4月24 - 2015年4月26日23点</span>，请在有效期内使用，逾期作废。</span></div></div><div class="col-xs-12 pd-0"><h5 class="diy_green diy_label pr col-xs-4">活动说明</h5><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-1 pd-0">1</label><div class="col-xs-11 pd-0">参与活动订单所选择的最晚配送时间为4月 23日；</div></div><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-1 pd-0">2</label><div class="col-xs-11 pd-0">以成功配送的订单数为准，活动期间所下 的订单发生因非质量问题产生的退货订单 不计入活动内；</div></div><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-1 pd-0">3</label><div class="col-xs-11 pd-0">减免订单中，超出对应减免金额的部分， 客户需补齐差价；低于对应减免金额的部 分，大厨网不退其差价；</div></div><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-1 pd-0">4</label><div class="col-xs-11 pd-0">使用减免金额的订单，若发生退货情况， 不予以退还减免金额部分，但可退还用户 实际支付的差价；</div></div><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-1 pd-0">5</label><div class="col-xs-11 pd-0">本活动最终解释权归大厨网所有。</div></div></div><div class="col-xs-12 pd-0 line_bd green"></div><div class="col-xs-12 pd-0 mb-10"><label class="col-xs-3 pd-0 green">注册方式：</label><div class="col-xs-9 pd-0 mb-10">拨打400-8199-491申请， 工作人员上门帮您开通账号。</div><div class="green">大厨网全国统一服务热线：400-8199-491</div></div></div></div></div>'),t.put("app/modules/advs/detail.html",'<div class="warp-page"><div class="row ml-0 mr-0"><img ng-src="{{item.detail_img}}" alt="减钱风暴来袭" class="col-xs-12 img-thumbnail pd-0"></div></div>'),t.put("app/modules/cart/cart.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid warp-page sec_body" ng-show="!showLoading" active_class="autoCart"><div class="seconedlist"><div class="alert alert-danger row block" ng-show="cartlist.change == 1" role="alert">购物车里面的商品信息已经发生变化，请删除无货商品，确认最新商品价格信息并重新提交。</div><div ng-show="cartlist.count == 0"><div class="row block" active_class="autoCart"><div class="col-xs-12 block-col text-center b_b_0"><img ng-src="assets/images/no_bg.png" class="zoom5 mt-100"><h4 class="text-gray">您的购物车暂无商品</h4><br><a ui-sref="page.home" class="btn btn-order btn-back">去首页</a></div></div></div><div class="row" ng-repeat="product in products" ng-show="cartlist.count > 0"><ul class="seconedlist-ul clearfix"><li><div class="orderlist-hd"><div class="clearfix"><div class="col-xs-10"><h4 class="green">{{product.title}}</h4><small ng-repeat="spec in product.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small> <small class="text-danger">售卖区域 ：{{product.location_name}}<br></small> <small ng-if="product.storage >0">库存： 剩余{{product.storage}}{{product.unit}}</small><p>单价： <span class="orange">&yen;{{product.price}} <span class="bl" ng-show="product.unit">/{{product.unit}}</span></span>&nbsp; <span class="orange" ng-if="product.buy_limit != 0">&nbsp; (限购{{product.buy_limit}}{{product.unit}})</span> <span class="orange" ng-if="product.status != 1">上次价格:<span class="line-through">&yen;{{product.last_price}}<em ng-show="product.unit">/{{product.unit}}</em></span><br><span class="label label-danger pull-right" ng-if="product.status == 0">商品已下架</span> <span class="label label-warning pull-right" ng-if="product.status == 2">价格上涨</span> <span class="label label-success pull-right" ng-if="product.status == 3">价格下跌</span></span>&nbsp; <span ng-show="false" class="line-through">(&yen;{{product.market_price}})</span></p></div><div class="col-xs-2 text-right"><h4><em class="glyphicon glyphicon-remove origin" ng-click="remove(product)"></em></h4></div></div></div><div class="orderlist-bd"><div class="clearfix"><div class="col-xs-5">总计<span class="origin">{{ (product.price*product.quantity) | money : 2}}</span>元</div><div class="col-xs-7"><div class="input-group input-group-sm"><span class="input-group-addon order-btn-minus"><em class="glyphicon glyphicon-minus text-primary" ng-click="minus(product)"></em></span> <input type="number" min="1" class="form-control text-center" ng-model="product.quantity" ng-focus="clearNum(product)" ng-blur="setNum(product,true)" ng-change="setNum(product)"> <span class="input-group-addon order-btn-plus"><em class="glyphicon glyphicon-plus text-primary" ng-click="plus(product)"></em></span></div></div></div></div></li></ul></div><div class="row block block-col pt-10 pb-10" ng-show="cartlist.count>0"><div class="col-xs-12 text-center"><h4>共{{cartlist.count}}件，总计<span class="origin">{{cartlist.sum | money:2}}</span>元</h4></div><div ng-if="cartlist.count>0" class="col-xs-12"><h5><a ng-click="createOrder();" class="btn btn-block btn-order btn-lg">生成订单</a></h5></div></div></div></div>'),t.put("app/modules/city/list.html",'<div class="warp-page container-fluid"><div ng-show="show_loading === true"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><section class="i_list"><div class="row"><div class="col-xs-12 i_class"><a href="#" ng-click="citySelect(city)" ng-repeat="city in cities">{{city.name}}</a></div></div></section></div>'),t.put("app/modules/confirm/confirm.html",'<div class="mt-nav mb-nav container-fluid" ng-show="!showLoading" active_class="autoCart"><div class="alert alert-danger row m-5-5 greenB_whiteF alert-dismissible min_alert" role="alert" ng-show="minus_info"><h4 class="text-center mt-10">{{minus_info.title}}</h4><ol class="list_none ng-hide"><li>减免方式（订单金额不含蛋筐押金）</li><li ng-repeat="today in today.rules[\'1\']">当天第一笔订单≥{{today.rule_json.require_rmb}}元 立减 {{today.rule_json.return_profit}}元</li></ol></div><div class="row block block-col pt-10 pb-10"><div class="col-xs-12 text-center"><p class="alert alert-danger p-5" ng-if="fee > 0">亲，一次下单总金额不足{{free_amount}}元，将收取运费{{fee}}元。</p><h4 ng-if="rules.length > 0">您的订单可享受以下活动的优惠：</h4><h6 class="text-center origin" ng-repeat="rule in rules">{{rule.rule}}(配送时间不能晚于{{rule.latest_deliver_time}})</h6></div><h4 class="col-xs-12 green"><span class="glyphicon glyphicon-gift m-r-5"></span>请确认订单内容</h4><div class="col-xs-12"><div class="row pb-10 pt-10 block-col" ng-repeat="item in cartlist.items[0].list"><div class="col-xs-6">{{item.title}}<span class="text-warning"><br><small ng-repeat="spec in item.spec" ng-show="spec.val">{{spec.name}}：{{spec.val}}<br></small></span></div><div class="col-xs-3 text-center text-danger pl-0 pr-0">&yen; {{item.price}}</div><div class="col-xs-3 text-center pl-0 pr-0">{{item.quantity}}</div></div></div></div><div class="row block"><div class="col-xs-12"><a ui-sref="page.chooseCoupon"><h4 class="green pull-left"><span class="pr sprite sprite-my_info zoom5"></span> 优惠劵 <span class="label label-success m-l-5" ng-show="coupon.active_data && coupon.active_data.length != 0"><span class="orange">{{coupon.active_data.length}}</span>张可用</span> <span class="label label-default m-l-5" ng-show="coupon.active_data && coupon.active_data.length == 0">无可用</span></h4><h5 class="pull-right text-333" ng-show="coupon.choose_sum">已抵用<span class="orange">{{coupon.choose_sum}}</span>元<span class="glyphicon glyphicon-chevron-right"></span></h5><h5 class="pull-right text-333" ng-show="!coupon.choose_sum">未使用<span class="glyphicon glyphicon-chevron-right"></span></h5></a></div></div><div class="row block"><div class="col-xs-12 text-right"><h5>商品总计<span class="origin">{{total_price}}</span>元</h5><h5 ng-if="serviceFee > 0">服务费<span class="origin">+ {{serviceFee}}</span>元</h5><h5>运费<span class="origin">+ {{fee}}</span>元</h5><h5>优惠<span class="origin">- {{minus_amount}}</span>元</h5><h5>应付<span class="origin">{{sum_price | money : 2}}</span>元</h5></div></div><form name="confirmForm" role="form" novalidate="" ng-submit="confirm(cartlist.items[0].sum);"><div class="row block pt-10 pb-10" ng-if="showPayType"><h4 class="col-xs-12 green"><span class="glyphicon glyphicon-bullhorn m-r-5"></span>请选择支付方式<small class="text-warning" ng-if="pay_events_title !=\'\'">&nbsp;{{pay_events_title}}</small></h4><div class="radio"><label class="col-xs-6 pl-20" style="position:relative;"><input type="radio" name="pay-radios" class="pay-radio font-18" ng-click="payby(1)"><span class="pl-5 font-18">微信支付</span> <span class="lable label-danger pay_reduce" ng-if="init_pay_reduce > 0"><small>立减{{init_pay_reduce}}元</small></span></label> <label class="col-xs-6 pl-20"><input type="radio" name="pay-radios" class="pay-radio font-18" ng-click="payby(0)"><span class="pl-5 font-18">货到付款</span></label></div></div><div class="row block block-col form pt-10 pb-70"><h4 class="col-xs-12">请选择期望送货时间</h4><div class="col-xs-12"><div class="row pb-10 pt-10 block-col"><div class="col-xs-6"><select class="input-lg w100" ng-model="deliver_date" ng-options="m.name for m in dates" ng-change="dateChange();" required=""><option value="">请选择送货日期</option></select></div><div class="col-xs-6"><select class="input-lg w100" ng-model="deliver_time" ng-options="m.msg for m in times" required=""><option value="">请选择送货时间</option></select></div></div></div><div class="form-group" ng-if="!showLoading"><div class="col-xs-12"><h4>收货地址</h4><label>{{uinfo.address}}</label><h5>收货人：{{uinfo.name}}({{uinfo.mobile}})</h5></div></div><div class="form-group"><div class="col-xs-12"><h4>其他要求</h4><textarea id="content" class="input-lg form-control" rows="3" ng-model="remarks" placeholder="请输入其他要求"></textarea></div></div></div><div class="row col-xs-12 pb-10 pt-20 confirm-fix"><button class="btn btn-block btn-lg btn-success" type="submit">确认订单</button></div></form></div>'),t.put("app/modules/home/home.html",'<header class="head"><div class="container-fluid"><div class="row head-top"><div class="col-xs-3 backup text-left"><a reback="" ng-show="$state.current.data.showBack"><span class="glyphicon glyphicon-menu-left pull-left back_btn"></span><span class="pull-left">返回</span></a> <span ng-show="!$state.current.data.showBack"><a ng-if="!isLogined" ui-sref="page.citySelect">{{localInfo.name}} <span class="glyphicon glyphicon-chevron-down"></span></a> <a ng-if="isLogined">{{localInfo.name}} <span class="glyphicon glyphicon-map-marker"></span></a></span></div><div class="col-xs-9 backup text-center"><form novalidate="" name="searchForm" class="pr"><div class="form-group m-0 search_box w100"><input type="text" class="form-control m-0 hei-30 text-center" name="searchForm.name" ng-model="DC.search_name" required="" placeholder="搜索食材" ng-focus="DC.search(searchForm)"></div></form></div></div></div></header><div class="warp-page container-fluid" active_class="autoCart"><div class="row mb-10" ng-show="showAdv"><carousel interval="myinterval" class="pr-0 pl-0 col-xs-12"><slide ng-repeat="slide in slides"><div class="thumbnail mb-0 p-0 b-rd-0 b-0"><a ui-sref="{{slide.sref}}" class="diy_block"><img ng-src="{{slide.url}}" alt="{{slide.caption}}" class="img-thumbnail b-0 p-0 b-rd-0"></a></div></slide><carousel></carousel></carousel></div><section class="i_list"><div ng-if="DC.recommends" ng-repeat="item in DC.recommends"><div class="row block mb-0 br-l-2 br-b-1"><div class="col-xs-12 p-lr-10"><a ui-sref="page.coupon" class="text-333"><h4 class="pull-left green">{{item.title}}</h4></a></div></div><div class="row hot_list br-b-1 mb-10"><div class="col-xs-6 p-0 img-w"><a ui-sref="page.search({searchVal : item.products[0].title})" class="text-333"><h4 class="pl-10 text-ov text-left">{{item.products[0].title}}</h4><h4 class="red pl-10 mt-0 text-14">￥{{item.products[0].price}}/{{item.products[0].unit}}</h4><div class="text-center"><img ng-if="item.products[0].big_imgs[0].pic_url" ng-src="{{item.products[0].big_imgs.length && item.products[0].big_imgs[0].pic_url}}"> <img ng-if="!item.products[0].big_imgs[0].pic_url" ng-src="/assets/images/df_pic.png"></div></a></div><div class="col-xs-6 p-0 text-center img-w recommend"><div class="col-xs-6 p-0 text-left" ng-repeat="items in item.products" ng-class="{ b_b_0 : $index == item.products.length - 2 || $index == item.products.length - 1 }" ng-if="$index != 0"><a ui-sref="page.search({searchVal : items.title})" class="text-333"><h4 class="text-ov">{{items.title}}</h4><h4 class="red mt-0 text-14 text-ov"><span class="red">￥{{items.price}}</span>/{{items.unit}}</h4><div><img ng-if="items.big_imgs.length && items.big_imgs[0].pic_url" ng-src="{{items.big_imgs.length && items.big_imgs[0].pic_url}}"> <img ng-if="!items.big_imgs[0].pic_url" ng-src="/assets/images/df_pic.png"></div></a></div></div></div></div><div class="row hot_list br-b-1 hei-68"><div class="col-xs-6 br-rb-1" ng-repeat="cate in category" ng-class="{ b_b_0 : $index == category.length-2 && category.length%2 != 1 || $index == category.length - 1 }"><a ui-sref="page.category({cateId:{{cate.cate_child.length && cate.cate_child[0].id}}})" class="text-333"><div class="col-xs-8 pull-left pl-0 pr-5"><h4 class="green text-16 text-ov">{{cate.cate_parent}}</h4><p class="text-ov"><span ng-repeat="item in cate.cate_child" ng-show="$index <= 3">{{item.name}}/</span></p></div><div class="col-xs-4 pull-right p-0 mt-10 text-center"><img ng-src="assets/images/category/{{cate.cate_parent}}.png"></div></a></div></div></section></div>'),t.put("app/modules/list/category.html",'<header class="head"><div class="container-fluid"><div class="row head-top"><div class="col-xs-3 backup text-left"><a reback="" ng-show="$state.current.data.showBack"><span class="glyphicon glyphicon-menu-left pull-left back_btn"></span><span class="pull-left">返回</span></a> <span ng-show="!$state.current.data.showBack"><a ng-if="!isLogined" ui-sref="page.citySelect">{{localInfo.name}} <span class="glyphicon glyphicon-chevron-down"></span></a> <a ng-if="isLogined">{{localInfo.name}}</a></span></div><div class="col-xs-9 backup text-center"><form novalidate="" name="searchForm" class="pr"><div class="form-group m-0 search_box w100"><input type="text" class="form-control m-0 hei-30 text-center" name="searchForm.name" ng-model="DC.search_name" required="" placeholder="搜索食材" ng-focus="DC.search(searchForm)"></div></form></div></div></div></header><div class="warp-page container-fluid white_bg"><div class="nav white_bg row nav_list br-b-1 pr"><div class="nav_mask animated" active_class="mask"><span class="zoom5"><img ng-src="assets/images/arrow.png"></span> <span class="zoom5 m-lr-10"><img ng-src="assets/images/hand.png" class="animated infinite"></span> 滑动切换分类 <span class="zoom5 ml-10"><img ng-src="assets/images/arrow_r.png"></span></div><ol class="list-none nav-text pl-0 m-0 text-18"><li ng-repeat="cate in category" class="" ng-class="{ br_b_2 : DC.cate_id == cate.cate_parent_id}" active_class="nav_list" ng-click="DC.active_list(cate.cate_child)">{{cate.cate_parent}}</li></ol></div><section class="i_list pt-10"><div class="row min-500" active_class="autoList"><div class="col-xs-3 min-500 flex-center pt-0 slide_list"><div><p class="c_mt10 title m-0 p-tb-10" active_class="slide_list" ng-click="DC.product(cate.id)" ng-repeat="cate in DC.data" ng-class="{greenB_textF: cate.id == DC.state}">{{cate.name}}</p></div></div><div class="col-xs-9 i_class pt-0"><div ui-view="list"></div></div></div></section></div>'),t.put("app/modules/list/list.html",'<div ng-show="show_loading === true"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div ng-if="products.length == 0" class="row m-0 block block-col"><div class="col-xs-12 text-center pt-10 pb-10"><img ng-src="assets/images/no_bg.png" class="zoom5 mt-100"><h4 class="text-gray">暂时没有符合条件的订单</h4></div></div><div class="p-b-90"><div class="row m-0" ng-repeat="product in products"><ul class="seconedlist-ul clearfix"><li ng-class="{ b_b_0 : $index == products.length -1 }"><div class="col-xs-4 pb-10 pr-0 img_show text-center" ng-if="product.pictures[0].pic_url"><img ng-click="lightBox(product.big_imgs)" class="img-rounded zoom8" ng-src="{{product.pictures[0].pic_url}}"></div><div class="pull-left info pl-10 pr-10" ng-class="{\'col-xs-8\':product.pictures[0].pic_url,\'col-xs-12\':!product.pictures[0].pic_url}"><div class="col-xs-12 p-0"><h4 class="text-16" ng-class="{mt_0 : $index == 0}">{{product.title}}</h4></div><div class="col-xs-12 p-0" ng-if="product.adv_words"><h6 class="text-danger mt-0">{{product.adv_words}}</h6></div><h6 ng-repeat="spec in product.spec" ng-show="spec.val">{{spec.name}}：<span>{{spec.val}}</span></h6><h6>价格： <span ng-if="product.is_round == 1">约</span> <span class="text-danger">&yen;{{product.price}}</span> <span style="text-decoration:line-through" ng-show="false">&nbsp;&yen;{{product.market_price}}</span> <span ng-if="product.unit">/{{product.unit}}</span> <span class="orange" ng-if="product.buy_limit != 0">&nbsp; (限购{{product.buy_limit}}{{product.unit}})</span></h6><h6 class="text-default" ng-if="product.unit != product.close_unit_name && product.close_unit_name">单价：{{product.single_price}}/{{product.close_unit_name}}</h6><h6 class="text-danger" ng-if="product.close_unit_name != product.unit && product.close_unit_name">按{{product.unit}}售卖, 按{{product.close_unit_name}}结算</h6><h6 ng-if="product.storage >0">库存： 剩余{{product.storage}}{{product.unit}}</h6></div><div class="col-xs-12 pd-0"><div class="col-xs-6 pr-0 pl-10 pull-left"><div class="text-danger pt-pb-6" ng-show="cartlist.ids.indexOf(product.id) >= 0">已加入{{product.quantity}}{{product.unit}}</div><div class="diy_cartP input-group input-group-sm mb-0" ng-show="cartlist.ids.indexOf(product.id) < 0"><span class="input-group-addon order-btn-minus"><em class="glyphicon glyphicon-minus disa text-primary" ng-click="minus(product)"></em></span> <input type="number" min="1" class="prval form-control text-center" ng-model="product.quantity" ng-focus="clearNum(product)" ng-blur="setNum(product, true)" ng-change="setNum(product)"> <span class="input-group-addon order-btn-plus"><em class="glyphicon glyphicon-plus text-primary reset_btn" ng-disabled="is_limit" ng-click="plus(product)"></em></span></div></div><div class="col-xs-5 pl-0 pr-10 pull-right text-right" ng-show="product.storage == 0"><button class="is_shop white-c btn btn-defualt w100 cart_btn" ng-disabled="true"><span class="text">&nbsp;已售罄&nbsp;</span></button></div><div class="col-xs-5 pl-0 pr-10 pull-right text-right" ng-show="product.storage > 0 || product.storage == -1"><button class="is_shop btn btn-lightGreen w100 cart_btn" id="{{product.id}}" ng-click="toggleItems(product, product.quantity)" set-class="{{product}}"><span class="text">加入购物车</span></button></div></div></li></ul></div></div>'),t.put("app/modules/list/search.html",'<header class="head"><div class="container-fluid"><div class="row head-top"><form novalidate="" name="searchForm" class="pr"><div class="col-xs-2 backup text-left pull-right text-center" ng-click="DC.search(searchForm , $event)">搜索</div><div class="col-xs-10 backup text-center"><div ng-click="DC.reset()" class="search_rm_box"><span class="glyphicon glyphicon-remove search_rm"></span></div><div class="form-group m-0 search_box w100"><input type="text" class="form-control m-0 hei-30" name="searchForm.name" ng-model="DC.search_name" required="" ng-blur="" autofocus="autofocus" active_class="autoFocus"></div></div></form></div></div></header><div class="warp-page container-fluid white_bg" active_class="autoCart" scroll-class="getProduct(DC.search_name, DC.page , \'product/search\')" can-load="canLoad" max-length="data.total"><div ng-if="products.length == 0" class="row m-0 text-center block-col"><img ng-src="assets/images/no_bg.png" class="zoom5 mt-100"><div class="col-xs-12 pt-10 pb-10 text-center text-gray" role="alert"><h4>抱歉！暂无此商品</h4></div></div><div class="row" ng-if="products.length != 0"><div class="row m-0" ng-repeat="product in products"><ul class="seconedlist-ul clearfix"><li ng-class="{ b_b_0 : $index == products.length -1 }"><div class="col-xs-4 pb-10 mt-10 pr-0 img_show text-center" ng-if="product.pictures[0].pic_url"><img ng-click="lightBox(product.big_imgs)" class="img-rounded zoom8" ng-src="{{product.pictures[0].pic_url}}"></div><div class="pull-left info pl-10 pr-10" ng-class="{\'col-xs-8\':product.pictures[0].pic_url,\'col-xs-12\':!product.pictures[0].pic_url}"><div class="col-xs-12 p-0"><h4 class="text-16">{{product.title}}</h4></div><div class="col-xs-12 p-0" ng-if="product.adv_words"><h6 class="text-danger mt-0">{{product.adv_words}}</h6></div><h6 ng-repeat="spec in product.spec" ng-show="spec.val">{{spec.name}}：<span>{{spec.val}}</span></h6><h6>价格： <span ng-if="product.is_round == 1">约</span> <span class="text-danger">&yen;{{product.price}}</span> <span style="text-decoration:line-through" ng-show="false">&nbsp;&yen;{{product.market_price}}</span> <span ng-if="product.unit">/{{product.unit}}</span> <span class="orange" ng-if="product.buy_limit != 0">&nbsp; (限购{{product.buy_limit}}{{product.unit}})</span></h6><h6 class="text-default" ng-if="product.unit != product.close_unit_name && product.close_unit_name">单价：{{product.single_price}}/{{product.close_unit_name}}</h6><h6 class="text-danger" ng-if="product.close_unit_name != product.unit && product.close_unit_name">按{{product.unit}}售卖, 按{{product.close_unit_name}}结算</h6><h6 ng-if="product.storage >0">库存： 剩余{{product.storage}}{{product.unit}}</h6></div><div class="col-xs-12 pd-0"><div class="col-xs-6 pr-0 pl-10 pull-left"><div class="text-danger pt-pb-6" ng-show="cartlist.ids.indexOf(product.id) >= 0">已加入{{product.quantity}}{{product.unit}}</div><div class="diy_cartP input-group input-group-sm mb-0" ng-show="cartlist.ids.indexOf(product.id) < 0"><span class="input-group-addon order-btn-minus"><em class="glyphicon glyphicon-minus disa text-primary" ng-click="minus(product)"></em></span> <input type="number" min="1" class="prval form-control text-center" ng-model="product.quantity" ng-focus="clearNum(product)" ng-blur="setNum(product, true)" ng-change="setNum(product)"> <span class="input-group-addon order-btn-plus"><em class="glyphicon glyphicon-plus text-primary reset_btn" ng-disabled="is_limit" ng-click="plus(product)"></em></span></div></div><div class="col-xs-5 pl-0 pr-10 pull-right text-right" ng-show="product.storage == 0"><button class="is_shop white-c btn btn-defualt w100 cart_btn" ng-disabled="true"><span class="text">&nbsp;已售罄&nbsp;</span></button></div><div class="col-xs-5 pl-0 pr-10 pull-right text-right" ng-show="product.storage > 0 || product.storage == -1"><button class="is_shop btn btn-lightGreen w100 cart_btn" id="{{product.id}}" ng-click="toggleItems(product, product.quantity)" set-class="{{product}}"><span class="text">加入购物车</span></button></div></div></li></ul></div></div><div ng-show="show_loading === true"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div>'),t.put("app/modules/order/orderList.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="m-t-41" active_class="autoList"><div class="head-bottom"><div class="flex-nav"><ul class="flex-center"><li ng-class="{active : showType == tab.status}" ng-repeat="tab in tabs"><a ng-click="setStatus({{tab.status}});">{{tab.name}}</a></li></ul></div></div><div ng-show="isProcessing"><div class="loading_spinner spinner-hv-center"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="clearfix"><div class="row block-col block m-0" ng-show="orderlist.length == 0 && isProcessing == false" active_class="autoList"><div class="col-xs-12 text-center pt-10 pb-10"><img ng-src="assets/images/no_bg.png" class="zoom5 mt-100"><h4 class="text-gray">暂时没有符合条件的订单</h4></div></div><ul class="orderList" ng-show="orderlist.length > 0"><li ng-repeat="order in orderlist" class="m-0"><header class="orderlist_hd oGreen clearfix"><span class="f_right">订单号: {{order.order_number}}</span> <span>状态：{{order.status_cn}}</span></header><section class="orderlist_bd"><ul class="orderlist_zi" ng-show="order.suborders.length > 0"><li ng-repeat="o in order.suborders"><header class="clearfix m-0"><span class="f_right">订单号: {{o.order_number}}</span> <span>子订单{{$index + 1}}:{{o.status.cn}}</span></header><section ng-repeat="detail in o.details"><h4 class="clearfix text-14"><span class="f_right oGreens">&yen;{{detail.price}}</span> <span class="oGreen">{{detail.name}}</span></h4><div class="clearfix orderinfo"><span class="f_right">X{{detail.quantity}}</span><p class="m-r-5" ng-repeat="spec in detail.spec">{{spec.name}}：{{spec.val}}</p></div></section><footer class="clearfix"><p class="f_right"><span>优惠:{{o.minus_amount}}元</span> <span class="m-l-10">运费:{{o.deliver_fee}}元</span> <span class="m-l-10">实收: <span class="oOrange">&yen; {{o.final_price}}</span></span></p></footer></li></ul></section><footer><div class="pay_type clearfix"><div class="f_left">支付方式：<span class="oOrange">{{order.pay_type_cn}}</span></div><div class="pay_money f_right"><p ng-if="order.minus_amount >= 0">优惠：&yen;{{order.minus_amount}}</p><p ng-if="order.service_fee > 0">服务费：&yen;{{order.service_fee}}</p><p ng-if="order.deliver_fee >= 0">运费：&yen;{{order.deliver_fee}}</p>实收&nbsp;&nbsp;<span class="origin">&yen;{{order.final_price}}</span></div></div><div class="pay_time clearfix"><div class="f_left"><p>下单时间：{{order.created_time}}</p><p>配送时间：{{order.deliver_date}} {{order.deliver_time}}</p></div><div class="pay_btn clearfix"><button class="btn btn-default cancelBtn" ng-if="showType == 2 && order.pay_status != 1" ng-click="cancel({{order.id}}, order.minus_amount);">取消订单</button> <button class="btn weixin_btn" ng-if="showType == 2 && order.pay_type == 1 && order.pay_status == 0" ng-click="pay(order.order_number);">微信支付</button></div></div></footer></li></ul></div></div>'),t.put("app/modules/page/page.html",'<div ui-view="">Loading...........</div><nav class="nav fix-bottom action-nav"><div class="container"><ul class="nav action-nav actionbar-tabs"><li class="col-xs-3"><a ui-sref="home.main"><span class="glyphicon glyphicon-home"></span>首页<span class="badge badge-alert badge-cart"></span></a></li><li class="col-xs-3"><a ui-sref="page.order"><span class="glyphicon glyphicon-shopping-cart"></span>采购清单<span class="badge badge-alert badge-cart"></span></a></li><li class="col-xs-3"><a ui-sref="confirm"><span class="glyphicon glyphicon-list-alt"></span>我的订单<span class="badge badge-alert badge-cart"></span></a></li><li class="col-xs-3"><a ui-sref="home.main"><span class="glyphicon glyphicon-user"></span>个人中心<span class="badge badge-alert badge-cart"></span></a></li></ul></div></nav>'),t.put("app/modules/subjects/activity.html",'<div class="warp-page p-0 container-fluid"><div class="thumbnail mb-10 b-r-0 p-0" ng-if="products"><a class="diy_block"><img ng-src="{{info.banner_url}}" class="b-0 p-0 b-r-0 img-thumbnail"></a></div><div ng-show="show_loading === true"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div ng-if="!products" class="row block block-col"><div class="row ml-0 mr-0"><img ng-src="{{info.pic_url}}" alt="{{info.title}}" class="col-xs-12 img-thumbnail pd-0"></div></div><div class="p-lr-15"><div class="row" ng-repeat="product in products"><ul class="seconedlist-ul clearfix"><li><div class="col-xs-12"><h4 class="green">{{product.title}}</h4></div><div class="col-xs-12" ng-if="product.adv_words"><h6 class="text-danger">{{product.adv_words}}</h6></div><div class="col-xs-4 pb-10 img_show text-center" ng-if="product.pictures[0].pic_url"><img ng-click="lightBox(product.big_imgs)" class="img-rounded zoom8" ng-src="{{product.pictures[0].pic_url}}"></div><div class="pull-left pb-10 info" ng-class="{\'col-xs-8\':product.pictures[0].pic_url,\'col-xs-12\':!product.pictures[0].pic_url}"><h6 ng-repeat="spec in product.spec" ng-show="spec.val">{{spec.name}}：<span>{{spec.val}}</span></h6><h6>价格： <span ng-if="product.is_round == 1">约</span> <span class="text-danger">&yen;{{product.price}}</span> <span style="text-decoration:line-through" ng-show="false">&nbsp;&yen;{{product.market_price}}</span> <span ng-if="product.unit">/{{product.unit}}</span> <span class="text-danger" ng-if="product.buy_limit != 0">&nbsp; (限购{{product.buy_limit}}{{product.unit}})</span></h6><h6 class="text-default" ng-if="product.unit != product.close_unit_name && product.close_unit_name">单价：{{product.single_price}}/{{product.close_unit_name}}</h6><h6 class="text-danger" ng-if="product.close_unit_name != product.unit && product.close_unit_name">按{{product.unit}}售卖, 按{{product.close_unit_name}}结算</h6></div><div class="col-xs-12 pb-10 row_br" ng-if="product.storage == 0 && 0"><span class="text-warning">已卖完咯，请等待下一次促销</span></div><div class="col-xs-12 pd-0 pb-10 row_br" ng-if="product.storage != 0"><div class="col-xs-5 pr-0 pull-left"><div class="text-danger pt-pb-6" ng-show="cartlist.ids.indexOf(product.id) >= 0">已加入{{product.quantity}}{{product.unit}}</div><div class="diy_cartP input-group input-group-sm" ng-show="cartlist.ids.indexOf(product.id) < 0"><span class="input-group-addon order-btn-minus"><em class="glyphicon glyphicon-minus disa text-primary" ng-click="minus(product)"></em></span> <input type="number" min="1" class="prval form-control text-center" ng-model="product.quantity" ng-focus="clearNum(product)" ng-blur="setNum(product, true)" ng-change="setNum(product)"> <span class="input-group-addon order-btn-plus"><em class="glyphicon glyphicon-plus text-primary reset_btn" ng-disabled="is_limit" ng-click="plus(product)"></em></span></div></div><div class="col-xs-3 pl-0 pr-0 pt-pb-6" ng-if="product.storage >0">&nbsp; 剩余{{product.storage}}{{product.unit}}</div><div class="col-xs-4 pl-0 pull-right text-right mb-10" ng-show="product.storage == 0"><button class="is_shop white-c btn btn-defualt w100" ng-disabled="true"><span class="text">&nbsp;已售罄&nbsp;</span></button></div><div class="col-xs-4 pl-0 pull-right text-right mb-10"><button class="is_shop btn btn-warning w100" id="{{product.id}}" ng-click="toggleItems(product, product.quantity)" set-class="{{product}}"><span class="text">加入购物车</span></button></div></div></li></ul></div></div><div class="thumbnail mb-0 b-r-0 p-0" ng-if="products"><a class="diy_block"><img ng-src="{{info.detail_img}}" class="b-0 b-r-0 img-thumbnail p-0"></a></div></div>'),t.put("app/modules/user/center.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="warp-page container-fluid diy_center" ng-show="!showLoading"><div class="row block b_b_0"><div class="col-xs-12"><a ui-sref="page.info" class="text-333 info_header"><h4 class="pull-left hei-60 -m-t-15"><span class="middle wh-60"><img ng-src="/assets/images/man_center.png" class="scale5 origin-0"></span> <span class="m-l-10 middle m-l-50">{{uinfo.mobile}}</span></h4><h5 class="pull-right text-333 mt-33"><span class="glyphicon glyphicon-chevron-right text-gray"></span></h5></a></div></div><div class="row block b_b_0"><div class="col-xs-12 br-b-1"><h4 class="green"><div class="inline hw-20 -ml-10 pt-5"><span class="pr sprite sprite-my_order scale5"></span></div>我的订单</h4></div><div class="col-xs-12 block-col center_nav p-tb-15 b_b_0"><div class="col-xs-3 pr p-0"><a ng-href="/order/list/2" class="text-primary"><div class="text-center hei-24"><span class="pr sprite sprite-wati_ok scale5 hei-40"><span class="badge white_bg orange_br orange" ng-show="order[2] != 0">{{order[2]}}</span></span></div><h5 class="text-center m-0">待确认</h5></a></div><div class="col-xs-3 pr"><a ng-href="/order/list/100" class="text-primary"><div class="text-center hei-24"><span class="pr sprite sprite-wati_sh scale5"><span class="badge white_bg orange_br orange" ng-show="order[100] != 0">{{order[100]}}</span></span></div><h5 class="text-center m-0">待收货</h5></a></div><div class="col-xs-3 pr"><a ng-href="/order/list/1" class="text-primary"><div class="text-center hei-24"><span class="pr sprite sprite-order_success scale5"><span class="badge white_bg orange_br orange" ng-show="order[1] != 0">{{order[1]}}</span></span></div><h5 class="text-center m-0">已完成</h5></a></div><div class="col-xs-3 pr"><a ng-href="/order/list/0" class="text-primary"><div class="text-center hei-24"><span class="pr sprite sprite-order_close scale5"><span class="badge white_bg orange_br orange" ng-show="order[0] != 0">{{order[0]}}</span></span></div><h5 class="text-center m-0">已关闭</h5></a></div></div></div><div class="row block b_b_0"><div class="col-xs-12"><a ui-sref="page.often"><h4 class="green pull-left"><div class="inline hw-20 -ml-10 pt-5 mr-5"><img ng-src="assets/images/often.png" class="scale5"></div>经常购买</h4><h5 class="pull-right text-333"><span class="glyphicon glyphicon-chevron-right text-gray"></span></h5></a></div></div><div class="row block b_b_0"><div class="col-xs-12"><a ui-sref="page.coupon"><h4 class="green pull-left flex_c"><div class="inline hw-20 -ml-10 pt-2 mr-5"><span class="pr sprite sprite-my_info scale5"></span></div>我的优惠劵</h4><h5 class="pull-right text-333"><span class="orange">{{valid_coupon_nums||0}}</span> 张优惠劵可用<span class="glyphicon glyphicon-chevron-right text-gray"></span></h5></a></div></div></div>'),t.put("app/modules/user/chooseCoupon.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="warp-page container-fluid diy_center" ng-show="!showLoading" active_class="autoCart"><div class="row block-col block" ng-show="coupon && coupon.length == 0" active_class="autoCart"><div class="col-xs-12 text-center pt-10 pb-10"><img ng-src="assets/images/no_bg.png" class="zoom5 mt-100"><h4 class="text-gray">暂时没有符合条件优惠劵</h4></div></div><div class="row mb-10 mt-10" ng-show="coupon && coupon.length != 0"><div class="col-xs-12 mb-10 white_bg" ng-repeat="item in coupon" ng-show="item.status == 1" ng-click="choose_sum(item)"><div class="col-xs-4 text-center sz-24 sprite-green_3_bg sprite_bg white"><span class="zoom2 text-center line-80">￥{{item.detail.minus_amount}}</span></div><div class="col-xs-8 white_bg p-0 pl-10"><p class="mt-10 mb-0" ng-show="item.detail.require_amount > 0">满<span class="green">{{item.detail.require_amount}}</span>元可用<br><span>({{item.detail.description}})</span></p><p class="mt-10 mb-0" ng-show="item.detail.require_amount == 0">{{item.detail.rule_type_cn}}<br><span>({{item.detail.description}})</span><span></span></p><p class="text-gray text-12">有效期{{item.detail.valid_time}}至{{item.detail.invalid_time}}</p></div></div></div></div>'),t.put("app/modules/user/coupon.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="warp-page container-fluid diy_center" ng-show="!showLoading"><div class="row block"><div class="col-xs-12"><h4 class="p-0 m-0 line-40 col-xs-6 text-center" ng-class="{green_active: !current}" ng-click="active()">可用({{coupon.ucenterList.active_data.length}})</h4><h4 class="p-0 m-0 line-40 col-xs-6 text-center" ng-class="{green_active: current }" ng-click="no_active()">不可用({{coupon.ucenterList.inactive_data.length}})</h4></div></div><div class="row mb-10" ng-show="!current"><div class="row block-col block" active_class="autoHeight" ng-show="coupon.ucenterList.active_data && coupon.ucenterList.active_data.length == 0"><div class="col-xs-12 text-center pt-10 pb-10"><img ng-src="assets/images/no_bg.png" class="zoom5 mt-100"><h4 class="text-gray">暂时没有符合条件优惠劵</h4></div></div><div class="col-xs-12 mb-10 white_bg" ng-repeat="item in coupon.ucenterList.active_data" ng-show="item.status == 1 || item.status == 2"><div class="col-xs-4 text-center sz-24 sprite-green_3_bg sprite_bg white"><span class="zoom2 text-center line-80">￥{{item.detail.minus_amount}}</span></div><div class="col-xs-8 white_bg p-0 pl-10"><p class="mt-10 mb-0" ng-show="item.detail.require_amount > 0">满<span class="green">{{item.detail.require_amount}}</span>元可用<br><span>({{item.detail.description}})</span></p><p class="mt-10 mb-0" ng-show="item.detail.require_amount == 0">{{item.detail.rule_type_cn}}<br><span>({{item.detail.description}})</span></p><p class="text-gray text-12">有效期{{item.detail.valid_time}}至{{item.detail.invalid_time}}</p><span class="line-80 green coupon_tips" ng-show="item.status == 1">已生效</span> <span class="line-80 orange coupon_tips" ng-show="item.status == 2">未生效</span></div></div></div><!-不可用-!><div class="row mb-10" ng-show="current"><div class="row block-col block" active_class="autoHeight" ng-show="coupon.ucenterList.inactive_data && coupon.ucenterList.inactive_data.length == 0"><div class="col-xs-12 text-center pt-10 pb-10"><img ng-src="assets/images/no_bg.png" class="zoom5 mt-100"><h4 class="text-gray">暂时没有符合条件优惠劵</h4></div></div><div class="col-xs-12 mb-10 white_bg pr" ng-repeat="item in coupon.ucenterList.inactive_data" ng-show="item.status == 3 || item.status == 4"><div class="col-xs-4 text-center sz-24 sprite_bg white" ng-class="{spriteGrayBg: item.status == 4 , spriteYellowBg: item.status == 3 }"><span class="zoom2 text-center line-80">￥{{item.detail.minus_amount}}</span></div><div class="col-xs-8 white_bg p-0 pl-10"><p class="mt-10 mb-0" ng-show="item.detail.require_amount > 0">满<span class="green">{{item.detail.require_amount}}</span>元可用<br><span>({{item.detail.description}})</span></p><p class="mt-10 mb-0" ng-show="item.detail.require_amount == 0">{{item.detail.rule_type_cn}}<br><span>({{item.detail.description}})</span></p><p class="text-gray text-12">有效期{{item.detail.valid_time}}至{{item.detail.invalid_time}}</p><span class="line-80 orange coupon_tips" ng-show="item.status == 4">已过期</span> <span class="line-80 orange coupon_tips" ng-show="item.status == 3">已使用</span></div></div></div></div>'),t.put("app/modules/user/edit.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid"><form class="row block block-col form-horizontal" role="form" ng-submit="save()" ng-controller="UserEditCtrl"><div class="form-group col-xs-12"><label for="name" class="col-sm-2 control-label"><h5><b>姓名</b></h5></label><div class="col-sm-10"><input type="text" required="" class="input-lg form-control" ng-model="reg.name" name="mobile" id="name" placeholder="请输入您的姓名"></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="address" class="col-sm-2 control-label"><h5><b>地理位置</b></h5></label><div class="col-sm-10"><select ng-model="addr.province" class="input-lg form-control" ng-options="m.name for m in provinces" ng-change="get_child(\'citys\', \'province\');get_market(\'province\')" required=""><option value="">选择省份</option></select><select ng-model="addr.city" ng-options="c.name for c in citys" ng-change="get_child(\'countys\', \'city\');get_market(\'city\')" class="block-space input-lg form-control" required=""><option value="">--选择城市--</option></select><select ng-model="addr.county" ng-options="x.name for x in countys" class="block-space input-lg form-control"><option value="">--选择县--</option></select></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="market" class="col-sm-2 control-label"><h5><b>市场位置</b></h5></label><div class="col-sm-10"><select required="" ng-model="addr.market" class="form-control input-lg" ng-options="m.name for m in markets"><option value="">选择市场信息</option></select></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="detail_address" class="col-sm-2 control-label"><h5><b>详细地址(档口,饭馆名)</b></h5></label><div class="col-sm-10"><input required="" type="text" class="input-lg form-control" ng-model="reg.detailAddress" name="detail_address" id="detail_address" placeholder="请输入详细地址"></div></div><div class="form-group col-xs-12"><div class="col-xs-6"><button type="submit" class="btn col-xs-12 btn-success btn-lg">保存</button></div><div class="col-xs-6"><a ng-click="discard()" class="btn btn-danger btn-lg btn-block">取消</a></div></div></form></div>'),t.put("app/modules/user/info.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="warp-page container-fluid diy_center" ng-show="!showLoading" active_class="autoCart"><div class="row block"><div class="col-xs-12 man_bg text-white"><h4 class=""><span class="zoom5 middle"><img ng-src="/assets/images/man_top.png"></span></h4><h4>{{uinfo.mobile}}</h4><h5><a ng-href="/user/password" class="text-gray"><span class="glyphicon glyphicon-pencil m-r-5"></span>修改密码</a></h5></div></div><div class="row block"><div class="col-xs-12 block-col"><h5>姓名：{{uinfo.name}}</h5></div><div class="col-xs-12 block-col"><h5>店铺名称：{{uinfo.shop_name}}</h5></div><div class="col-xs-12 block-col"><h5>地址：{{uinfo.address}}</h5></div><div class="col-xs-12 block-col"><h5>电话：{{uinfo.mobile}}</h5></div></div><div class="row block-btn pb-10"><div class="col-xs-12"><a ng-click="logout()" class="btn btn-danger btn-lg btn-block diy_btnD">退出登录</a></div></div></div>'),t.put("app/modules/user/login.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center" style="font-size:14px;">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="cancel();" ng-if="items.tel"> <a href="tel:{{items.tel}}"><span class="glyphicon glyphicon-phone-alt m-r-5"></span>{{items.tel}}</a> </button> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="login_bg container-fluid"><div class="logo"><h3>大厨网</h3></div><div class="slogan"><h5>[ 让人们吃得安心 ]</h5></div><form class="login-form row block block-col form resetbd" name="loginForm" role="form" novalidate="" ng-submit="login()"><div class="form_content"><div class="form-group col-xs-12"><span ng-class="{green : isgreen}" class="glyphicon glyphicon-user diy_icon"></span><input type="tel" required="" class="input-md form-control" ng-model="user.mobile" ng-pattern="/^1[3|4|5|6|7|8|9]\\d{9}$/" ng-minlength="11" ng-maxlength="11" name="mobile" id="tel" placeholder="请输入手机号" ng-focus="focuss()" ng-blur="isgreen = 0"></div><div class="login_line"><span></span></div><div class="form-group col-xs-12"><span class="glyphicon glyphicon-lock diy_icon" ng-class="{greens : isgreens}"></span> <input type="password" required="" class="input-md form-control" ng-minlength="6" ng-model="user.password" name="password" id="password" placeholder="请输入密码" ng-focus="focus()" ng-blur="isgreens =0"></div><div class="form-group alert_box" ng-show="isL && loginForm.$valid && error.message"><div class="col-sm-10"><div class="alert alert-danger min_alert" style="margin-bottom: 0px"><ul><li role="alert">{{error.message}}</li></ul></div></div></div><div class="form-group alert_box mg" ng-show="loginForm.$invalid && loginForm.$dirty && show_error"><div class="col-sm-10"><div class="alert alert-danger min_alert" style="margin-bottom: 0px"><ul><li ng-show="loginForm.mobile.$error.minlength">请输入正确的手机号</li><li ng-show="!loginForm.mobile.$error.minlength && loginForm.mobile.$error.pattern">手机号格式不正确</li><li ng-show="loginForm.mobile.$error.required">手机号必填</li><li ng-show="loginForm.password.$error.minlength">密码至少6位</li><li ng-show="loginForm.password.$error.required">密码必填</li></ul></div></div></div></div><div class="form-group row"><div class="form-group col-xs-6 pull-right"><button type="submit" class="btn btn-success btn-md btn-block br-0">登录</button></div><div class="form-group col-xs-6"><a ng-href="#" ng-click="showTips()" class="btn btn-default btn-md btn-block br-0">注册</a></div></div></form></div>'),t.put("app/modules/user/often.html",'<div class="warp-page container-fluid white_bg" active_class="autoCart" scroll-class="getProduct(DC.search_name, DC.page , \'customer/always_buy_products\')" can-load="canLoad" max-length="data.total"><div ng-show="show_loading === true"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div ng-if="products.length == 0" class="row m-0 block block-col" active_class="autoCart"><div class="col-xs-12 text-center pt-10 pb-10"><img ng-src="assets/images/no_bg.png" class="zoom5 mt-100"><h4 class="text-gray">暂时没有符合条件的商品</h4></div></div><div class="row"><div class="row m-0" ng-repeat="product in products"><ul class="seconedlist-ul clearfix"><li ng-class="{ b_b_0 : $index == products.length -1 }"><div class="col-xs-4 pb-10 mt-10 pr-0 img_show text-center" ng-if="product.pictures[0].pic_url"><img ng-click="lightBox(product.big_imgs)" class="img-rounded zoom8" ng-src="{{product.pictures[0].pic_url}}"></div><div class="pull-left info pl-10 pr-10" ng-class="{\'col-xs-8\':product.pictures[0].pic_url,\'col-xs-12\':!product.pictures[0].pic_url}"><div class="col-xs-12 p-0"><h4 class="text-16">{{product.title}}</h4></div><div class="col-xs-12 p-0" ng-if="product.adv_words"><h6 class="text-danger mt-0">{{product.adv_words}}</h6></div><h6 ng-repeat="spec in product.spec" ng-show="spec.val">{{spec.name}}：<span>{{spec.val}}</span></h6><h6>价格： <span ng-if="product.is_round == 1">约</span> <span class="text-danger">&yen;{{product.price}}</span> <span style="text-decoration:line-through" ng-show="false">&nbsp;&yen;{{product.market_price}}</span> <span ng-if="product.unit">/{{product.unit}}</span> <span class="orange" ng-if="product.buy_limit != 0">&nbsp; (限购{{product.buy_limit}}{{product.unit}})</span></h6><h6 class="text-default" ng-if="product.unit != product.close_unit_name && product.close_unit_name">单价：{{product.single_price}}/{{product.close_unit_name}}</h6><h6 class="text-danger" ng-if="product.close_unit_name != product.unit && product.close_unit_name">按{{product.unit}}售卖, 按{{product.close_unit_name}}结算</h6><h6 ng-if="product.storage >0">库存： 剩余{{product.storage}}{{product.unit}}</h6></div><div class="col-xs-12 pd-0"><div class="col-xs-6 pr-0 pl-10 pull-left"><div class="text-danger pt-pb-6" ng-show="cartlist.ids.indexOf(product.id) >= 0">已加入{{product.quantity}}{{product.unit}}</div><div class="diy_cartP input-group input-group-sm mb-0" ng-show="cartlist.ids.indexOf(product.id) < 0"><span class="input-group-addon order-btn-minus"><em class="glyphicon glyphicon-minus disa text-primary" ng-click="minus(product)"></em></span> <input type="number" min="1" class="prval form-control text-center" ng-model="product.quantity" ng-focus="clearNum(product)" ng-blur="setNum(product, true)" ng-change="setNum(product)"> <span class="input-group-addon order-btn-plus"><em class="glyphicon glyphicon-plus text-primary reset_btn" ng-disabled="is_limit" ng-click="plus(product)"></em></span></div></div><div class="col-xs-5 pl-0 pr-10 pull-right text-right" ng-show="product.storage == 0"><button class="is_shop white-c btn btn-defualt w100 cart_btn" ng-disabled="true"><span class="text">&nbsp;已售罄&nbsp;</span></button></div><div class="col-xs-5 pl-0 pr-10 pull-right text-right" ng-show="product.storage > 0 || product.storage == -1"><button class="is_shop btn btn-lightGreen w100 cart_btn" id="{{product.id}}" ng-click="toggleItems(product, product.quantity)" set-class="{{product}}"><span class="text">加入购物车</span></button></div></div></li></ul></div></div></div>'),t.put("app/modules/user/password.html",'<div class="warp-page container-fluid mb-nav"><form class="row block block-col form-horizontal" role="form" novalidate="" ng-submit="changePassword()" ng-controller="UserPasswordController" name="passwordForm"><div class="form-group col-xs-12 pt-10 ml-0"><label for="password" class="control-label"><h5><b>旧密码</b></h5></label><div class=""><input type="password" required="" class="input-md form-control" ng-model="reg.password" id="password" placeholder="请输入您的旧密码" ng-minlength="6" name="oldpassword"></div></div><div class="form-group col-xs-12 ml-0"><label for="newpassword" class="control-label"><h5><b>新密码</b></h5></label><div class=""><input type="password" required="" class="input-md form-control" ng-model="reg.newPassword" id="newPassword" placeholder="请输入您的新密码" ng-minlength="6" name="password"></div></div><div class="form-group col-xs-12 ml-0"><label for="newpassword" class="control-label"><h5><b>重复输入新密码</b></h5></label><div class=""><input type="password" required="" class="input-md form-control" ng-model="reg.newRePassword" id="newRePassword" ng-minlength="6" placeholder="请再次输入您的新密码" name="repassword"></div></div><div class="form-group alert_box mg col-xs-12 ml-0" ng-show="passwordForm.$invalid && passwordForm.$dirty && show_error"><div class=""><div class="alert alert-danger min_alert" style="margin-bottom: 0px"><ul><li ng-show="passwordForm.oldpassword.$error.minlength">旧密码至少6位</li><li ng-show="passwordForm.oldpassword.$error.required">旧密码必填</li><li ng-show="passwordForm.password.$error.minlength">密码至少6位</li><li ng-show="passwordForm.password.$error.required">密码必填</li><li ng-show="passwordForm.repassword.$error.minlength">确认密码至少6位</li><li ng-show="passwordForm.repassword.$error.required">确认密码必填</li></ul></div></div></div><div class="form-group col-xs-12 ml-0"><div class="row block-btn"><div class="col-xs-12"><button type="submit" class="btn btn-block btn-success orangebtn btn-lg">确认修改</button></div></div></div></form></div>'),t.put("app/modules/user/register.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h4>{{items.bodyText}}</h4> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-alert" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid"><form name="regForm" class="row block block-col form-horizontal" role="form" novalidate="" ng-submit="register()" ng-controller="UserRegisterCtrl"><div class="form-group col-xs-12"><label for="market" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 您的身份</b></h6></label><div class="col-sm-10"><select required="" ng-model="addr.userType" name="userType" class="form-control input-md" ng-options="m.name for m in types"><option value="">选择身份</option></select><div class="col-xs-12 block-col label label-danger" ng-show="regForm.submitted && regForm.userType.$invalid"><small ng-show="regForm.userType.$error.required">请选择一个注册身份</small></div></div></div><div class="form-group col-xs-12"><label for="tel" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 手机</b></h6></label><div class="col-sm-10"><input type="text" phone-unique="mobile" required="" class="input-md form-control" ng-pattern="/^1[3|5|6|7|8|9]\\d{9}$/" ng-minlength="11" ng-model="reg.mobile" name="mobile" id="tel" placeholder="请输入您的手机号"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.mobile.$dirty) && regForm.mobile.$invalid"><small ng-show="regForm.mobile.$error.minlength">请输入正确的手机号</small> <small ng-show="!regForm.mobile.$error.minlength && regForm.mobile.$error.pattern">您输入的手机号格式不正确</small> <small ng-show="regForm.mobile.$error.required">请输入您的手机号</small> <small ng-if="regForm.mobile.$error.unique">手机号已被注册</small></div></div></div><div class="form-group col-xs-12"><label for="name" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 姓名</b></h6></label><div class="col-sm-10"><input type="text" required="" class="input-md form-control" ng-model="reg.name" name="name" id="name" placeholder="请输入您的真实姓名"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.name.$dirty) && regForm.name.$invalid"><small ng-show="regForm.name.$error.required">请输入您的姓名</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="address" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 您所在的批发市场</b></h6></label><div class="col-sm-10"><select required="" ng-model="addr.city" name="city" ng-options="c.name for c in cities" ng-change="getMarket()" class="block-space form-control input-md"><option value="">选择城市</option></select><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.city.$dirty) && regForm.city.$invalid"><small ng-show="regForm.city.$error.required">请选择您所在的城市</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><div class="col-sm-10 col-sm-offset-2"><select required="" ng-model="addr.market" class="form-control input-md" name="market" ng-options="m.name for m in markets"><option value="">选择批发市场</option></select><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.market.$dirty) && regForm.market.$invalid"><small ng-show="regForm.market.$error.required">请选择您所在的批发市场</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="detail_address" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 档口位置</b></h6></label><div class="col-sm-10"><input required="" type="text" class="input-md form-control" ng-model="reg.detailAddress" name="detail_address" id="detail_address" placeholder="请描述您在市场里的具体位置"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.detail_address.$dirty) && regForm.detail_address.$invalid"><small ng-show="regForm.detail_address.$error.required">请输入您在市场里的具体位置</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="detail_address" class="col-sm-2 control-label"><h6><b>您的招牌(如 XX果业 )(选填)</b></h6></label><div class="col-sm-10"><input type="text" class="input-md form-control" ng-model="reg.brand" name="brand" id="brand" placeholder="填写您的招牌，树立品牌意识"></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 密码</b></h6></label><div class="col-sm-10"><input type="password" required="" class="input-md form-control" ng-model="reg.password" id="password" name="password" placeholder="请输入您的密码"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.password.$dirty) && regForm.password.$invalid"><small ng-show="regForm.password.$error.required">请输入您的密码</small></div></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 确认密码</b></h6></label><div class="col-sm-10"><input type="password" required="" class="input-md form-control" ng-model="reg.checkPassword" id="checkPassword" name="repassword" placeholder="请再次输入你的密码"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.repassword.$dirty) && regForm.repassword.$invalid"><small ng-show="regForm.repassword.$error.required">请再次输入您的密码</small></div><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.repassword.$dirty) && regForm.repassword.$valid && reg.checkPassword != reg.password"><small>两次密码输入不一致</small></div></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b>请输入推荐人的邀请码(选填)</b></h6></label><div class="col-sm-10"><input type="text" class="input-md form-control" ng-model="reg.invite_code" id="checkPassword" name="invite_code" placeholder="请输入大厨网地推人员邀请码"></div></div><div class="form-group col-xs-12"><label for="code" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 验证码</b></h6></label><div class="col-sm-10"><div class="input-group"><input class="input-md form-control" ng-pattern="/^\\d+$/" required="" ng-model="reg.vcode" id="code" type="number" name="code" placeholder="输入短信验证码"><div ng-model="smsinfo" class="input-group-addon btn {{smsdis||smsable}}" ng-disabled="regForm.mobile.$invalid" ng-click="sms()">{{smsinfo || \'获取验证码\'}}</div></div><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.code.$dirty) && regForm.code.$invalid"><small ng-show="regForm.code.$error.required">请输入短信验证码</small></div></div></div><div class="checkbox col-xs-12"><div class="row"><div class="col-xs-12"><label class="control-label" ng-init="agree=true"><h6><input type="checkbox" name="agree" id="agree" ng-model="agree"> <a href="/user/agreement">我已阅读并同意用户协议</a></h6></label></div></div></div><div class="col-xs-12 block-btn"><button type="submit" class="btn btn-block btn-success btn-lg" ng-disabled="!agree">注册</button></div></form></div>')
}]);